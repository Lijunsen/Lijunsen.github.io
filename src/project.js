window.__require=function e(t,o,n){function r(a,c){if(!o[a]){if(!t[a]){var s=a.split("/");if(s=s[s.length-1],!t[s]){var l="function"==typeof __require&&__require;if(!c&&l)return l(s,!0);if(i)return i(s,!0);throw new Error("Cannot find module '"+a+"'")}}var u=o[a]={exports:{}};t[a][0].call(u.exports,function(e){return r(t[a][1][e]||e)},u,u.exports,e,t,o,n)}return o[a].exports}for(var i="function"==typeof __require&&__require,a=0;a<n.length;a++)r(n[a]);return r}({AudioControl:[function(e,t,o){"use strict";cc._RF.push(t,"664279/o+RL5IaPi1BUpLCa","AudioControl");var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),r=this&&this.__decorate||function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(r=e[c])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var i=cc._decorator,a=i.ccclass,c=(i.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.onLoad=function(){},t.prototype.startAudio=function(e,t){var o=this,n=cc.delayTime(t),r=cc.callFunc(function(){o.node.getComponent(cc.AudioSource).play()});this.node.runAction(cc.sequence(n,r))},t.prototype.endAudio=function(){this.node.getComponent(cc.AudioSource).stop()},t.prototype.pauseAudio=function(){this.node.getComponent(cc.AudioSource).pause()},t.prototype.resumeAudio=function(){this.node.getComponent(cc.AudioSource).resume()},t=r([a],t)}(cc.Component));o.default=c,cc._RF.pop()},{}],BeatsCell:[function(e,t,o){"use strict";cc._RF.push(t,"3b7e6Jp7OlGgaQEh+15mVJx","BeatsCell");var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),r=this&&this.__decorate||function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(r=e[c])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var i=cc._decorator,a=i.ccclass,c=i.property,s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.beatLabel=null,t.upTabs=null,t.downTabs=null,t.stress=null,t.time=null,t}return n(t,e),t.prototype.onLoad=function(){this.upTabs.active=!1,this.downTabs.active=!1,this.stress.active=!1,this.time.node.active=!1},t.prototype.Init=function(e,t,o){e+=.5,this.beatLabel.string=e.toFixed(0)+"/"+t.toFixed(0),1==t&&(this.downTabs.active=!0),this.time.node.active=!0,this.time.string=o.toFixed(2)},t.prototype.setAuxiliaryRail=function(e,t){this.beatLabel.string=e,this.time.node.active=!0,this.time.string=t.toFixed(2)},r([c(cc.Label)],t.prototype,"beatLabel",void 0),r([c(cc.Node)],t.prototype,"upTabs",void 0),r([c(cc.Node)],t.prototype,"downTabs",void 0),r([c(cc.Node)],t.prototype,"stress",void 0),r([c(cc.Label)],t.prototype,"time",void 0),t=r([a],t)}(cc.Component);o.default=s,cc._RF.pop()},{}],BhvButtonGroup:[function(e,t,o){"use strict";cc._RF.push(t,"41df676L55LvJ52uxkQpfxJ","BhvButtonGroup");var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),r=this&&this.__decorate||function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(r=e[c])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var i,a=cc._decorator,c=a.ccclass,s=a.property,l=a.menu;(function(e){e[e.CHILDREN_INDEX=0]="CHILDREN_INDEX",e[e.CHILDREN_NAME=1]="CHILDREN_NAME"})(i||(i={}));var u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.transition=cc.Button.Transition.NONE,t.hoverColor=cc.color(255,255,255),t.normalColor=cc.color(214,214,214),t.pressedColor=cc.color(211,211,211),t.disabledColor=cc.color(124,124,124),t.normalSprite=null,t.pressedSprite=null,t.hoverSprite=null,t.disabledSprite=null,t.duration=1,t.zoomScale=1.1,t.paramType=i.CHILDREN_INDEX,t.touchEvents=[],t}return n(t,e),t.prototype.onLoad=function(){var e=this;this.node.children.forEach(function(t,o){var n=t.getComponent(cc.Button);null==n&&(n=t.addComponent(cc.Button)),n.target=t,n.transition=e.transition,n.zoomScale=e.zoomScale,n.disabledSprite=e.disabledSprite,n.hoverSprite=e.hoverSprite,n.normalSprite=e.normalSprite,n.pressedSprite=e.pressedSprite,n.hoverColor=e.hoverColor,n.normalColor=e.normalColor,n.pressedColor=e.pressedColor,n.disabledColor=e.disabledColor,e.touchEvents.forEach(function(r){var a=new cc.Component.EventHandler;a.component=r.component,a.handler=r.handler,a.target=r.target,e.paramType===i.CHILDREN_INDEX?a.customEventData=o.toString():a.customEventData=t.name,n.clickEvents.push(a)})})},r([s({type:cc.Enum(cc.Button.Transition)})],t.prototype,"transition",void 0),r([s({visible:function(){return this.transition===cc.Button.Transition.COLOR}})],t.prototype,"hoverColor",void 0),r([s({visible:function(){return this.transition===cc.Button.Transition.COLOR}})],t.prototype,"normalColor",void 0),r([s({visible:function(){return this.transition===cc.Button.Transition.COLOR}})],t.prototype,"pressedColor",void 0),r([s({visible:function(){return this.transition===cc.Button.Transition.COLOR}})],t.prototype,"disabledColor",void 0),r([s({type:cc.SpriteFrame,visible:function(){return this.transition===cc.Button.Transition.SPRITE}})],t.prototype,"normalSprite",void 0),r([s({type:cc.SpriteFrame,visible:function(){return this.transition===cc.Button.Transition.SPRITE}})],t.prototype,"pressedSprite",void 0),r([s({type:cc.SpriteFrame,visible:function(){return this.transition===cc.Button.Transition.SPRITE}})],t.prototype,"hoverSprite",void 0),r([s({type:cc.SpriteFrame,visible:function(){return this.transition===cc.Button.Transition.SPRITE}})],t.prototype,"disabledSprite",void 0),r([s({visible:function(){return this.transition===cc.Button.Transition.SCALE||this.transition===cc.Button.Transition.COLOR}})],t.prototype,"duration",void 0),r([s({visible:function(){return this.transition===cc.Button.Transition.SCALE}})],t.prototype,"zoomScale",void 0),r([s({type:cc.Enum(i)})],t.prototype,"paramType",void 0),r([s([cc.Component.EventHandler])],t.prototype,"touchEvents",void 0),t=r([c,l("\u6dfb\u52a0\u7279\u6b8a\u884c\u4e3a/UI/Button Group(\u4e00\u7ec4\u6309\u94ae\u63a7\u5236)")],t)}(cc.Component);o.default=u,cc._RF.pop()},{}],BhvFrameIndex:[function(e,t,o){"use strict";cc._RF.push(t,"c238ewfJ2VJnZ8Gb8YQs5Ts","BhvFrameIndex");var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),r=this&&this.__decorate||function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(r=e[c])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var i=cc._decorator,a=i.ccclass,c=i.property,s=i.executeInEditMode,l=i.requireComponent,u=i.menu,p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.spriteFrames=[null],t._index=0,t}return n(t,e),Object.defineProperty(t.prototype,"index",{get:function(){return this._index},set:function(e){e<0||(this._index=e%this.spriteFrames.length,this.node.getComponent(cc.Sprite).spriteFrame=this.spriteFrames[this._index])},enumerable:!0,configurable:!0}),t.prototype.setName=function(e){var t=this.spriteFrames.findIndex(function(t){return t.name==e});t<0&&cc.error("frameIndex \u8bbe\u7f6e\u4e86\u4e0d\u5b58\u5728\u7684name:",e),this.index=t||0},t.prototype.random=function(e,t){if(this.spriteFrames){var o=this.spriteFrames.length;(null==e||e<0)&&(e=0),(null==t||t>o)&&(t=o),this.index=Math.floor(Math.random()*(t-e)+e)}},t.prototype.next=function(){this.index++},t.prototype.previous=function(){this.index--},r([c({type:[cc.SpriteFrame],tooltip:"sprite\u5c06\u4f1a\u7528\u5230\u5e27\u56fe\u7247"})],t.prototype,"spriteFrames",void 0),r([c({tooltip:"\u5f53\u524d\u663e\u793a\u7684\u5e27\u56fe",type:cc.Integer})],t.prototype,"index",null),r([c],t.prototype,"_index",void 0),t=r([a,s,l(cc.Sprite),u("\u6dfb\u52a0\u7279\u6b8a\u884c\u4e3a/UI/Frame Index(\u5e27\u56fe\u6539\u53d8)")],t)}(cc.Component);o.default=p,cc._RF.pop()},{}],BhvRollNumber:[function(e,t,o){"use strict";cc._RF.push(t,"72d13dwmG9LS4gkJhSuAp3F","BhvRollNumber");var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),r=this&&this.__decorate||function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(r=e[c])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var i,a=cc._decorator,c=a.ccclass,s=a.property,l=a.menu;(function(e){e[e.INTEGER=0]="INTEGER",e[e.FIXED_2=1]="FIXED_2",e[e.TIMER=2]="TIMER",e[e.PERCENTAGE=3]="PERCENTAGE",e[e.KMBT_FIXED2=4]="KMBT_FIXED2",e[e.CUSTOMER=5]="CUSTOMER"})(i||(i={}));var u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.label=null,t.value=0,t.showPlusSymbol=!1,t._targetValue=100,t.lerp=.1,t.playAtStart=!0,t.runWaitTimer=0,t.valueType=i.INTEGER,t._custom_callback=null,t.isScrolling=!1,t._lastLabelText="",t}return n(t,e),Object.defineProperty(t.prototype,"targetValue",{get:function(){return this._targetValue},set:function(e){this._targetValue=e,this.scroll()},enumerable:!0,configurable:!0}),t.prototype.onLoad=function(){void 0==this.label&&(this.label=this.node.getComponent(cc.Label)),this.playAtStart&&(this.updateLabel(),this.scroll())},t.prototype.scroll=function(){var e=this;this.isScrolling||(this.runWaitTimer>0?this.scheduleOnce(function(){e.isScrolling=!0},this.runWaitTimer):this.isScrolling=!0)},t.prototype.stop=function(){this.value=this.targetValue,this.isScrolling=!1,this.updateLabel()},t.prototype.init=function(e,t,o){this.targetValue=t||0,this.value=e||0,this.lerp=o||.1},t.prototype.scrollTo=function(e){null!==e&&void 0!==e&&(this.targetValue=e)},t.prototype.updateLabel=function(){var e=this.value,t="";switch(this.valueType){case i.INTEGER:t=Math.round(e)+"";break;case i.FIXED_2:t=e.toFixed(2);break;case i.TIMER:t=p(e);break;case i.PERCENTAGE:t=Math.round(100*e)+"%";break;case i.KMBT_FIXED2:t=e>=Number.MAX_VALUE?"MAX":e>1e12?(e/1e12).toFixed(2)+"T":e>1e9?(e/1e9).toFixed(2)+"B":e>1e6?(e/1e6).toFixed(2)+"M":e>1e3?(e/1e3).toFixed(2)+"K":Math.round(e).toString();break;case i.CUSTOMER:this._custom_callback&&(t=this._custom_callback(this.value,this.targetValue))}if(this.showPlusSymbol&&(e>0?t="+"+t:e<0&&(t="-"+t)),this.label){if(t===this.label.string)return;this.label.string=t}},t.prototype.update=function(e){if(0!=this.isScrolling)return this.value=cc.misc.lerp(this.value,this.targetValue,this.lerp),this.updateLabel(),Math.abs(this.value-this.targetValue)<=1e-4?(this.value=this.targetValue,void(this.isScrolling=!1)):void 0},r([s({type:cc.Label,tooltip:"\u9700\u8981\u6eda\u52a8\u7684 Label \u7ec4\u4ef6,\u5982\u679c\u4e0d\u8fdb\u884c\u8bbe\u7f6e\uff0c\u5c31\u4f1a\u4ece\u81ea\u5df1\u7684\u8282\u70b9\u81ea\u52a8\u67e5\u627e"})],t.prototype,"label",void 0),r([s({tooltip:"\u5f53\u524d\u7684\u6eda\u52a8\u503c(\u5f00\u59cb\u7684\u6eda\u52a8\u503c)"})],t.prototype,"value",void 0),r([s({tooltip:"\u662f\u5426\u663e\u793a\u6b63\u8d1f\u7b26\u53f7"})],t.prototype,"showPlusSymbol",void 0),r([s({tooltip:"\u6eda\u52a8\u7684\u76ee\u6807\u503c"})],t.prototype,"targetValue",null),r([s],t.prototype,"_targetValue",void 0),r([s({tooltip:"\u6eda\u52a8\u7684\u7ebf\u6027\u5dee\u503c",step:.01,max:1,min:0})],t.prototype,"lerp",void 0),r([s({tooltip:"\u662f\u5426\u5728\u5f00\u59cb\u65f6\u5c31\u64ad\u653e"})],t.prototype,"playAtStart",void 0),r([s({tooltip:"\u5728\u6eda\u52a8\u4e4b\u524d\u4f1a\u7b49\u5f85\u51e0\u79d2",step:.1,max:1,min:0})],t.prototype,"runWaitTimer",void 0),r([s({type:cc.Enum(i),tooltip:"\u662f\u5426\u5728\u5f00\u59cb\u65f6\u5c31\u64ad\u653e"})],t.prototype,"valueType",void 0),t=r([c,l("\u6dfb\u52a0\u7279\u6b8a\u884c\u4e3a/UI/Roll Number (\u6eda\u52a8\u6570\u5b57)")],t)}(cc.Component);function p(e,t){void 0===e&&(e=0),void 0===t&&(t=!0);var o=Math.floor(e),n=Math.floor(o/3600),r=Math.floor(o%3600/60),i=o%60,a=""+r,c=""+i;return i<10&&(c="0"+i),t?(r<10&&(a="0"+r),n+":"+a+":"+c):(a=""+(r+60*n),r<10&&(a="0"+r),a+":"+c)}o.default=u,cc._RF.pop()},{}],BhvSwitchPage:[function(e,t,o){"use strict";cc._RF.push(t,"b3d083kncpDPqVztMtiq6DO","BhvSwitchPage");var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),r=this&&this.__decorate||function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(r=e[c])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var i=cc._decorator,a=i.ccclass,c=i.property,s=i.executeInEditMode,l=i.menu,u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.isLoopPage=!1,t._index=0,t.preIndex=0,t._isChanging=!1,t}return n(t,e),Object.defineProperty(t.prototype,"index",{get:function(){return this._index},set:function(e){if(!this.isChanging){e=Math.round(e);var t=this.node.childrenCount-1;this.isLoopPage?(e>t&&(e=0),e<0&&(e=t)):(e>t&&(e=t),e<0&&(e=0)),this.preIndex=this._index,this._index=e,this._updatePage(e)}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isChanging",{get:function(){return this._isChanging},enumerable:!0,configurable:!0}),t.prototype.onLoad=function(){this.preIndex=this.index},t.prototype._updateEditorPage=function(e){},t.prototype._updatePage=function(e){var t=this.node.children,o=this.preIndex,n=this.index;if(o!==n){var r=t[o],i=t[n];r.active=!1,i.active=!0}},t.prototype.next=function(){return!this.isChanging&&(this.index++,!0)},t.prototype.previous=function(){return!this.isChanging&&(this.index--,!0)},t.prototype.setEventIndex=function(e,t){return this.index>=0&&null!=this.index&&!1===this.isChanging&&(this.index=t,!0)},r([c],t.prototype,"isLoopPage",void 0),r([c],t.prototype,"_index",void 0),r([c({type:cc.Integer})],t.prototype,"index",null),t=r([a,s,l("\u6dfb\u52a0\u7279\u6b8a\u884c\u4e3a/UI/Switch Page (\u5207\u6362\u9875\u9762)")],t)}(cc.Component);o.default=u,cc._RF.pop()},{}],EditCell:[function(e,t,o){"use strict";cc._RF.push(t,"d9aec3SlghEaauFy1ghMLvV","EditCell");var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),r=this&&this.__decorate||function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(r=e[c])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var i=e("./EditMode"),a=cc._decorator,c=a.ccclass,s=a.property,l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.timeLabel=null,t.Edit_Mode=null,t.deletemode=null,t.cell=[null],t.celltype=[null],t.cell_code=0,t.path=0,t.indeletemode=!1,t}return n(t,e),t.prototype.onLoad=function(){(this.Edit_Mode=cc.find("Canvas/Edit Mode"))?console.log("finde editmode success"):console.log("Error");for(var e=0;e<this.celltype.length;e++)this.celltype[e].active=!1;this.deletemode.active=!1},t.prototype.Refresh=function(e,t){this.Edit_Mode.getComponent(i.default).notpushtostep||this.Edit_Mode.getComponent(i.default).PushCancelPoor(0,this.cell_code,this.Edit_Mode.getComponent(i.default).edit_cell_awake[this.cell_code].type,this.path,this.Edit_Mode.getComponent(i.default).edit_cell_awake[this.cell_code].time),console.log("Refresh"),this.path=e,this.Edit_Mode.getComponent(i.default).ChangeEditCell(this.cell_code,this.path);for(var o=0;o<this.cell.length;o++)this.cell[o].opacity=o==e?0:50;for(var n=0;n<this.celltype.length;n++)if(n==t)switch(this.celltype[n].active=!0,this.path){case 0:this.celltype[n].position=cc.v2(-360,0);break;case 1:this.celltype[n].position=cc.v2(-120,0);break;case 2:this.celltype[n].position=cc.v2(120,0);break;case 3:this.celltype[n].position=cc.v2(360,0);break;default:console.log("\u8282\u70b9\u914d\u7f6epath\u5931\u8d25")}else this.celltype[n].active=!1},t.prototype.DeleteMode=function(){this.indeletemode?(this.deletemode.active=!1,this.indeletemode=!1):(this.indeletemode=!0,this.deletemode.active=!0)},t.prototype.DeleteThisNode=function(){this.Edit_Mode.getComponent(i.default).DeleteKeyNode(this.cell_code)},t.prototype.Pathbutton1=function(){console.log("click 1"),this.Refresh(0,this.Edit_Mode.getComponent(i.default).what_type_now)},t.prototype.Pathbutton2=function(){console.log("click 2"),this.Refresh(1,this.Edit_Mode.getComponent(i.default).what_type_now)},t.prototype.Pathbutton3=function(){console.log("click 3"),this.Refresh(2,this.Edit_Mode.getComponent(i.default).what_type_now)},t.prototype.pathbutton4=function(){console.log("click 4"),this.Refresh(3,this.Edit_Mode.getComponent(i.default).what_type_now)},r([s(cc.Label)],t.prototype,"timeLabel",void 0),r([s(cc.Node)],t.prototype,"Edit_Mode",void 0),r([s(cc.Node)],t.prototype,"deletemode",void 0),r([s(cc.Node)],t.prototype,"cell",void 0),r([s(cc.Node)],t.prototype,"celltype",void 0),t=r([c],t)}(cc.Component);o.default=l,cc._RF.pop()},{"./EditMode":"EditMode"}],EditMode:[function(e,t,o){"use strict";cc._RF.push(t,"dfaffK8U25BsauHpQSLdt51","EditMode");var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),r=this&&this.__decorate||function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(r=e[c])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var i=e("./EditCell"),a=e("./MVVMData"),c=e("./PreviewMode"),s=e("./BeatsCell"),l=e("./FileSaver"),u=e("./cos-wx-sdk-v5.js"),p=cc._decorator,d=p.ccclass,h=p.property,f=function(){return function(e){void 0===e&&(e=0),this.code=0,this.edit_cell=null,this.path=0,this.type=0,this.time=0,this.code=e,this.edit_cell=null,this.time=0,this.path=0,this.type=0}}();o.EditCellAwake=f;var y=function(){return function(){this.type=0,this.cellcode=0,this.celltype=0,this.cellpath=0,this.celltime=0}}();o.Step=y;var m=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.Edit_UI=[null],t.player=null,t.startpanel=null,t.editcellnode=null,t.blockinput=null,t.edit_cell_prefab=null,t.newkeynodeinput=null,t.tipslabel=null,t.readpanel=null,t.savepanel=null,t.previewmode=null,t.beatCell=null,t.what_type_now=0,t.in_edit_mode=!1,t.MusicInfo=[0],t.isexpand=!1,t.notpushtostep=!1,t.edit_cell_awake=[],t.cancelpoor=[],t.selectedSong=null,t.oneBeatSecond=0,t.beatPerBar=0,t.allBarNumber=0,t.beats=[null],t.deletemode=!1,t.newkeynodetime=null,t}return n(t,e),t.prototype.onLoad=function(){for(var e=0;e<this.Edit_UI.length;e++)this.Edit_UI[e].active=!1;this.newkeynodeinput.node.active=!1,this.tipslabel.node.active=!1,this.blockinput.active=!1,this.readpanel.active=!1,this.savepanel.active=!1},t.prototype.EditMode=function(){this.in_edit_mode?(console.log("edit mode out"),this.in_edit_mode=!1,this.EditModeControl(!1),this.EditSave(null,"0"),cc.director.loadScene("game")):(console.log("in edit mode"),this.in_edit_mode=!0,this.Edit_UI[0].active=!0,cc.director.resume(),this.startpanel.position=cc.v2(-2e3,0),this.EditModeControl(!0))},t.prototype.PushCancelPoor=function(e,t,o,n,r){var i=new y;i.type=e,i.cellcode=t,i.celltype=o,i.cellpath=n,i.celltime=r,this.cancelpoor.push(i),console.log("\u4fdd\u5b58\u64cd\u4f5c\uff1a"+e+",\u8282\u70b9\u4e3a:"+t+",\u7c7b\u578b:"+o+",\u8f68\u9053\uff1a"+n+",\u65f6\u95f4:"+r)},t.prototype.CancelButton=function(){if(0==this.cancelpoor.length)this.ShowTips("\u65e0\u8bb0\u5f55");else{var e=this.cancelpoor.pop();switch(e.type){case 0:this.ShowTips("\u8282\u70b9\u6539\u52a8\u64a4\u56de"),this.notpushtostep=!0;var t=this.what_type_now;this.what_type_now=e.celltype,this.edit_cell_awake[e.cellcode].edit_cell.getComponent(i.default).Refresh(e.cellpath,e.celltype),this.what_type_now=t,this.notpushtostep=!1;break;case 1:this.ShowTips("\u5220\u9664\u65b0\u5efa\u8282\u70b9"),this.notpushtostep=!0,this.DeleteKeyNode(e.cellcode),this.notpushtostep=!1;break;case 2:this.ShowTips("\u6062\u590d\u5220\u9664\u8282\u70b9"),this.notpushtostep=!0,this.NewKeynode(e.celltime);var o=this.what_type_now;this.what_type_now=e.celltype,this.edit_cell_awake[e.cellcode].edit_cell.getComponent(i.default).Refresh(e.cellpath,e.celltype),this.deletemode&&this.edit_cell_awake[e.cellcode].edit_cell.getComponent(i.default).DeleteMode(),this.what_type_now=o,this.notpushtostep=!1}}},t.prototype.EditModeControl=function(e){e?cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN,this.KeyDown,this):cc.systemEvent.off(cc.SystemEvent.EventType.KEY_DOWN,this.KeyDown,this)},t.prototype.KeyDown=function(e){switch(e.keyCode){case cc.macro.KEY.w:console.log("\u524d\u8fdb"),cc.tween(a.view).by(.2,{viewposition:600}).start();break;case cc.macro.KEY.s:console.log("\u540e\u9000"),cc.tween(a.view).by(.2,{viewposition:-600}).start();break;case cc.macro.KEY.f1:this.UI_selecttype(null,"0");break;case cc.macro.KEY.f2:this.UI_selecttype(null,"1");break;case cc.macro.KEY.f3:this.UI_selecttype(null,"2");break;case cc.macro.KEY.f4:this.UI_selecttype(null,"3")}},t.prototype.Expand=function(){var e=0,t=1/0,o=0;if(this.isexpand){this.isexpand=!1;for(n=0;n<this.edit_cell_awake.length;n++)e=this.player.position.y-this.edit_cell_awake[n].edit_cell.position.y,Math.abs(t)>Math.abs(e)&&(t=e,o=n),this.edit_cell_awake[n].edit_cell.position=cc.v2(0,150*n-500);this.previewmode.getComponent(c.default).inpreviewmode||(a.view.maxposition=this.edit_cell_awake[this.edit_cell_awake.length-1].edit_cell.position.y+500,a.view.viewposition=this.edit_cell_awake[o].edit_cell.position.y,this.player.position=cc.v2(0,this.edit_cell_awake[o].edit_cell.position.y));for(n=0;n<this.beats.length;n++)this.beats[n].active=!1}else{this.isexpand=!0;for(var n=0;n<this.edit_cell_awake.length;n++)e=this.player.position.y-this.edit_cell_awake[n].edit_cell.position.y,Math.abs(t)>Math.abs(e)&&(t=e,o=n),this.edit_cell_awake[n].edit_cell.position=cc.v2(0,1e3*this.edit_cell_awake[n].time-500);this.previewmode.getComponent(c.default).inpreviewmode||(a.view.maxposition=this.edit_cell_awake[this.edit_cell_awake.length-1].edit_cell.position.y+500,a.view.viewposition=this.edit_cell_awake[o].edit_cell.position.y,this.player.position=cc.v2(0,this.edit_cell_awake[o].edit_cell.position.y));for(var n=0;n<this.beats.length;n++)this.beats[n].active=!0}},t.prototype.ReadLocal=function(){var e=this,t=JSON.parse(cc.sys.localStorage.getItem(this.selectedSong));if(t)this.ShowTips("\u83b7\u53d6\u672c\u5730\u4fe1\u606f\u6210\u529f"),console.log("\u83b7\u53d6\u672c\u5730\u4fe1\u606f\u6210\u529f"),this.MusicInfo=t,this.WriteEditPath();else{this.ShowTips("\u83b7\u53d6\u672c\u5730\u4fe1\u606f\u5931\u8d25,\u6b63\u5728\u8bfb\u53d6\u521d\u59cb\u7248\u672c"),console.log("\u83b7\u53d6\u672c\u5730\u4fe1\u606f\u5931\u8d25,\u6b63\u5728\u8bfb\u53d6\u521d\u59cb\u7248\u672c");var o=this;cc.loader.loadRes("json/"+o.selectedSong,function(t,n){if(t)console.log(t);else{var r=n.json;o.MusicInfo=r,console.log("musicinfo    "+e.MusicInfo.length)}e.WriteEditPath()})}this.ShowOrHideReadPanel(!1)},t.prototype.ReadCloud=function(){this.DownloadJson(),this.ShowOrHideReadPanel(!1)},t.prototype.WriteEditPath=function(){this.notpushtostep=!0;for(var e=0;e<this.MusicInfo.length;e++)this.edit_cell_awake[e]=new f(e),this.edit_cell_awake[e].time=this.MusicInfo[e].time,this.edit_cell_awake[e].edit_cell=cc.instantiate(this.edit_cell_prefab),this.edit_cell_awake[e].edit_cell.parent=this.editcellnode,this.edit_cell_awake[e].edit_cell.position=cc.v2(0,150*e-500),this.edit_cell_awake[e].edit_cell.getComponent(i.default).cell_code=e,this.edit_cell_awake[e].edit_cell.getComponent(i.default).timeLabel.string=this.MusicInfo[e].time.toFixed(2),console.log("create edit cell:"+e),console.log(this.edit_cell_awake[e].edit_cell.position),this.what_type_now=this.MusicInfo[e].type,this.edit_cell_awake[e].type=this.MusicInfo[e].type,this.edit_cell_awake[e].path=this.MusicInfo[e].path,console.log("\u8bfb\u53d6\u7b2c"+this.edit_cell_awake[e].code+"\u53f7\u8282\u70b9:\u8f68\u9053:"+this.edit_cell_awake[e].path+"\u7c7b\u578b:"+this.edit_cell_awake[e].type),this.edit_cell_awake[e].edit_cell.getComponent(i.default).Refresh(this.MusicInfo[e].path,this.MusicInfo[e].type);a.view.maxposition=this.edit_cell_awake[this.edit_cell_awake.length-1].edit_cell.position.y+500,this.notpushtostep=!1;for(e=0;e<this.allBarNumber*this.beatPerBar;e++){var t=cc.instantiate(this.beatCell);t.parent=this.editcellnode,t.position=cc.v2(700,e*this.oneBeatSecond*1e3-500);var o=e*this.oneBeatSecond,n=e/this.beatPerBar,r=e%this.beatPerBar+1;t.getComponent(s.default).Init(n,r,o),t.active=!1,null==this.beats[e]?this.beats[e]=t:this.beats.push(t)}for(e=0;e<this.allBarNumber*this.beatPerBar-1;e++)for(var c=2;c<=4;c++){var l=cc.instantiate(this.beatCell);l.scale=.7,l.parent=this.editcellnode,l.position=cc.v2(700,e*this.oneBeatSecond*1e3-500+(c-1)*this.oneBeatSecond*1e3/4);var u=this.beats[e].getComponent(s.default).beatLabel.string+"."+c.toFixed(0);o=parseFloat(this.beats[e].getComponent(s.default).time.string)+this.oneBeatSecond/4*(c-1);l.getComponent(s.default).setAuxiliaryRail(u,o),l.active=!1,this.beats.push(l)}},t.prototype.EditSave=function(e,t){for(var o=0;o<this.edit_cell_awake.length;o++)this.edit_cell_awake[o]||(this.edit_cell_awake[o]=new f(o)),this.edit_cell_awake[o].edit_cell=null,console.log("\u4fdd\u5b58\u7b2c"+this.edit_cell_awake[o].code+"\u53f7\u8282\u70b9:\u8f68\u9053:"+this.edit_cell_awake[o].path+"\u7c7b\u578b:"+this.edit_cell_awake[o].type);if("0"==t)cc.sys.localStorage.setItem(this.selectedSong,JSON.stringify(this.edit_cell_awake)),this.ShowTips("\u4fdd\u5b58\u672c\u5730\u6210\u529f"),console.log("\u4fdd\u5b58\u672c\u5730\u6210\u529f");else{cc.sys.localStorage.setItem(this.selectedSong,JSON.stringify(this.edit_cell_awake));var n=JSON.parse(cc.sys.localStorage.getItem(this.selectedSong)),r=JSON.stringify(n),i=new Blob([r],{type:"text/plain;charset=utf-8"});l.saveAs(i,this.selectedSong+".json"),this.ShowTips("\u8f93\u51fa\u6587\u4ef6\u6210\u529f"),console.log("\u8f93\u51fa\u6587\u4ef6\u6210\u529f")}this.ShowOrHideSavePanel(!1)},t.prototype.ChangeEditCell=function(e,t){this.edit_cell_awake[e].path=t,this.edit_cell_awake[e].type=this.what_type_now,console.log("\u8282\u70b9"+e+"\u7684\u5df2\u66f4\u65b0,path\uff1a"+t+",\u7c7b\u578b:"+this.what_type_now)},t.prototype.NewKeyNodeButton=function(){this.blockinput.active=!0,this.newkeynodeinput.string="",this.newkeynodeinput.node.opacity=0,this.newkeynodeinput.node.active=!0,cc.tween(this.newkeynodeinput.node).to(.2,{opacity:255}).start()},t.prototype.NewKeyNodeInputCallFuc=function(){var e=this;if(this.blockinput.active=!1,this.newkeynodetime=parseFloat(this.newkeynodeinput.string),this.ShowTips(this.newkeynodetime.toString()),""==this.newkeynodeinput.string||"number"!=typeof this.newkeynodetime)return this.newkeynodeinput.string="",console.log("\u975e\u6cd5\u8f93\u5165"),this.ShowTips("\u975e\u6cd5\u8f93\u5165"),void cc.tween(this.newkeynodeinput.node).to(.5,{opacity:0}).call(function(){e.newkeynodeinput.node.active=!1}).start();if(-1!=this.newkeynodeinput.string.indexOf("/")){console.log("111111:"+this.newkeynodeinput.string.indexOf("/"));var t=this.newkeynodeinput.string.split("/",2);if(0!=t[1].indexOf(".")){var o=t[1].split(".",2);this.newkeynodetime=((parseFloat(t[0])-1)*this.beatPerBar+parseFloat(o[0])-1+(parseFloat(o[1])-1)/4)*this.oneBeatSecond}else this.newkeynodetime=((parseFloat(t[0])-1)*this.beatPerBar+parseFloat(t[1])-1)*this.oneBeatSecond}cc.tween(this.newkeynodeinput.node).to(.5,{opacity:0}).call(function(){e.newkeynodeinput.node.active=!1}).start(),this.NewKeynode(this.newkeynodetime)},t.prototype.NewKeynode=function(e){var t=new f;t.time=e;for(var o=!1,n=0;n<this.edit_cell_awake.length;n++)this.edit_cell_awake[n].time<t.time||(o?(this.edit_cell_awake[n].code=n,this.edit_cell_awake[n].edit_cell.getComponent(i.default).cell_code=n):(o=!0,t.code=n,this.edit_cell_awake.splice(n,0,t))),o||n!=this.edit_cell_awake.length-1||(o=!0,t.code=this.edit_cell_awake.length,this.edit_cell_awake.push(t));this.edit_cell_awake[t.code].edit_cell=cc.instantiate(this.edit_cell_prefab),this.edit_cell_awake[t.code].edit_cell.parent=this.editcellnode,this.edit_cell_awake[t.code].edit_cell.getComponent(i.default).cell_code=t.code,this.edit_cell_awake[t.code].edit_cell.getComponent(i.default).timeLabel.string=this.edit_cell_awake[t.code].time.toFixed(2),this.Expand(),this.Expand(),this.player.position=this.edit_cell_awake[t.code].edit_cell.position;for(n=0;n<this.edit_cell_awake.length;n++)console.log("\u66f4\u65b0\u8282\u70b9\uff1a"+this.edit_cell_awake[n].code+"  CellCode:"+this.edit_cell_awake[n].edit_cell.getComponent(i.default).cell_code+"  \u65f6\u95f4\uff1a"+this.edit_cell_awake[n].time);this.notpushtostep||this.PushCancelPoor(1,t.code,t.type,t.path,t.time)},t.prototype.DeleteKeyNodeButton=function(){0==this.deletemode?this.deletemode=!0:this.deletemode=!1;var e=cc.find("Canvas/Edit Mode/NewKeyNodeButton");e.active=!e.active;for(var t=0;t<this.edit_cell_awake.length;t++)this.edit_cell_awake[t].edit_cell.getComponent(i.default).DeleteMode()},t.prototype.DeleteKeyNode=function(e){this.notpushtostep||this.PushCancelPoor(2,e,this.edit_cell_awake[e].type,this.edit_cell_awake[e].path,this.edit_cell_awake[e].time),console.log("\u5220\u9664\u8282\u70b9"+e),this.edit_cell_awake[e].edit_cell.destroy(),delete this.edit_cell_awake[e],this.edit_cell_awake.splice(e,1);for(var t=e;t<this.edit_cell_awake.length;t++)this.edit_cell_awake[t].code=t,this.edit_cell_awake[t].edit_cell.getComponent(i.default).cell_code=t;for(t=0;t<this.edit_cell_awake.length;t++)console.log("\u66f4\u65b0\u8282\u70b9\uff1a"+this.edit_cell_awake[t].code+"  CellCode:"+this.edit_cell_awake[t].edit_cell.getComponent(i.default).cell_code+"  \u65f6\u95f4\uff1a"+this.edit_cell_awake[t].time);a.view.maxposition=this.edit_cell_awake[this.edit_cell_awake.length-1].edit_cell.position.y+500},t.prototype.ShowEditUI=function(){for(var e=1;e<this.Edit_UI.length;e++)this.Edit_UI[e].active=!0},t.prototype.ShowTips=function(e){var t=this;this.tipslabel.string=e,this.tipslabel.node.active=!0,this.tipslabel.node.opacity=0,cc.tween(this.tipslabel.node).to(.2,{opacity:255}).delay(.5).to(.2,{opacity:0}).call(function(){t.tipslabel.node.active=!1}).start()},t.prototype.ShowOrHideReadPanel=function(e){e?(this.readpanel.active=!0,this.blockinput.active=!0,this.Edit_UI[0].active=!1):(this.readpanel.active=!1,this.blockinput.active=!1,this.ShowEditUI())},t.prototype.ShowOrHideSavePanel=function(e){e?(this.savepanel.active=!0,this.blockinput.active=!0):(this.savepanel.active=!1,this.blockinput.active=!1)},t.prototype.UI_selecttype=function(e,t){var o=parseInt(t);this.what_type_now=o,this.ShowTips("\u9009\u62e9\u7c7b\u578b:"+(this.what_type_now+1)+","+["\u5c0f\u80fd\u91cf\u661f","\u5927\u80fd\u91cf\u661f","\u9677\u9631","\u969c\u788d"][o])},t.prototype.MVVMSliderCall=function(){this.player.position=cc.v2(0,a.view.viewposition),console.log("MVVMSliderCall,viewposition:"+a.view.viewposition)},t.prototype.ButtonSelectedsong=function(e,t){switch(console.log(e+"   "+t),this.selectedSong=t,this.selectedSong){case"Havana":this.oneBeatSecond=60/105,this.allBarNumber=35,this.beatPerBar=4;break;case"Horizon":this.oneBeatSecond=.46875,this.allBarNumber=28,this.beatPerBar=4;break;default:console.log("error,in select song button")}this.ShowOrHideReadPanel(!0)},t.prototype.CancelMenu=function(){this.newkeynodeinput.node.active=!1,this.savepanel.active=!1,this.MusicInfo[0]&&(this.blockinput.active=!1)},t.prototype.DownloadJson=function(){var e=this,t=new u({SecretId:"AKIDTjlXUBgokQs65uAncCWfMswmGVdXv2wa",SecretKey:"ZeTfftrHTqxUpzVqvnPsCH8mAHApDSRA"}).getObjectUrl({Bucket:"game-eatbean-1258966452",Region:"ap-guangzhou",Key:"json/"+this.selectedSong+".json",sign:!0});return console.log(t),cc.loader.load(t,function(t,o){t?console.log(t):(e.MusicInfo=o,e.WriteEditPath(),console.log("\u83b7\u53d6\u4e91\u7aef\u6587\u4ef6\u8bfb\u53d6\u6210\u529f"))}),null},r([h(cc.Node)],t.prototype,"Edit_UI",void 0),r([h(cc.Node)],t.prototype,"player",void 0),r([h(cc.Node)],t.prototype,"startpanel",void 0),r([h(cc.Node)],t.prototype,"editcellnode",void 0),r([h(cc.Node)],t.prototype,"blockinput",void 0),r([h(cc.Prefab)],t.prototype,"edit_cell_prefab",void 0),r([h(cc.EditBox)],t.prototype,"newkeynodeinput",void 0),r([h(cc.Label)],t.prototype,"tipslabel",void 0),r([h(cc.Node)],t.prototype,"readpanel",void 0),r([h(cc.Node)],t.prototype,"savepanel",void 0),r([h(cc.Node)],t.prototype,"previewmode",void 0),r([h(cc.Prefab)],t.prototype,"beatCell",void 0),t=r([d],t)}(cc.Component);o.default=m,cc._RF.pop()},{"./BeatsCell":"BeatsCell","./EditCell":"EditCell","./FileSaver":"FileSaver","./MVVMData":"MVVMData","./PreviewMode":"PreviewMode","./cos-wx-sdk-v5.js":"cos-wx-sdk-v5"}],Edit_UI:[function(e,t,o){"use strict";cc._RF.push(t,"1748151QG1ArpCqTigRv4vG","Edit_UI");var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),r=this&&this.__decorate||function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(r=e[c])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var i=cc._decorator,a=i.ccclass,c=(i.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.onLoad=function(){this.node.on(cc.Node.EventType.MOUSE_ENTER,this.MouseEnter,this)},t.prototype.start=function(){},t.prototype.MouseEnter=function(){cc.tween(this.node).to(.2,{scale:1.1}).start(),this.node.on(cc.Node.EventType.MOUSE_LEAVE,this.MouseLeave,this)},t.prototype.MouseDown=function(){},t.prototype.MouseLeave=function(){cc.tween(this.node).to(.2,{scale:1}).start(),this.node.off(cc.Node.EventType.MOUSE_LEAVE,this.MouseLeave,this)},t=r([a],t)}(cc.Component));o.default=c,cc._RF.pop()},{}],Energy:[function(e,t,o){"use strict";cc._RF.push(t,"22f175HtvdLo4G2+1TzyFU6","Energy"),Object.defineProperty(o,"__esModule",{value:!0});var n=cc._decorator,r=n.ccclass,i=n.property,a=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.Energyprogress=null,t.EnergyStar=[],t.EnergyMax=0,t.energy=0,t}return __extends(t,e),t.prototype.onLoad=function(){this.Init()},t.prototype.Init=function(){for(var e=0,t=this.EnergyStar;e<t.length;e++){t[e].active=!1}this.changeenergy(100)},t.prototype.changeenergy=function(e){this.energy+=e,this.energy>this.EnergyMax&&(this.energy=this.EnergyMax),this.energy<0&&(this.energy=0);var t=this.energy/(this.EnergyMax/3),o=this.energy%(this.EnergyMax/3)/(this.EnergyMax/3);3==t&&(o=1);for(var n=0;n<=t-1;n++)this.EnergyStar[n].active=!0;for(;n<3;n++)this.EnergyStar[n].active=!1;this.Energyprogress.progress=o},t.prototype.wantrush=function(){return this.energy>this.EnergyMax/3&&(this.changeenergy(-1*this.EnergyMax/3),!0)},__decorate([i(cc.ProgressBar)],t.prototype,"Energyprogress",void 0),__decorate([i(cc.Node)],t.prototype,"EnergyStar",void 0),__decorate([i(cc.Integer)],t.prototype,"EnergyMax",void 0),t=__decorate([r],t)}(cc.Component);o.default=a,cc._RF.pop()},{}],FileSaver:[function(e,t,o){(function(e){"use strict";cc._RF.push(t,"ccf9cmpI2hMMbvAXcYiAkAR","FileSaver");var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n="object"===("undefined"==typeof window?"undefined":o(window))&&window.window===window?window:"object"===("undefined"==typeof self?"undefined":o(self))&&self.self===self?self:"object"===(void 0===e?"undefined":o(e))&&e.global===e?e:void 0;function r(e,t){return void 0===t?t={autoBom:!1}:"object"!==(void 0===t?"undefined":o(t))&&(console.warn("Deprecated: Expected third argument to be a object"),t={autoBom:!t}),t.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)?new Blob([String.fromCharCode(65279),e],{type:e.type}):e}function i(e,t,o){var n=new XMLHttpRequest;n.open("GET",e),n.responseType="blob",n.onload=function(){s(n.response,t,o)},n.onerror=function(){console.error("could not download file")},n.send()}function a(e){var t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch(e){}return t.status>=200&&t.status<=299}function c(e){try{e.dispatchEvent(new MouseEvent("click"))}catch(o){var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(t)}}var s=n.saveAs||("object"!==("undefined"==typeof window?"undefined":o(window))||window!==n?function(){}:"download"in HTMLAnchorElement.prototype?function(e,t,o){var r=n.URL||n.webkitURL,s=document.createElement("a");t=t||e.name||"download",s.download=t,s.rel="noopener","string"==typeof e?(s.href=e,s.origin!==location.origin?a(s.href)?i(e,t,o):c(s,s.target="_blank"):c(s)):(s.href=r.createObjectURL(e),setTimeout(function(){r.revokeObjectURL(s.href)},4e4),setTimeout(function(){c(s)},0))}:"msSaveOrOpenBlob"in navigator?function(e,t,o){if(t=t||e.name||"download","string"==typeof e)if(a(e))i(e,t,o);else{var n=document.createElement("a");n.href=e,n.target="_blank",setTimeout(function(){c(n)})}else navigator.msSaveOrOpenBlob(r(e,o),t)}:function(e,t,o,r){if((r=r||open("","_blank"))&&(r.document.title=r.document.body.innerText="downloading..."),"string"==typeof e)return i(e,t,o);var a="application/octet-stream"===e.type,c=/constructor/i.test(n.HTMLElement)||n.safari,s=/CriOS\/[\d]+/.test(navigator.userAgent);if((s||a&&c)&&"undefined"!=typeof FileReader){var l=new FileReader;l.onloadend=function(){var e=l.result;e=s?e:e.replace(/^data:[^;]*;/,"data:attachment/file;"),r?r.location.href=e:location=e,r=null},l.readAsDataURL(e)}else{var u=n.URL||n.webkitURL,p=u.createObjectURL(e);r?r.location=p:location.href=p,r=null,setTimeout(function(){u.revokeObjectURL(p)},4e4)}});n.saveAs=s.saveAs=s,void 0!==t&&(t.exports=s),cc._RF.pop()}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],Game:[function(e,t,o){"use strict";cc._RF.push(t,"d00155ycElFcL9WXv+aD6WZ","Game");var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),r=this&&this.__decorate||function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(r=e[c])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var i=cc._decorator,a=i.ccclass,c=i.property,s=e("./Score");(function(e){e[e.Up=0]="Up",e[e.Down=1]="Down",e[e.Left=2]="Left",e[e.Right=3]="Right"})(o.Direction||(o.Direction={})),function(e){e[e.common=0]="common",e[e.importance=1]="importance"}(o.startype||(o.startype={}));var l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.StarCreater=null,t.PauseButton=null,t.Pausepalen=null,t.overpalen=null,t.starpalen=null,t.mainnode=null,t.touch=null,t.ifpause=!1,t}return n(t,e),t.prototype.onLoad=function(){cc.director.getCollisionManager().enabled=!0,this.PauseButton.interactable=!1},t.prototype.GameCompleted=function(e){this.getComponent(s.default).gamecompleted=e,e?console.log("Win!"):console.log("game over"),this.ifpause||(this.ifpause=!0,this.overpalen.position=cc.v2(0,2),cc.director.pause()),this.getComponent(s.default).AccoutScore()},t.prototype.PauseGame=function(){console.log("pause  "+this.ifpause),this.ifpause||(this.ifpause=!0,this.Pausepalen.position=cc.v2(0,0),this.node.getComponent("AudioControl").pauseAudio(),cc.director.pause())},t.prototype.ResumeGame=function(){this.ifpause=!1,cc.director.resume(),this.node.getComponent("AudioControl").resumeAudio(),this.Pausepalen.position=cc.v2(2e3,0)},t.prototype.ReplayGame=function(){this.ifpause=!1,cc.director.loadScene("game")},t.prototype.startGame=function(){this.starpalen.position=cc.v2(-2e3,0),this.PauseButton.interactable=!0,cc.director.resume(),this.touch.getComponent("Touch").starttouch(),this.StarCreater.getComponent("StarCreater").starcreate(),this.node.getComponent("AudioControl").startAudio(0,2),this.mainnode.getComponent("MainNode").starmove()},r([c(cc.Node)],t.prototype,"StarCreater",void 0),r([c(cc.Button)],t.prototype,"PauseButton",void 0),r([c(cc.Node)],t.prototype,"Pausepalen",void 0),r([c(cc.Node)],t.prototype,"overpalen",void 0),r([c(cc.Node)],t.prototype,"starpalen",void 0),r([c(cc.Node)],t.prototype,"mainnode",void 0),r([c(cc.Node)],t.prototype,"touch",void 0),t=r([a],t)}(cc.Component);o.default=l,cc._RF.pop()},{"./Score":"Score"}],JsonOb:[function(e,t,o){"use strict";cc._RF.push(t,"000b00Lx19Ke4hAFc9/Qlnh","JsonOb"),Object.defineProperty(o,"__esModule",{value:!0});var n=Object.prototype,r={obj:"[object Object]",array:"[object Array]"},i=["push","pop","shift","unshift","short","reverse","splice"],a=function(){function e(e,t){n.toString.call(e)!==r.obj&&n.toString.call(e)!==r.array&&console.error("\u8bf7\u4f20\u5165\u4e00\u4e2a\u5bf9\u8c61\u6216\u6570\u7ec4"),this._callback=t,this.observe(e)}return e.prototype.observe=function(e,t){var o=this;n.toString.call(e)===r.array&&this.overrideArrayProto(e,t),Object.keys(e).forEach(function(i){var a=o,c=e[i],s=t&&t.slice();s?s.push(i):s=[i],Object.defineProperty(e,i,{get:function(){return c},set:function(e){c!==e&&("[object Object]"===n.toString.call(e)&&a.observe(e,s),a._callback(e,c,s),c=e)}}),n.toString.call(e[i])!==r.obj&&n.toString.call(e[i])!==r.array||o.observe(e[i],s)},this)},e.prototype.overrideArrayProto=function(e,t){var o,n=Array.prototype,r=Object.create(Array.prototype),a=this;i.forEach(function(e){Object.defineProperty(r,e,{value:function(){var r=this.slice();return o=n[e].apply(this,arguments),a.observe(this,t),a._callback(this,r,t),o}})}),e.__proto__=r},e}();o.JsonOb=a,cc._RF.pop()},{}],MVVMData:[function(e,t,o){"use strict";cc._RF.push(t,"f1ab5achu9Izb/S2zoBotBZ","MVVMData");var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),r=this&&this.__decorate||function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(r=e[c])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var i=e("./modelView/ViewModel"),a=function(){return function(){this.viewposition=0,this.minposition=-500,this.maxposition=0}}();o.ViewData=a,o.view=new a,i.VM.add(o.view,"viewdata");var c=cc._decorator,s=c.ccclass,l=(c.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.start=function(){},t=r([s],t)}(cc.Component));o.default=l,cc._RF.pop()},{"./modelView/ViewModel":"ViewModel"}],MainNode:[function(e,t,o){"use strict";cc._RF.push(t,"0c2b8IGVwhKE4fIqVw9GB66","MainNode"),Object.defineProperty(o,"__esModule",{value:!0});var n=cc._decorator,r=n.ccclass,i=n.property,a=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.movespeed=0,t}return __extends(t,e),t.prototype.onLoad=function(){},t.prototype.update=function(e){},t.prototype.setmoveaction=function(){var e=cc.moveBy(1,cc.v2(0,this.movespeed));return cc.repeatForever(e)},t.prototype.starmove=function(){var e=this.setmoveaction();this.node.runAction(e)},__decorate([i(cc.Integer)],t.prototype,"movespeed",void 0),t=__decorate([r],t)}(cc.Component);o.default=a,cc._RF.pop()},{}],PlayerLight:[function(e,t,o){"use strict";cc._RF.push(t,"2956fXspnBE05K6X15tOds3","PlayerLight"),Object.defineProperty(o,"__esModule",{value:!0});var n=cc._decorator,r=n.ccclass,i=n.property,a=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.commonsize=0,t.rushsize=0,t.rushemitspeed=0,t.rushtime=0,t}return __extends(t,e),t.prototype.start=function(){this.node.getComponent(cc.ParticleSystem).startSize=this.commonsize,this.node.getComponent(cc.ParticleSystem).speed=0},t.prototype.RushMode=function(){var e=this;console.log("rush mode"),this.node.getComponent(cc.ParticleSystem).startSize=this.rushsize,this.node.getComponent(cc.ParticleSystem).speed=this.rushemitspeed,this.scheduleOnce(function(){console.log("check"),e.node.getComponent(cc.ParticleSystem).startSize=e.commonsize,e.node.getComponent(cc.ParticleSystem).speed=0},this.rushtime)},__decorate([i],t.prototype,"commonsize",void 0),__decorate([i],t.prototype,"rushsize",void 0),__decorate([i],t.prototype,"rushemitspeed",void 0),__decorate([i],t.prototype,"rushtime",void 0),t=__decorate([r],t)}(cc.Component);o.default=a,cc._RF.pop()},{}],Player:[function(e,t,o){"use strict";cc._RF.push(t,"c019bXyG4lCUbfGcmH8GCNE","Player");var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),r=this&&this.__decorate||function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(r=e[c])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var i=cc._decorator,a=i.ccclass,c=i.property,s=e("./Game"),l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.movetime=0,t.rushtime=0,t.rushbacktime=0,t.game=null,t.rushbutton=null,t.playerlight=null,t.movedistance=0,t.wayid=0,t.moveaction=null,t.cancontrol=!0,t.ifback=!1,t.ifrushnow=!1,t}return n(t,e),t.prototype.onLoad=function(){this.movedistance=240,this.wayid=1,cc.director.getCollisionManager().enabled=!0,this.rushbutton.active=!1},t.prototype.setmoveAction=function(e,t){if(e>t){var o=cc.moveBy(this.movetime,cc.v2(-1*this.movedistance,0)).easing(cc.easeCubicActionOut());this.wayid=t;var n=cc.callFunc(this.moveactionend,this);return cc.sequence(o,n)}o=cc.moveBy(this.movetime,cc.v2(this.movedistance,0)).easing(cc.easeCubicActionOut());this.wayid=t;n=cc.callFunc(this.moveactionend,this);return cc.sequence(o,n)},t.prototype.setbackAction=function(e,t){if(e>t){var o=cc.moveBy(this.movetime,cc.v2(-1*this.movedistance,0)).easing(cc.easeCubicActionOut());this.wayid=t;var n=cc.callFunc(this.backactionend,this);return cc.sequence(o,n)}o=cc.moveBy(this.movetime,cc.v2(this.movedistance,0)).easing(cc.easeCubicActionOut());this.wayid=t;n=cc.callFunc(this.backactionend,this);return cc.sequence(o,n)},t.prototype.setrushAction=function(){var e=this;this.ifrushnow=!0;var t=cc.moveBy(this.rushtime,cc.v2(0,1300)).easing(cc.easeCubicActionOut()),o=cc.callFunc(function(){e.cancontrol=!0,e.ifrushnow=!1},this);return cc.sequence(t,o)},t.prototype.onDown=function(e){if(this.cancontrol)switch(e){case s.Direction.Left:0!=this.wayid&&(this.moveaction=this.setmoveAction(this.wayid,this.wayid-1),this.ifback=!1,this.cancontrol=!1,this.node.runAction(this.moveaction));break;case s.Direction.Right:3!=this.wayid&&(this.moveaction=this.setmoveAction(this.wayid,this.wayid+1),this.ifback=!1,this.cancontrol=!1,this.node.runAction(this.moveaction))}},t.prototype.onUp=function(e){0!=this.wayid&&3!=this.wayid||(this.ifback=!0,this.cancontrol&&this.moveactionend())},t.prototype.onRush=function(){this.cancontrol&&this.game.getComponent("Energy").wantrush()&&(this.moveaction=this.setrushAction(),this.cancontrol=!1,this.node.runAction(this.moveaction),this.playerlight.getComponent("PlayerLight").RushMode())},t.prototype.moveactionend=function(){this.ifback?0==this.wayid?(this.moveaction=this.setbackAction(this.wayid,this.wayid+1),this.node.runAction(this.moveaction)):(this.moveaction=this.setbackAction(this.wayid,this.wayid-1),this.node.runAction(this.moveaction)):this.cancontrol||(this.cancontrol=!0)},t.prototype.backactionend=function(){this.cancontrol=!0},t.prototype.rushend=function(){},t.prototype.onCollisionEnter=function(e,t){if(console.log("other.node.group  "+e.node.group),"canrush"==e.node.group)this.rushbutton.active=!0;else if("fire"==e.node.group){console.log("end game");var o=this,n=cc.delayTime(.5),r=cc.callFunc(function(){o.game.getComponent("Game").GameCompleted(o.ifrushnow),cc.director.pause()});this.node.runAction(cc.sequence(n,r))}},t.prototype.onCollisionExit=function(e,t){"canrush"==e.node.group&&(this.rushbutton.active=!1)},r([c(cc.Float)],t.prototype,"movetime",void 0),r([c(cc.Float)],t.prototype,"rushtime",void 0),r([c(cc.Float)],t.prototype,"rushbacktime",void 0),r([c(cc.Node)],t.prototype,"game",void 0),r([c(cc.Node)],t.prototype,"rushbutton",void 0),r([c(cc.Node)],t.prototype,"playerlight",void 0),t=r([a],t)}(cc.Component);o.default=l,cc._RF.pop()},{"./Game":"Game"}],PreviewMode:[function(e,t,o){"use strict";cc._RF.push(t,"150d9ttaTtMjKKXM6WE6xrz","PreviewMode");var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),r=this&&this.__decorate||function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(r=e[c])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var i=e("./EditMode"),a=e("./MVVMData"),c=cc._decorator,s=c.ccclass,l=c.property,u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.game=null,t.Player=null,t.editmode=null,t.baseline=null,t.blockinput=null,t.pausebutton=null,t.go=null,t.remainTime=0,t.inpreviewmode=!1,t.ispause=!1,t}return n(t,e),t.prototype.onLoad=function(){this.baseline.active=!1,this.blockinput.active=!1,this.pausebutton.active=!1},t.prototype.PreviewMode=function(){var e=this;this.inpreviewmode?(this.inpreviewmode=!1,this.ispause=!1,this.editmode.getComponent(i.default).ShowTips("\u9000\u51fa\u9884\u89c8\u6a21\u5f0f"),this.baseline.active=!1,this.blockinput.active=!1,this.pausebutton.getComponentInChildren(cc.Label).string="\u6682\u505c",this.pausebutton.active=!1,this.editmode.getComponent(i.default).Edit_UI[6].active=!0,this.editmode.getComponent(i.default).EditModeControl(!0),this.game.getComponent(cc.AudioSource).stop(),this.go&&(this.go.stop(),this.go=null)):(this.editmode.getComponent(i.default).ShowTips("\u8fdb\u5165\u9884\u89c8\u6a21\u5f0f"),this.baseline.active=!0,this.blockinput.active=!0,this.pausebutton.active=!0,this.editmode.getComponent(i.default).Edit_UI[6].active=!1,this.editmode.getComponent(i.default).EditModeControl(!1),this.editmode.getComponent(i.default).isexpand||this.editmode.getComponent(i.default).Expand(),cc.loader.loadRes("audio/"+this.editmode.getComponent(i.default).selectedSong,cc.AudioClip,function(t,o){e.game.getComponent(cc.AudioSource).clip=o,a.view.viewposition<6800||a.view.viewposition>a.view.maxposition?(console.log("\u4ece\u521d\u59cb\u4f4d\u7f6e\u5f00\u59cb"),a.view.viewposition=0,e.remainTime=e.game.getComponent(cc.AudioSource).getDuration()):(console.log("\u4ece\u5f53\u524d\u4f4d\u7f6e\u5f00\u59cb"),e.remainTime=e.game.getComponent(cc.AudioSource).getDuration()-a.view.viewposition/1e3),console.log("durationtime:"+e.remainTime),e.go=cc.tween(a.view).to(e.remainTime,{viewposition:1e3*e.game.getComponent(cc.AudioSource).getDuration()}),e.go.call(function(){e.inpreviewmode=!0,e.PreviewMode(),console.log("song finished")}).start(),e.game.getComponent(cc.AudioSource).play(),e.game.getComponent(cc.AudioSource).setCurrentTime(a.view.viewposition/1e3)}),this.inpreviewmode=!0)},t.prototype.IsPause=function(){var e=this;if(this.ispause){this.ispause=!1,this.editmode.getComponent(i.default).ShowTips("\u6062\u590d");var t=this.game.getComponent(cc.AudioSource).getCurrentTime(),o=this.game.getComponent(cc.AudioSource).getDuration();a.view.viewposition=1e3*t,this.go=cc.tween(a.view).to(o-t,{viewposition:1e3*o}),this.pausebutton.getComponentInChildren(cc.Label).string="\u6682\u505c",this.go.call(function(){e.inpreviewmode=!0,e.PreviewMode(),console.log("song finished")}).start(),this.game.getComponent(cc.AudioSource).resume()}else this.ispause=!0,this.editmode.getComponent(i.default).ShowTips("\u6682\u505c"),this.pausebutton.getComponentInChildren(cc.Label).string="\u64ad\u653e",this.game.getComponent(cc.AudioSource).pause(),this.go.stop(),this.go=null},t.prototype.update=function(e){this.game.getComponent(cc.AudioSource).isPlaying&&(this.baseline.getComponentInChildren(cc.Label).string=this.game.getComponent(cc.AudioSource).getCurrentTime().toFixed(2)+"/"+this.game.getComponent(cc.AudioSource).getDuration().toFixed(2))},r([l(cc.Node)],t.prototype,"game",void 0),r([l(cc.Node)],t.prototype,"Player",void 0),r([l(cc.Node)],t.prototype,"editmode",void 0),r([l(cc.Node)],t.prototype,"baseline",void 0),r([l(cc.Node)],t.prototype,"blockinput",void 0),r([l(cc.Node)],t.prototype,"pausebutton",void 0),t=r([s],t)}(cc.Component);o.default=u,cc._RF.pop()},{"./EditMode":"EditMode","./MVVMData":"MVVMData"}],Prop:[function(e,t,o){"use strict";cc._RF.push(t,"e50aePLPiNGpbQkmsIHlzrS","Prop"),Object.defineProperty(o,"__esModule",{value:!0});var n=cc._decorator,r=n.ccclass,i=n.property,a=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.propbutton=null,t.propmask=null,t.proptime=0,t.time=0,t.canuse=!0,t}return __extends(t,e),t.prototype.start=function(){this.propmask.fillRange=0,this.propbutton.interactable=!0,this.canuse=!0},t.prototype.update=function(e){this.canuse||(this.time+=e,this.time>this.proptime?(this.propmask.fillRange=0,this.canuse=!0,this.propbutton.interactable=!0,this.time=0):this.propmask.fillRange=(this.proptime-this.time)/this.proptime)},t.prototype.useprop=function(){this.propbutton.interactable=!1,this.canuse=!1,this.time=0,this.propmask.fillRange=1},__decorate([i(cc.Button)],t.prototype,"propbutton",void 0),__decorate([i(cc.Sprite)],t.prototype,"propmask",void 0),__decorate([i(cc.Integer)],t.prototype,"proptime",void 0),t=__decorate([r],t)}(cc.Component);o.default=a,cc._RF.pop()},{}],Score:[function(e,t,o){"use strict";cc._RF.push(t,"5c978X0vMVAjY8eIf0uNJj9","Score"),Object.defineProperty(o,"__esModule",{value:!0});var n=cc._decorator,r=n.ccclass,i=n.property,a=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.scorelabel=null,t.finalscorelabel=null,t.levellabel=null,t.finalscore=0,t.starscore=0,t.rushscore=0,t.trapscore=0,t.completedrate=0,t.missionscore=0,t.gamecompleted=!1,t}return __extends(t,e),t.prototype.changescore=function(e){switch(e){case 10:case 50:this.starscore+=e,console.log("\u5f97\u5206\uff1a"+this.starscore);break;case 100:this.rushscore+=e;break;case-50:this.trapscore+=e;break;default:console.log("\u7ed3\u7b97\u5206\u503c\u672a\u627e\u5230\u5bf9\u5e94\u7c7b\u578b")}},t.prototype.AccoutScore=function(){this.completedrate=0,this.gamecompleted?this.finalscore==this.missionscore&&(console.log("S"),this.levellabel.string="S"):this.completedrate>=.5?(console.log("C"),this.levellabel.string="C"):(console.log("D"),this.levellabel.string="D"),this.levellabel.node.active=!0,this.finalscorelabel.string="star:"+this.starscore+"\nrush:"+this.rushscore+"\ntrap:"+this.trapscore},t.prototype.start=function(){},t.prototype.update=function(e){this.finalscore=1*(this.starscore+this.rushscore+this.trapscore),this.scorelabel.string="Score\uff1a"+this.finalscore.toString(),this.gamecompleted&&this.AccoutScore()},__decorate([i(cc.Label)],t.prototype,"scorelabel",void 0),__decorate([i(cc.Label)],t.prototype,"finalscorelabel",void 0),__decorate([i(cc.Label)],t.prototype,"levellabel",void 0),t=__decorate([r],t)}(cc.Component);o.default=a,cc._RF.pop()},{}],StarCreater:[function(e,t,o){"use strict";cc._RF.push(t,"57f70oOI4JG6rru07I0+h/Z","StarCreater");var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),r=this&&this.__decorate||function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(r=e[c])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var i=cc._decorator,a=i.ccclass,c=i.property,s=e("./Game"),l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.staritem=[],t.way=null,t.player=null,t.game=null,t.commonenergy=0,t.importanceenergy=0,t.commonscore=0,t.importancescore=0,t.Fire=null,t.MusicInfo=[0],t.hascreatenum=0,t.fire=null,t.time=0,t.ifstart=!1,t.firecometime=0,t.starpoolnum=5,t}return n(t,e),t.prototype.onLoad=function(){this.starcommonpoll=new cc.NodePool,this.starimportancepoll=new cc.NodePool,this.InitMusicInfo();for(var e=0;e<this.starpoolnum;e++){(t=cc.instantiate(this.staritem[0])).position=cc.v2(-10,-10),this.starcommonpoll.put(t)}for(e=0;e<this.starpoolnum;e++){var t;(t=cc.instantiate(this.staritem[1])).position=cc.v2(-10,-10),this.starimportancepoll.put(t)}this.fire=cc.instantiate(this.Fire),this.fire.position=cc.v2(-1080,0)},t.prototype.InitMusicInfo=function(){var e=this,t=this;cc.loader.loadRes("json/beat",function(o,n){if(o)console.log(o);else{var r=n.json;t.MusicInfo=r,console.log("music "+e.MusicInfo.length+"    info "+r.length);for(var i=0;i<e.MusicInfo.length;i++)console.log(i+"   "+e.MusicInfo[i]);e.firecometime=e.MusicInfo[e.MusicInfo.length-1].start+.5}})},t.prototype.update=function(e){if(this.ifstart&&(this.time+=e),this.hascreatenum==this.MusicInfo.length&&this.firecometime<this.time)return this.fire.position=cc.v2(0,this.node.convertToWorldSpace(cc.Vec2.ZERO).y),this.fire.parent=this.way,console.log("fire is coming"+this.fire.position),void this.hascreatenum++;if(!(this.hascreatenum>=this.MusicInfo.length))for(;this.MusicInfo[this.hascreatenum].start<this.time;){var t=this.MusicInfo[this.hascreatenum].start-Math.floor(this.MusicInfo[this.hascreatenum].start);if(t<.25?this.createstar(0,s.startype.common,this.commonscore,this.commonenergy):t<.5?this.createstar(1,s.startype.common,this.commonscore,this.commonenergy):t<.75?this.createstar(2,s.startype.common,this.commonscore,this.commonenergy):this.createstar(3,s.startype.common,this.commonscore,this.commonenergy),this.hascreatenum++,this.hascreatenum>=this.MusicInfo.length)return}},t.prototype.createstar=function(e,t,o,n){var r=null;t==s.startype.common?r=this.starcommonpoll.size()>0?this.starcommonpoll.get():cc.instantiate(this.staritem[0]):t==s.startype.importance&&(r=this.starimportancepoll.size()>0?this.starimportancepoll.get():cc.instantiate(this.staritem[1])),r.parent=this.way,r.position=e<1?cc.v2(-360,this.node.convertToWorldSpaceAR(cc.Vec2.ZERO).y-this.game.convertToWorldSpaceAR(cc.Vec2.ZERO).y):e<2?cc.v2(-120,this.node.convertToWorldSpaceAR(cc.Vec2.ZERO).y-this.game.convertToWorldSpaceAR(cc.Vec2.ZERO).y):e<3?cc.v2(120,this.node.convertToWorldSpaceAR(cc.Vec2.ZERO).y-this.game.convertToWorldSpaceAR(cc.Vec2.ZERO).y):cc.v2(360,this.node.convertToWorldSpaceAR(cc.Vec2.ZERO).y-this.game.convertToWorldSpaceAR(cc.Vec2.ZERO).y),s.startype.common,r.getComponent("Star").Init(this.game,this.player,this.node,t,o,n)},t.prototype.destorystar=function(e,t){t==s.startype.common?this.starcommonpoll.put(e):this.starimportancepoll.put(e)},t.prototype.starcreate=function(){this.ifstart=!0},r([c(cc.Prefab)],t.prototype,"staritem",void 0),r([c(cc.Node)],t.prototype,"way",void 0),r([c(cc.Node)],t.prototype,"player",void 0),r([c(cc.Node)],t.prototype,"game",void 0),r([c(cc.Integer)],t.prototype,"commonenergy",void 0),r([c(cc.Integer)],t.prototype,"importanceenergy",void 0),r([c(cc.Integer)],t.prototype,"commonscore",void 0),r([c(cc.Integer)],t.prototype,"importancescore",void 0),r([c(cc.Prefab)],t.prototype,"Fire",void 0),t=r([a],t)}(cc.Component);o.default=l,cc._RF.pop()},{"./Game":"Game"}],Star:[function(e,t,o){"use strict";cc._RF.push(t,"ee2f9UwbelLOJdD1mR6l6z4","Star"),Object.defineProperty(o,"__esModule",{value:!0});var n=cc._decorator,r=n.ccclass,i=n.property,a=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.way=null,t.player=null,t.starcreater=null,t.game=null,t.ScoreClass=null,t.score=0,t.energy=0,t}return __extends(t,e),t.prototype.onLoad=function(){cc.director.getCollisionManager().enabled=!0},t.prototype.Init=function(e,t,o,n,r,i){console.log("init"),this.game=e,this.player=t,this.score=r,this.energy=i,this.starcreater=o,this.Startype=n},t.prototype.update=function(e){this.player.position.y-this.node.position.y>500&&(this.node.position=cc.v2(-10,-10),this.starcreater.getComponent("StarCreater").destorystar(this.node,this.Startype))},t.prototype.onCollisionEnter=function(e,t){console.log("\u78b0\u5230\u4e86--------------------"+e.node.group),"player"==e.node.group&&(this.node.position=cc.v2(-10,-10),this.game.getComponent("Energy").changeenergy(this.energy),this.game.getComponent("Score").changescore(this.score),this.starcreater.getComponent("StarCreater").destorystar(this.node,this.Startype))},__decorate([i(cc.Node)],t.prototype,"way",void 0),__decorate([i(cc.Node)],t.prototype,"player",void 0),__decorate([i(cc.Node)],t.prototype,"starcreater",void 0),__decorate([i(cc.Node)],t.prototype,"game",void 0),__decorate([i(cc.Node)],t.prototype,"ScoreClass",void 0),t=__decorate([r],t)}(cc.Component);o.default=a,cc._RF.pop()},{}],StringFormat:[function(e,t,o){"use strict";cc._RF.push(t,"85fe8Gc6h5Ava+JsdbBs8cR","StringFormat"),Object.defineProperty(o,"__esModule",{value:!0});var n=function(){function e(){}return e.prototype.deal=function(e,t){if(""===t)return e;var o,n=(t=t.toLowerCase().trim()).match(/^[a-z|A-Z]+/gi),r=t.match(/\d+$/gi),i="",a="";if(n&&(i=n[0]),r&&(o=parseInt(r[0])),"number"==typeof e)switch(i){case"int":a=this.int(e);break;case"fix":a=this.fix(e,o);break;case"kmbt":a=this.KMBT(e);break;case"per":a=this.per(e,o);break;case"sep":a=this.sep(e)}else{switch(i){case"limit":a=this.limit(e,o)}a=e}return a},e.prototype.sep=function(e){return Math.round(e).toString().replace(new RegExp("(\\d)(?=(\\d{3})+$)","ig"),"$1,")},e.prototype.time_m=function(e){},e.prototype.time_s=function(e){},e.prototype.time_ms=function(e){},e.prototype.timeStamp=function(e){return new Date(e).toString()},e.prototype.per=function(e,t){return Math.round(100*e).toFixed(t)},e.prototype.int=function(e){return Math.round(e)},e.prototype.fix=function(e,t){return e.toFixed(t)},e.prototype.limit=function(e,t){return e.substring(0,t)},e.prototype.KMBT=function(e,t){void 0===t&&(t="en");switch(t){case"zh":}return this.compressUnit(e,[1e3,1e6,1e9,1e12],["","K","M","B","T"],2)},e.prototype.compressUnit=function(e,t,o,n){void 0===n&&(n=2);var r,i,a=t,c=o;for(i=0;i<a.length;i++){if(e<a[i]){r=i>0?(e/a[i-1]).toFixed(n):e.toFixed(0);break}}return r+c[i]},e}();o.StringFormatFunction=new n,cc._RF.pop()},{}],Touch:[function(e,t,o){"use strict";cc._RF.push(t,"321bbkpSOdBnYnDBem+eT+y","Touch");var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),r=this&&this.__decorate||function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(r=e[c])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var i=cc._decorator,a=i.ccclass,c=i.property,s=e("./Game"),l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.player=null,t.toucheffect=null,t.ifstart=!1,t}return n(t,e),t.prototype.onLoad=function(){},t.prototype.onKeyDown=function(e){if(this.ifstart)switch(e.keyCode){case cc.macro.KEY.a:this.player.getComponent("Player").onDown(s.Direction.Left);break;case cc.macro.KEY.d:this.player.getComponent("Player").onDown(s.Direction.Right);break;case cc.macro.KEY.w:this.player.getComponent("Player").onRush();break;case cc.macro.KEY.x:}},t.prototype.onKeyUp=function(e){if(this.ifstart)switch(e.keyCode){case cc.macro.KEY.a:this.player.getComponent("Player").onUp(s.Direction.Left);break;case cc.macro.KEY.d:this.player.getComponent("Player").onUp(s.Direction.Right)}},t.prototype.onTouchStart=function(e){var t=this.node.convertToNodeSpaceAR(e.getLocation());console.log(" touch  "+t);var o=cc.instantiate(this.toucheffect);o.parent=this.node,o.position=t,console.log(" touch  "+o.position),this.ifstart&&(t.x<0?this.player.getComponent("Player").onDown(s.Direction.Left):this.player.getComponent("Player").onDown(s.Direction.Right))},t.prototype.onTouchEnd=function(e){var t=this.node.convertToNodeSpaceAR(e.getLocation());console.log("TouchEnd  "+t),this.ifstart&&(t.x<0?this.player.getComponent("Player").onUp(s.Direction.Left):this.player.getComponent("Player").onUp(s.Direction.Right))},t.prototype.starttouch=function(){this.ifstart=!0},r([c(cc.Node)],t.prototype,"player",void 0),r([c(cc.Prefab)],t.prototype,"toucheffect",void 0),t=r([a],t)}(cc.Component);o.default=l,cc._RF.pop()},{"./Game":"Game"}],VMBase:[function(e,t,o){"use strict";cc._RF.push(t,"2f6f36IvUdPO7xynnVTPgzb","VMBase");var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),r=this&&this.__decorate||function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(r=e[c])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var i=e("./ViewModel"),a=cc._decorator,c=a.ccclass,s=(a.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.watchPath="",t.watchPathArr=[],t.templateMode=!1,t.templateValueArr=[],t.VM=i.VM,t}return n(t,e),t.prototype.onLoad=function(){var e=this;for(var t=this.watchPath.split("."),o=1;o<t.length;o++){if("*"==t[o]){(a=this.node.getParent().children.findIndex(function(t){return t===e.node}))<=0&&(a=0),t[o]=a.toString();break}}this.watchPath=t.join(".");var n=this.watchPathArr;if(n.length>=1)for(o=0;o<n.length;o++){for(var r=n[o].split("."),i=1;i<r.length;i++){if("*"==r[i]){var a;(a=this.node.getParent().children.findIndex(function(t){return t===e.node}))<=0&&(a=0),r[i]=a.toString();break}}this.watchPathArr[o]=r.join(".")}""==this.watchPath&&""==this.watchPathArr.join("")&&cc.log("\u53ef\u80fd\u672a\u8bbe\u7f6e\u8def\u5f84\u7684\u8282\u70b9:",this.node.getParent().name+"."+this.node.name)},t.prototype.onEnable=function(){this.templateMode?this.setMultPathEvent(!0):""!=this.watchPath&&this.VM.bindPath(this.watchPath,this.onValueChanged,this),this.onValueInit()},t.prototype.onDisable=function(){this.templateMode?this.setMultPathEvent(!1):""!=this.watchPath&&this.VM.unbindPath(this.watchPath,this.onValueChanged,this)},t.prototype.setMultPathEvent=function(e){void 0===e&&(e=!0);for(var t=this.watchPathArr,o=0;o<t.length;o++){var n=t[o];e?this.VM.bindPath(n,this.onValueChanged,this):this.VM.unbindPath(n,this.onValueChanged,this)}},t.prototype.onValueInit=function(){},t.prototype.onValueChanged=function(e,t,o){},t=r([c],t)}(cc.Component));o.default=s,cc._RF.pop()},{"./ViewModel":"ViewModel"}],VMCompsEdit:[function(e,t,o){"use strict";cc._RF.push(t,"2359eFXKF5HFYS74K7Y17/U","VMCompsEdit");var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),r=this&&this.__decorate||function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(r=e[c])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var i,a=cc._decorator,c=a.ccclass,s=a.property,l=a.executeInEditMode,u=a.menu,p=a.help;(function(e){e[e.SEARCH_COMPONENT=0]="SEARCH_COMPONENT",e[e.ENABLE_COMPONENT=1]="ENABLE_COMPONENT",e[e.REPLACE_WATCH_PATH=2]="REPLACE_WATCH_PATH",e[e.DELETE_COMPONENT=3]="DELETE_COMPONENT"})(i||(i={}));var d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.findList=["VMBase","VMParent"],t.actionType=i.SEARCH_COMPONENT,t.allowDelete=!1,t.targetPath="game",t.replacePath="*",t.canCollectNodes=!1,t.collectNodes=[],t}return n(t,e),Object.defineProperty(t.prototype,"findTrigger",{get:function(){return!1},set:function(e){this.setComponents(0)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"enableTrigger",{get:function(){return!1},set:function(e){this.setComponents(1)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"disableTrigger",{get:function(){return!1},set:function(e){this.setComponents(2)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"deleteTrigger",{get:function(){return!1},set:function(e){this.setComponents(3)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"replaceTrigger",{get:function(){return!1},set:function(e){this.setComponents(4)},enumerable:!0,configurable:!0}),t.prototype.onLoad=function(){var e=this.getNodePath(this.node);console.error("you forget delete MVEditFinder,[path]",e)},t.prototype.setComponents=function(e){var t=this,o=this.findList,n="\u641c\u7d22\u5230\u5f53\u524d\u8282\u70b9\u4e0b\u9762\u7684\u7ec4\u4ef6";switch(e){case 0:n="\u641c\u7d22\u5230\u5f53\u524d\u8282\u70b9\u4e0b\u9762\u7684\u7ec4\u4ef6";break;case 1:n="\u6fc0\u6d3b\u4ee5\u4e0b\u8282\u70b9\u7684\u7ec4\u4ef6";break;case 2:n="\u5173\u95ed\u4ee5\u4e0b\u8282\u70b9\u7684\u7ec4\u4ef6";break;case 3:n="\u5220\u9664\u4ee5\u4e0b\u8282\u70b9\u7684\u7ec4\u4ef6";break;case 4:n="\u66ff\u6362\u4ee5\u4e0b\u8282\u70b9\u7684\u8def\u5f84"}cc.log(n),cc.log("______________________"),o.forEach(function(o){t.searchComponent(o,e)}),cc.log("______________________")},t.prototype.searchComponent=function(e,t){var o=this;void 0===t&&(t=0),this.collectNodes=[];var n=this.node.getComponentsInChildren(e);null==n||n.length<1||(cc.log("["+e+"]:"),n.forEach(function(e){var n="";switch(t<=3&&(n=!0===e.templateMode?e.watchPathArr?":[Path:"+e.watchPathArr.join("|")+"]":"":e.watchPath?":[Path:"+e.watchPath+"]":""),cc.log(o.getNodePath(e.node)+n),t){case 0:o.canCollectNodes&&-1===o.collectNodes.indexOf(e.node)&&o.collectNodes.push(e.node);break;case 1:e.enabled=!0;break;case 2:e.enabled=!1;break;case 3:e.node.removeComponent(e);break;case 4:var r=o.targetPath,i=o.replacePath;if(!0===e.templateMode)for(var a=0;a<e.watchPathArr.length;a++){var c=e.watchPathArr[a];e.watchPathArr[a]=o.replaceNodePath(c,r,i)}else e.watchPath=o.replaceNodePath(e.watchPath,r,i)}}))},t.prototype.replaceNodePath=function(e,t,o){for(var n=e.split("."),r=t.split("."),i=o.split("."),a=!0,c=0;c<r.length;c++)if(n[c]!==r[c]){a=!1;break}if(!0===a){for(c=0;c<i.length;c++)n[c]=i[c];cc.log(" \u8def\u5f84\u66f4\u65b0:",e,">>>",n.join("."))}return n.join(".")},t.prototype.getNodePath=function(e){for(var t=e,o=[];t;){var n=t.getParent();if(!n)break;o.push(t.name),t=n}return o.reverse().join("/")},r([s({type:[cc.String]})],t.prototype,"findList",void 0),r([s({type:cc.Enum(i)})],t.prototype,"actionType",void 0),r([s({tooltip:"\u52fe\u9009\u540e,\u4f1a\u81ea\u52a8\u67e5\u627e find list \u4e2d\u586b\u5199\u7684\u7ec4\u4ef6",visible:function(){return this.actionType===i.SEARCH_COMPONENT}})],t.prototype,"findTrigger",null),r([s({tooltip:"\u52fe\u9009\u540e,\u4f1a\u6279\u91cf\u6fc0\u6d3b find list \u4e2d\u586b\u5199\u7684\u7ec4\u4ef6",visible:function(){return this.actionType===i.ENABLE_COMPONENT}})],t.prototype,"enableTrigger",null),r([s({tooltip:"\u52fe\u9009\u540e,\u4f1a\u6279\u91cf\u5173\u95ed find list \u4e2d\u586b\u5199\u7684\u7ec4\u4ef6",visible:function(){return this.actionType===i.ENABLE_COMPONENT}})],t.prototype,"disableTrigger",null),r([s({tooltip:"\u5141\u8bb8\u5220\u9664\u8282\u70b9\u7684\u7ec4\u4ef6,\u786e\u5b9a\u9700\u8981\u79fb\u9664\u8bf7\u52fe\u9009,\u9632\u6b62\u8bef\u64cd\u4f5c",visible:function(){return this.actionType===i.DELETE_COMPONENT}})],t.prototype,"allowDelete",void 0),r([s({tooltip:"\u52fe\u9009\u540e,\u4f1a\u6279\u91cf\u5220\u9664 find list \u4e2d\u586b\u5199\u7684\u7ec4\u4ef6",displayName:"[ X DELETE X ]",visible:function(){return this.allowDelete&&this.actionType===i.DELETE_COMPONENT}})],t.prototype,"deleteTrigger",null),r([s({tooltip:"\u52fe\u9009\u540e,\u4f1a\u6279\u91cf\u66ff\u6362\u6389\u6307\u5b9a\u7684\u8def\u5f84",visible:function(){return this.actionType===i.REPLACE_WATCH_PATH}})],t.prototype,"replaceTrigger",null),r([s({tooltip:"\u5339\u914d\u7684\u8def\u5f84,\u5339\u914d\u89c4\u5219: \u641c\u7d22\u5f00\u5934\u4e3a game\u7684\u8def\u5f84",visible:function(){return this.actionType===i.REPLACE_WATCH_PATH}})],t.prototype,"targetPath",void 0),r([s({tooltip:"\u66ff\u6362\u7684\u8def\u5f84,\u5c06\u5339\u914d\u5230\u7684\u8def\u5f84\u66ff\u6362",visible:function(){return this.actionType===i.REPLACE_WATCH_PATH}})],t.prototype,"replacePath",void 0),r([s({tooltip:"\u662f\u5426\u641c\u96c6\u7ed1\u5b9aVM\u7ec4\u4ef6\u7684\u8282\u70b9?",visible:function(){return this.actionType===i.SEARCH_COMPONENT}})],t.prototype,"canCollectNodes",void 0),r([s({type:[cc.Node],readonly:!0,tooltip:"\u6536\u96c6\u5230\u7ed1\u5b9a\u4e86VM\u7ec4\u4ef6\u76f8\u5173\u7684\u8282\u70b9\uff0c\u53ef\u4ee5\u81ea\u5df1\u8df3\u8f6c\u8fc7\u53bb",visible:function(){return this.canCollectNodes&&this.actionType===i.SEARCH_COMPONENT}})],t.prototype,"collectNodes",void 0),t=r([c,l,u("ModelViewer/Edit-Comps (\u5feb\u901f\u7ec4\u4ef6\u64cd\u4f5c)"),p("https://github.com/wsssheep/cocos_creator_mvvm_tools/blob/master/docs/VMCompsEdit.md")],t)}(cc.Component);o.default=d,cc._RF.pop()},{}],VMCustom:[function(e,t,o){"use strict";cc._RF.push(t,"ce662fwsSVPLKpmHx+KocFu","VMCustom");var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),r=this&&this.__decorate||function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(r=e[c])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var i=e("./VMBase"),a=cc._decorator,c=a.ccclass,s=a.property,l=a.executeInEditMode,u=a.menu,p=a.help,d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.controller=!1,t.watchPath="",t.componentName="",t.componentProperty="",t.refreshRate=.1,t._timer=0,t._watchComponent=null,t._canWatchComponent=!1,t._oldValue=null,t}return n(t,e),t.prototype.onLoad=function(){e.prototype.onLoad.call(this),this.checkEditorComponent(),this._watchComponent=this.node.getComponent(this.componentName),this.checkComponentState()},t.prototype.onRestore=function(){this.checkEditorComponent()},t.prototype.start=function(){this.onValueInit()},t.prototype.checkEditorComponent=function(){},t.prototype.checkComponentState=function(){this._canWatchComponent=!1,this._watchComponent?this.componentProperty?this.componentProperty in this._watchComponent!=!1?this._canWatchComponent=!0:console.error("\u9700\u8981\u76d1\u542c\u7684\u7ec4\u4ef6\u7684\u5c5e\u6027\u4e0d\u5b58\u5728"):console.error("\u672a\u8bbe\u7f6e\u9700\u8981\u76d1\u542c\u7684\u7ec4\u4ef6 \u7684\u5c5e\u6027"):console.error("\u672a\u8bbe\u7f6e\u9700\u8981\u76d1\u542c\u7684\u7ec4\u4ef6")},t.prototype.getComponentValue=function(){return this._watchComponent[this.componentProperty]},t.prototype.setComponentValue=function(e){"cc.Toggle"==this.componentName?(1==e&&this.node.getComponent(cc.Toggle).check(),0==e&&this.node.getComponent(cc.Toggle).uncheck()):this._watchComponent[this.componentProperty]=e},t.prototype.onValueInit=function(){this.setComponentValue(this.VM.getValue(this.watchPath))},t.prototype.onValueController=function(e,t){this.VM.setValue(this.watchPath,e)},t.prototype.onValueChanged=function(e,t,o){this.setComponentValue(e)},t.prototype.update=function(e){if(this.controller&&this._canWatchComponent&&!1!==this._watchComponent.enabled&&(this._timer+=e,!(this._timer<this.refreshRate))){this._timer=0;var t=this._oldValue,o=this.getComponentValue();this._oldValue!==o&&(this._oldValue=this.getComponentValue(),this.onValueController(o,t))}},r([s({tooltip:"\u6fc0\u6d3bcontroller,\u4ee5\u5f00\u542f\u53cc\u5411\u7ed1\u5b9a\uff0c\u5426\u5219\u53ea\u80fd\u63a5\u6536\u6d88\u606f"})],t.prototype,"controller",void 0),r([s],t.prototype,"watchPath",void 0),r([s({tooltip:"\u7ed1\u5b9a\u7ec4\u4ef6\u7684\u540d\u5b57"})],t.prototype,"componentName",void 0),r([s({tooltip:"\u7ec4\u4ef6\u4e0a\u9700\u8981\u76d1\u542c\u7684\u5c5e\u6027"})],t.prototype,"componentProperty",void 0),r([s({tooltip:"\u5237\u65b0\u95f4\u9694\u9891\u7387(\u53ea\u5f71\u54cd\u810f\u68c0\u67e5\u7684\u9891\u7387)",step:.01,range:[0,1],visible:function(){return!0===this.controller}})],t.prototype,"refreshRate",void 0),t=r([c,l,u("ModelViewer/VM-Custom (\u81ea\u5b9a\u4e49VM)"),p("https://github.com/wsssheep/cocos_creator_mvvm_tools/blob/master/docs/VMCustom.md")],t)}(i.default);o.default=d,cc._RF.pop()},{"./VMBase":"VMBase"}],VMEvent:[function(e,t,o){"use strict";cc._RF.push(t,"a9ce7kf8XZJeLPlT2iWn2zD","VMEvent");var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),r=this&&this.__decorate||function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(r=e[c])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var i,a=e("./VMBase"),c=cc._decorator,s=c.ccclass,l=c.property,u=c.executeInEditMode,p=c.menu,d=c.help;(function(e){e[e.none=0]="none",e[e["=="]=1]="==",e[e["!="]=2]="!=",e[e[">"]=3]=">",e[e[">="]=4]=">=",e[e["<"]=5]="<",e[e["<="]=6]="<="})(i||(i={}));var h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.templateMode=!1,t.watchPath="",t.triggerOnce=!1,t.watchPathArr=[],t.filterMode=i.none,t.compareValue="",t.changeEvents=[],t}return n(t,e),t.prototype.onValueInit=function(){},t.prototype.onValueChanged=function(e,t,o){this.conditionCheck(e,this.compareValue)&&(Array.isArray(this.changeEvents)&&this.changeEvents.forEach(function(n){n.emit([e,t,o])}),!0===this.triggerOnce&&(this.enabled=!1))},t.prototype.conditionCheck=function(e,t){var o=i;switch(this.filterMode){case o.none:return!0;case o["=="]:if(e==t)return!0;break;case o["!="]:if(e!=t)return!0;break;case o["<"]:if(e<t)return!0;break;case o[">"]:if(e>t)return!0;break;case o[">="]:if(e>=t)return!0;break;case o["<"]:if(e<t)return!0;break;case o["<="]:if(e<=t)return!0}return!1},r([l({tooltip:"\u4f7f\u7528\u6a21\u677f\u6a21\u5f0f\uff0c\u53ef\u4ee5\u4f7f\u7528\u591a\u8def\u5f84\u76d1\u542c"})],t.prototype,"templateMode",void 0),r([l({tooltip:"\u76d1\u542c\u83b7\u53d6\u503c\u7684\u8def\u5f84",visible:function(){return!1===this.templateMode}})],t.prototype,"watchPath",void 0),r([l({tooltip:"\u89e6\u53d1\u4e00\u6b21\u540e\u4f1a\u81ea\u52a8\u5173\u95ed\u8be5\u4e8b\u4ef6"})],t.prototype,"triggerOnce",void 0),r([l({tooltip:"\u76d1\u542c\u83b7\u53d6\u503c\u7684\u591a\u6761\u8def\u5f84,\u8fd9\u4e9b\u503c\u7684\u6539\u53d8\u90fd\u4f1a\u901a\u8fc7\u8fd9\u4e2a\u51fd\u6570\u56de\u8c03,\u8bf7\u4f7f\u7528 pathArr \u533a\u5206\u83b7\u53d6\u7684\u503c ",type:[cc.String],visible:function(){return!0===this.templateMode}})],t.prototype,"watchPathArr",void 0),r([l({tooltip:"\u8fc7\u6ee4\u6a21\u5f0f\uff0c\u4f1a\u6839\u636e\u6761\u4ef6\u8fc7\u6ee4\u6389\u65f6\u95f4\u7684\u89e6\u53d1",type:cc.Enum(i)})],t.prototype,"filterMode",void 0),r([l({visible:function(){return this.filterMode!==i.none}})],t.prototype,"compareValue",void 0),r([l([cc.Component.EventHandler])],t.prototype,"changeEvents",void 0),t=r([s,u,p("ModelViewer/VM-EventCall(\u8c03\u7528\u51fd\u6570)"),d("https://github.com/wsssheep/cocos_creator_mvvm_tools/blob/master/docs/VMEvent.md")],t)}(a.default);o.default=h,cc._RF.pop()},{"./VMBase":"VMBase"}],VMLabel:[function(e,t,o){"use strict";cc._RF.push(t,"545c05XsG9GDJispEGWKvYv","VMLabel");var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),r=this&&this.__decorate||function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(r=e[c])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var i=e("./VMBase"),a=e("./StringFormat"),c=cc._decorator,s=c.ccclass,l=c.property,u=c.menu,p=c.executeInEditMode,d=c.help,h={CC_LABEL:"cc.Label",CC_RICH_TEXT:"cc.RichText",CC_EDIT_BOX:"cc.EditBox"},f=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.watchPath="",t.labelType=h.CC_LABEL,t.templateMode=!1,t.watchPathArr=[],t.templateValueArr=[],t.templateFormatArr=[],t.originText=null,t}return n(t,e),t.prototype.onRestore=function(){this.checkLabel()},t.prototype.onLoad=function(){e.prototype.onLoad.call(this),this.checkLabel(),this.templateMode&&(this.originText=this.getLabelValue(),this.parseTemplate())},t.prototype.start=function(){},t.prototype.parseTemplate=function(){var e=/\{\{(.+?)\}\}/,t=this.originText.match(/\{\{(.+?)\}\}/g);if(null!=t)for(var o=0;o<t.length;o++){var n=t[o].match(e)[1].split(":")[1]||"";this.templateFormatArr[o]=n}},t.prototype.getReplaceText=function(){var e=/\{\{(.+?)\}\}/,t=this.originText.match(/\{\{(.+?)\}\}/g);if(null==t)return"";for(var o=this.originText,n=0;n<t.length;n++){var r,i=t[n],a=i.match(e),c=parseInt(a[1]||"0")||0,s=this.templateFormatArr[n];r=this.templateValueArr[c],o=o.replace(i,this.getValueFromFormat(r,s))}return o},t.prototype.getValueFromFormat=function(e,t){return a.StringFormatFunction.deal(e,t)},t.prototype.onValueInit=function(){if(!1===this.templateMode)this.setLabelValue(this.VM.getValue(this.watchPath));else{for(var e=this.watchPathArr.length,t=0;t<e;t++)this.templateValueArr[t]=this.VM.getValue(this.watchPathArr[t],"?");this.setLabelValue(this.getReplaceText())}},t.prototype.onValueChanged=function(e,t,o){if(!1===this.templateMode)this.setLabelValue(e);else{var n=o.join("."),r=this.watchPathArr.findIndex(function(e){return e===n});r>=0&&(this.templateValueArr[r]=e,this.setLabelValue(this.getReplaceText()))}},t.prototype.setLabelValue=function(e){this.getComponent(this.labelType).string=e+""},t.prototype.getLabelValue=function(){return this.getComponent(this.labelType).string},t.prototype.checkLabel=function(){for(var e=["cc.Label","cc.RichText","cc.EditBox"],t=0;t<e.length;t++){var o=e[t];if(this.node.getComponent(o))return this.labelType=o,!0}return cc.error("\u6ca1\u6709\u6302\u8f7d\u4efb\u4f55label\u7ec4\u4ef6"),!1},r([l({visible:function(){return!1===this.templateMode}})],t.prototype,"watchPath",void 0),r([l({readonly:!0})],t.prototype,"labelType",void 0),r([l({tooltip:"\u662f\u5426\u542f\u7528\u6a21\u677f\u4ee3\u7801,\u53ea\u80fd\u5728\u8fd0\u884c\u65f6\u4e4b\u524d\u8bbe\u7f6e,\n\u5c06\u4f1a\u52a8\u6001\u89e3\u6790\u6a21\u677f\u8bed\u6cd5 {{0}},\u5e76\u4e14\u81ea\u52a8\u8bbe\u7f6e\u76d1\u542c\u7684\u8def\u5f84"})],t.prototype,"templateMode",void 0),r([l({type:[cc.String],visible:function(){return!0===this.templateMode}})],t.prototype,"watchPathArr",void 0),t=r([s,p,u("ModelViewer/VM-Label(\u6587\u672cVM)"),d("https://github.com/wsssheep/cocos_creator_mvvm_tools/blob/master/docs/VMLabel.md")],t)}(i.default);o.default=f,cc._RF.pop()},{"./StringFormat":"StringFormat","./VMBase":"VMBase"}],VMModify:[function(e,t,o){"use strict";cc._RF.push(t,"7d2a4voaOJJGJZRWFPG6Bk7","VMModify");var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),r=this&&this.__decorate||function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(r=e[c])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var i,a=e("./VMBase"),c=cc._decorator,s=c.ccclass,l=c.property,u=c.menu,p=c.help;(function(e){e[e.MIN=0]="MIN",e[e.MAX=1]="MAX",e[e.MIN_MAX=2]="MIN_MAX"})(i||(i={}));var d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.watchPath="",t.valueClamp=!1,t.valueClampMode=i.MIN_MAX,t.valueMin=0,t.valueMax=1,t}return n(t,e),t.prototype.start=function(){},t.prototype.clampValue=function(e){var t=this.valueMin,o=this.valueMax;if(0==this.valueClamp)return e;switch(this.valueClampMode){case i.MIN_MAX:e>o&&(e=o),e<t&&(e=t);break;case i.MIN:e<t&&(e=t);break;case i.MAX:e>o&&(e=o)}return e},t.prototype.vAddInt=function(e,t){this.vAdd(e,t,!0)},t.prototype.vSubInt=function(e,t){this.vSub(e,t,!0)},t.prototype.vMulInt=function(e,t){this.vMul(e,t,!0)},t.prototype.vDivInt=function(e,t){this.vDiv(e,t,!0)},t.prototype.vAdd=function(e,t,o){void 0===o&&(o=!1);var n=parseFloat(t),r=this.VM.getValue(this.watchPath,0)+n;o&&(r=Math.round(r)),this.VM.setValue(this.watchPath,this.clampValue(r))},t.prototype.vSub=function(e,t,o){void 0===o&&(o=!1);var n=parseFloat(t),r=this.VM.getValue(this.watchPath,0)-n;o&&(r=Math.round(r)),this.VM.setValue(this.watchPath,this.clampValue(r))},t.prototype.vMul=function(e,t,o){void 0===o&&(o=!1);var n=parseFloat(t),r=this.VM.getValue(this.watchPath,0)*n;o&&(r=Math.round(r)),this.VM.setValue(this.watchPath,this.clampValue(r))},t.prototype.vDiv=function(e,t,o){void 0===o&&(o=!1);var n=parseFloat(t),r=this.VM.getValue(this.watchPath,0)/n;o&&(r=Math.round(r)),this.VM.setValue(this.watchPath,this.clampValue(r))},t.prototype.vString=function(e,t){var o=t;this.VM.setValue(this.watchPath,o)},t.prototype.vNumberInt=function(e,t){this.vNumber(e,t,!0)},t.prototype.vNumber=function(e,t,o){void 0===o&&(o=!1);var n=parseFloat(t);o&&(n=Math.round(n)),this.VM.setValue(this.watchPath,this.clampValue(n))},r([l],t.prototype,"watchPath",void 0),r([l()],t.prototype,"valueClamp",void 0),r([l({type:cc.Enum(i),visible:function(){return!0===this.valueClamp}})],t.prototype,"valueClampMode",void 0),r([l({visible:function(){return!0===this.valueClamp&&this.valueClampMode!==i.MAX}})],t.prototype,"valueMin",void 0),r([l({visible:function(){return!0===this.valueClamp&&this.valueClampMode!==i.MIN}})],t.prototype,"valueMax",void 0),t=r([s,u("ModelViewer/VM-Modify(\u4fee\u6539Model)"),p("https://github.com/wsssheep/cocos_creator_mvvm_tools/blob/master/docs/VMModify.md")],t)}(a.default);o.default=d,cc._RF.pop()},{"./VMBase":"VMBase"}],VMParent:[function(e,t,o){"use strict";cc._RF.push(t,"15ccciO+ZRH476sPKD/LvB7","VMParent");var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),r=this&&this.__decorate||function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(r=e[c])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var i=e("./ViewModel"),a=cc._decorator,c=a.ccclass,s=(a.property,a.help),l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.tag="_temp",t.data={},t.VM=i.VM,t}return n(t,e),t.prototype.onLoad=function(){if(null!=this.data){this.tag="_temp<"+this.node.uuid.replace(".","")+">",i.VM.add(this.data,this.tag);for(var e=this.getVMComponents(),t=0;t<e.length;t++){var o=e[t];this.replaceVMPath(o,this.tag)}this.onBind()}},t.prototype.onBind=function(){},t.prototype.onUnBind=function(){},t.prototype.replaceVMPath=function(e,t){var o=e.watchPath;if(1==e.templateMode){var n=e.watchPathArr;if(n)for(var r=0;r<n.length;r++){var i=n[r];n[r]=i.replace("*",t)}}else"*"===o.split(".")[0]&&(e.watchPath=o.replace("*",t))},t.prototype.getVMComponents=function(){var e=this,t=this.node.getComponentsInChildren("VMBase"),o=[];return this.node.getComponentsInChildren("VMParent").filter(function(t){return t.uuid!==e.uuid}).forEach(function(e){o=o.concat(e.getComponentsInChildren("VMBase"))}),t=t.filter(function(e){return o.indexOf(e)<0})},t.prototype.onDestroy=function(){this.onUnBind(),i.VM.remove(this.tag),this.data=null},t=r([c,s("https://github.com/wsssheep/cocos_creator_mvvm_tools/blob/master/docs/VMParent.md")],t)}(cc.Component);o.default=l,cc._RF.pop()},{"./ViewModel":"ViewModel"}],VMProgress:[function(e,t,o){"use strict";cc._RF.push(t,"2a50eqI7JZNV5Sh0y/Qd9C6","VMProgress");var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),r=this&&this.__decorate||function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(r=e[c])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var i=e("./VMCustom"),a=e("./StringFormat"),c=cc._decorator,s=c.ccclass,l=c.property,u=c.menu,p=c.help,d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.watchPath="",t.watchPathArr=["[min]","[max]"],t.templateMode=!0,t.stringFormat="",t}return n(t,e),t.prototype.onLoad=function(){(this.watchPathArr.length<2||"[min]"==this.watchPathArr[0]||"[max]"==this.watchPathArr[1])&&console.error("VMProgress must have two values!"),e.prototype.onLoad.call(this)},t.prototype.start=function(){this.onValueInit()},t.prototype.onValueInit=function(){for(var e=this.watchPathArr.length,t=0;t<e;t++)this.templateValueArr[t]=this.VM.getValue(this.watchPathArr[t]);var o=this.templateValueArr[0]/this.templateValueArr[1];this.setComponentValue(o)},t.prototype.setComponentValue=function(t){if(""!==this.stringFormat){var o=a.StringFormatFunction.deal(t,this.stringFormat);e.prototype.setComponentValue.call(this,o)}else e.prototype.setComponentValue.call(this,t)},t.prototype.onValueController=function(e,t){var o=Math.round(e*this.templateValueArr[1]);Number.isNaN(o)&&(o=0),this.VM.setValue(this.watchPathArr[0],o)},t.prototype.onValueChanged=function(e,t,o){if(!1!==this.templateMode){var n=o.join("."),r=this.watchPathArr.findIndex(function(e){return e===n});r>=0&&(this.templateValueArr[r]=e);var i=this.templateValueArr[0]/this.templateValueArr[1];i>1&&(i=1),(i<0||Number.isNaN(i))&&(i=0),this.setComponentValue(i)}},r([l({visible:!1,override:!0})],t.prototype,"watchPath",void 0),r([l({type:[cc.String],tooltip:"\u7b2c\u4e00\u4e2a\u503c\u662fmin \u503c\uff0c\u7b2c\u4e8c\u4e2a\u503c \u662f max \u503c\uff0c\u4f1a\u8ba1\u7b97\u51fa\u4e24\u8005\u7684\u6bd4\u4f8b"})],t.prototype,"watchPathArr",void 0),r([l({visible:function(){return"string"===this.componentProperty},tooltip:"\u5b57\u7b26\u4e32\u683c\u5f0f\u5316\uff0c\u548c VMLabel \u7684\u5b57\u6bb5\u4e00\u6837\uff0c\u9700\u8981\u586b\u5165\u5bf9\u5e94\u7684\u683c\u5f0f\u5316\u5b57\u7b26\u4e32"})],t.prototype,"stringFormat",void 0),t=r([s,u("ModelViewer/VM-Progress (VM-\u8fdb\u5ea6\u6761)"),p("https://github.com/wsssheep/cocos_creator_mvvm_tools/blob/master/docs/VMProgress.md")],t)}(i.default);o.default=d,cc._RF.pop()},{"./StringFormat":"StringFormat","./VMCustom":"VMCustom"}],VMState:[function(e,t,o){"use strict";cc._RF.push(t,"47052uw/Y5O1LXaLObj4ARx","VMState");var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),r=this&&this.__decorate||function(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(r=e[c])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var i,a,c,s=e("./ViewModel"),l=e("./VMBase"),u=cc._decorator,p=u.ccclass,d=u.property,h=u.menu,f=u.help;(function(e){e[e["=="]=0]="==",e[e["!="]=1]="!=",e[e[">"]=2]=">",e[e[">="]=3]=">=",e[e["<"]=4]="<",e[e["<="]=5]="<=",e[e.range=6]="range"})(i||(i={})),function(e){e[e.NODE_ACTIVE=0]="NODE_ACTIVE",e[e.NODE_VISIBLE=1]="NODE_VISIBLE",e[e.NODE_OPACITY=2]="NODE_OPACITY",e[e.NODE_COLOR=3]="NODE_COLOR",e[e.COMPONENT_CUSTOM=4]="COMPONENT_CUSTOM"}(a||(a={})),function(e){e[e.NODE_INDEX=0]="NODE_INDEX",e[e.NODE_NAME=1]="NODE_NAME"}(c||(c={}));var y=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.watchPath="",t.foreachChildMode=!1,t.condition=i["=="],t.foreachChildType=c.NODE_INDEX,t.valueA=0,t.valueB=0,t.valueAction=a.NODE_ACTIVE,t.valueActionOpacity=0,t.valueActionColor=cc.color(155,155,155),t.valueComponentName="",t.valueComponentProperty="",t.valueComponentDefaultValue="",t.valueComponentActionValue="",t.watchNodes=[],t}return n(t,e),t.prototype.onLoad=function(){e.prototype.onLoad.call(this),0==this.watchNodes.length&&(this.valueAction!==a.NODE_ACTIVE&&!1===this.foreachChildMode&&this.watchNodes.push(this.node),this.watchNodes=this.watchNodes.concat(this.node.children))},t.prototype.start=function(){this.enabled&&this.onValueInit()},t.prototype.onValueInit=function(){var e=s.VM.getValue(this.watchPath);this.checkNodeFromValue(e)},t.prototype.onValueChanged=function(e,t,o){this.checkNodeFromValue(e)},t.prototype.checkNodeFromValue=function(e){var t=this;if(this.foreachChildMode)this.watchNodes.forEach(function(o,n){var r=t.foreachChildType===c.NODE_INDEX?n:o.name,i=t.conditionCheck(e,r);t.setNodeState(o,i)});else{var o=this.conditionCheck(e,this.valueA,this.valueB);this.setNodesStates(o)}},t.prototype.setNodesStates=function(e){var t=this,o=e;this.watchNodes.forEach(function(e){t.setNodeState(e,o)})},t.prototype.setNodeState=function(e,t){var o=this.valueAction,n=t,r=a;switch(o){case r.NODE_ACTIVE:e.active=!!n;break;case r.NODE_VISIBLE:e.opacity=n?255:0;break;case r.NODE_COLOR:e.color=n?this.valueActionColor:cc.color(255,255,255);break;case r.NODE_OPACITY:e.opacity=n?this.valueActionOpacity:255;break;case r.COMPONENT_CUSTOM:var i=e.getComponent(this.valueComponentName);if(null==i)return;this.valueComponentProperty in i&&(i[this.valueComponentProperty]=n?this.valueComponentActionValue:this.valueComponentDefaultValue)}},t.prototype.conditionCheck=function(e,t,o){var n=i;switch(this.condition){case n["=="]:if(e==t)return!0;break;case n["!="]:if(e!=t)return!0;break;case n["<"]:if(e<t)return!0;break;case n[">"]:if(e>t)return!0;break;case n[">="]:if(e>=t)return!0;break;case n["<"]:if(e<t)return!0;break;case n["<="]:if(e<=t)return!0;break;case n.range:if(e>=t&&e<=o)return!0}return!1},r([d],t.prototype,"watchPath",void 0),r([d({tooltip:"\u904d\u5386\u5b50\u8282\u70b9,\u6839\u636e\u5b50\u8282\u70b9\u7684\u540d\u5b57\u6216\u540d\u5b57\u8f6c\u6362\u4e3a\u503c\uff0c\u5224\u65ad\u503c\u6ee1\u8db3\u6761\u4ef6 \u6765\u6fc0\u6d3b"})],t.prototype,"foreachChildMode",void 0),r([d({type:cc.Enum(i)})],t.prototype,"condition",void 0),r([d({type:cc.Enum(c),tooltip:"\u904d\u5386\u5b50\u8282\u70b9,\u6839\u636e\u5b50\u8282\u70b9\u7684\u540d\u5b57\u8f6c\u6362\u4e3a\u503c\uff0c\u5224\u65ad\u503c\u6ee1\u8db3\u6761\u4ef6 \u6765\u6fc0\u6d3b",visible:function(){return!0===this.foreachChildMode}})],t.prototype,"foreachChildType",void 0),r([d({displayName:"Value: a",visible:function(){return!1===this.foreachChildMode}})],t.prototype,"valueA",void 0),r([d({displayName:"Value: b",visible:function(){return!1===this.foreachChildMode&&this.condition===i.range}})],t.prototype,"valueB",void 0),r([d({type:cc.Enum(a),tooltip:"\u4e00\u65e6\u6ee1\u8db3\u6761\u4ef6\u5c31\u5bf9\u8282\u70b9\u6267\u884c\u64cd\u4f5c"})],t.prototype,"valueAction",void 0),r([d({visible:function(){return this.valueAction===a.NODE_OPACITY},range:[0,255],type:cc.Integer,displayName:"Action Opacity"})],t.prototype,"valueActionOpacity",void 0),r([d({visible:function(){return this.valueAction===a.NODE_COLOR},displayName:"Action Color"})],t.prototype,"valueActionColor",void 0),r([d({visible:function(){return this.valueAction===a.COMPONENT_CUSTOM},displayName:"Component Name"})],t.prototype,"valueComponentName",void 0),r([d({visible:function(){return this.valueAction===a.COMPONENT_CUSTOM},displayName:"Component Property"})],t.prototype,"valueComponentProperty",void 0),r([d({visible:function(){return this.valueAction===a.COMPONENT_CUSTOM},displayName:"Default Value"})],t.prototype,"valueComponentDefaultValue",void 0),r([d({visible:function(){return this.valueAction===a.COMPONENT_CUSTOM},displayName:"Action Value"})],t.prototype,"valueComponentActionValue",void 0),r([d({type:[cc.Node],tooltip:"\u9700\u8981\u6267\u884c\u6761\u4ef6\u7684\u8282\u70b9\uff0c\u5982\u679c\u4e0d\u586b\u5199\u5219\u9ed8\u8ba4\u4f1a\u6267\u884c\u672c\u8282\u70b9\u4ee5\u53ca\u672c\u8282\u70b9\u7684\u6240\u6709\u5b50\u8282\u70b9 \u7684\u72b6\u6001"})],t.prototype,"watchNodes",void 0),t=r([p,h("ModelViewer/VM-State (VM\u72b6\u6001\u63a7\u5236)"),f("https://github.com/wsssheep/cocos_creator_mvvm_tools/blob/master/docs/VMState.md")],t)}(l.default);o.default=y,cc._RF.pop()},{"./VMBase":"VMBase","./ViewModel":"ViewModel"}],ViewModel:[function(e,t,o){"use strict";cc._RF.push(t,"54f75k4X+RP0qaXOzrfZysL","ViewModel"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("./JsonOb"),r="VC:";function i(e,t,o,n){void 0===n&&(n="");for(var r=t.split("."),i=0;i<r.length;i++){var a=r[i];if(a in e==!1){console.error("["+a+"] not find in "+n+"."+t);break}i==r.length-1?e[a]=o:e=e[a]}}function a(e,t,o,n){void 0===n&&(n="");for(var r=t.split("."),i=0;i<r.length;i++){var a=r[i];if(a in e==!1)return console.error("["+a+"] not find in "+n+"."+t),o;e=e[a]}return null!==e&&void 0!==e||(e=o),e}var c=function(){function e(e,t){this._tag=null,this.active=!0,this.emitToRootPath=!1,new n.JsonOb(e,this._callback.bind(this)),this.$data=e,this._tag=t}return e.prototype._callback=function(e,t,o){if(1==this.active){var n=r+this._tag+"."+o.join(".");if(cc.director.emit(n,e,t,[this._tag].concat(o)),this.emitToRootPath&&cc.director.emit(r+this._tag,e,t,o),o.length>=2)for(var i=0;i<o.length-1;i++)o[i]}},e.prototype.setValue=function(e,t){i(this.$data,e,t,this._tag)},e.prototype.getValue=function(e,t){return a(this.$data,e,t,this._tag)},e}(),s=function(){function e(){this._mvs=[],this.EMIT_HEAD=r,this.setObjValue=i,this.getObjValue=a}return e.prototype.add=function(e,t,o){void 0===t&&(t="global"),void 0===o&&(o=!1);var n=new c(e,t),r=this._mvs.find(function(e){return e.tag===t});t.includes(".")?console.error("cant write . in tag:",t):r?console.error("already set VM tag:"+t):(n.emitToRootPath=o,this._mvs.push({tag:t,vm:n}))},e.prototype.remove=function(e){var t=this._mvs.findIndex(function(t){return t.tag===e});t>=0&&this._mvs.splice(t,1)},e.prototype.get=function(e){var t=this._mvs.find(function(t){return t.tag===e});if(null!=t)return t.vm;console.error("cant find VM from:",e)},e.prototype.addValue=function(e,t){var o=(e=e.trim()).split(".");o.length<2&&console.error("Cant find path:"+e);var n=this.get(o[0]);if(n){var r=o.slice(1).join(".");n.setValue(r,n.getValue(r)+t)}else console.error("Cant Set VM:"+o[0])},e.prototype.getValue=function(e,t){var o=(e=e.trim()).split(".");if(o.length<2)console.error("Get Value Cant find path:"+e);else{var n=this.get(o[0]);if(n)return n.getValue(o.slice(1).join("."),t);console.error("Cant Get VM:"+o[0])}},e.prototype.setValue=function(e,t){var o=(e=e.trim()).split(".");if(o.length<2)console.error("Set Value Cant find path:"+e);else{var n=this.get(o[0]);n?n.setValue(o.slice(1).join("."),t):console.error("Cant Set VM:"+o[0])}},e.prototype.bindPath=function(e,t,o,n){""!=(e=e.trim())?"*"!==e.split(".")[0]?cc.director.on(r+e,t,o,n):console.error(e,"\u8def\u5f84\u4e0d\u5408\u6cd5,\u53ef\u80fd\u9519\u8bef\u8986\u76d6\u4e86 VMParent \u7684onLoad \u65b9\u6cd5, \u6216\u8005\u7236\u8282\u70b9\u5e76\u672a\u6302\u8f7d VMParent \u76f8\u5173\u7684\u7ec4\u4ef6\u811a\u672c"):console.error(o.node.name,"\u8282\u70b9\u7ed1\u5b9a\u7684\u8def\u5f84\u4e3a\u7a7a")},e.prototype.unbindPath=function(e,t,o){"*"!==(e=e.trim()).split(".")[0]?cc.director.off(r+e,t,o):console.error(e,"\u8def\u5f84\u4e0d\u5408\u6cd5,\u53ef\u80fd\u9519\u8bef\u8986\u76d6\u4e86 VMParent \u7684onLoad \u65b9\u6cd5, \u6216\u8005\u7236\u8282\u70b9\u5e76\u672a\u6302\u8f7d VMParent \u76f8\u5173\u7684\u7ec4\u4ef6\u811a\u672c")},e.prototype.inactive=function(){this._mvs.forEach(function(e){e.vm.active=!1})},e.prototype.active=function(){this._mvs.forEach(function(e){e.vm.active=!0})},e}();o.VM=new s,cc._RF.pop()},{"./JsonOb":"JsonOb"}],WayControl:[function(e,t,o){"use strict";cc._RF.push(t,"12e53iDwaVJoZSDwDQ05OB2","WayControl"),Object.defineProperty(o,"__esModule",{value:!0});var n=cc._decorator,r=n.ccclass,i=n.property,a=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.waylist=[],t.mainnode=null,t.canvas=null,t.nowid=0,t}return __extends(t,e),t.prototype.start=function(){},t.prototype.update=function(e){},__decorate([i(cc.Node)],t.prototype,"waylist",void 0),__decorate([i(cc.Node)],t.prototype,"mainnode",void 0),__decorate([i(cc.Node)],t.prototype,"canvas",void 0),t=__decorate([r],t)}(cc.Component);o.default=a,cc._RF.pop()},{}],"cos-wx-sdk-v5":[function(e,t,o){"use strict";cc._RF.push(t,"cf3d4nSco9Mc45b87jcueHz","cos-wx-sdk-v5");var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(e,r){"object"==(void 0===o?"undefined":n(o))&&"object"==(void 0===t?"undefined":n(t))?t.exports=r():"function"==typeof define&&define.amd?define([],r):"object"==(void 0===o?"undefined":n(o))?o.COS=r():e.COS=r()}(void 0,function(){return function(e){function t(n){if(o[n])return o[n].exports;var r=o[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,t),r.l=!0,r.exports}var o={};return t.m=e,t.c=o,t.i=function(e){return e},t.d=function(e,o,n){t.o(e,o)||Object.defineProperty(e,o,{configurable:!1,enumerable:!0,get:n})},t.n=function(e){var o=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(o,"a",o),o},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="D:\\github\\cos-wx-sdk-v5\\demo\\lib",t(t.s=4)}([function(e,t,o){function r(e){return encodeURIComponent(e).replace(/!/g,"%21").replace(/'/g,"%27").replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/\*/g,"%2A")}function i(e){return l(e,function(e){return"object"==(void 0===e?"undefined":n(e))?i(e):e})}function a(e,t){return s(t,function(o,n){e[n]=t[n]}),e}function c(e){return e instanceof Array}function s(e,t){for(var o in e)e.hasOwnProperty(o)&&t(e[o],o)}function l(e,t){var o=c(e)?[]:{};for(var n in e)e.hasOwnProperty(n)&&(o[n]=t(e[n],n));return o}var u=o(8),p=o(6),d=o(10),h=o(7),f=o(5).btoa,y=function(){},m=function(e){var t={};for(var o in e)e.hasOwnProperty(o)&&void 0!==e[o]&&null!==e[o]&&(t[o]=e[o]);return t},g=function(e,t){var o,n=new FileReader;FileReader.prototype.readAsBinaryString?(o=FileReader.prototype.readAsBinaryString,n.onload=function(){t(this.result)}):FileReader.prototype.readAsArrayBuffer?o=function(e){var o="",n=new FileReader;n.onload=function(e){for(var r=new Uint8Array(n.result),i=r.byteLength,a=0;a<i;a++)o+=String.fromCharCode(r[a]);t(o)},n.readAsArrayBuffer(e)}:console.error("FileReader not support readAsBinaryString"),o.call(n,e)},v=function(e,t){var o=t.Bucket,n=t.Region,r=t.Key;if(e.indexOf("Bucket")>-1||"deleteMultipleObject"===e||"multipartList"===e||"listObjectVersions"===e){if(!o)return"Bucket";if(!n)return"Region"}else if(e.indexOf("Object")>-1||e.indexOf("multipart")>-1||"sliceUploadFile"===e||"abortUploadTask"===e){if(!o)return"Bucket";if(!n)return"Region";if(!r)return"Key"}return!1},_=function(e,t){if(t=a({},t),"getAuth"!==e&&"getV4Auth"!==e&&"getObjectUrl"!==e){var o=t.Headers||{};if(t&&"object"==(void 0===t?"undefined":n(t))){!function(){for(var e in t)t.hasOwnProperty(e)&&e.indexOf("x-cos-")>-1&&(o[e]=t[e])}();b.each({"x-cos-mfa":"MFA","Content-MD5":"ContentMD5","Content-Length":"ContentLength","Content-Type":"ContentType",Expect:"Expect",Expires:"Expires","Cache-Control":"CacheControl","Content-Disposition":"ContentDisposition","Content-Encoding":"ContentEncoding",Range:"Range","If-Modified-Since":"IfModifiedSince","If-Unmodified-Since":"IfUnmodifiedSince","If-Match":"IfMatch","If-None-Match":"IfNoneMatch","x-cos-copy-source":"CopySource","x-cos-copy-source-Range":"CopySourceRange","x-cos-metadata-directive":"MetadataDirective","x-cos-copy-source-If-Modified-Since":"CopySourceIfModifiedSince","x-cos-copy-source-If-Unmodified-Since":"CopySourceIfUnmodifiedSince","x-cos-copy-source-If-Match":"CopySourceIfMatch","x-cos-copy-source-If-None-Match":"CopySourceIfNoneMatch","x-cos-acl":"ACL","x-cos-grant-read":"GrantRead","x-cos-grant-write":"GrantWrite","x-cos-grant-full-control":"GrantFullControl","x-cos-grant-read-acp":"GrantReadAcp","x-cos-grant-write-acp":"GrantWriteAcp","x-cos-storage-class":"StorageClass","x-cos-server-side-encryption-customer-algorithm":"SSECustomerAlgorithm","x-cos-server-side-encryption-customer-key":"SSECustomerKey","x-cos-server-side-encryption-customer-key-MD5":"SSECustomerKeyMD5","x-cos-server-side-encryption":"ServerSideEncryption","x-cos-server-side-encryption-cos-kms-key-id":"SSEKMSKeyId","x-cos-server-side-encryption-context":"SSEContext"},function(e,n){void 0!==t[e]&&(o[n]=t[e])}),t.Headers=m(o)}}return t},C=function(e){return Date.now()+(e||0)},b={noop:y,formatParams:_,apiWrapper:function(e,t){return function(o,n){"function"==typeof o&&(n=o,o={}),o=_(e,o);var r=function(e){return e&&e.headers&&(e.headers["x-cos-version-id"]&&(e.VersionId=e.headers["x-cos-version-id"]),e.headers["x-cos-delete-marker"]&&(e.DeleteMarker=e.headers["x-cos-delete-marker"])),e},i=function(e,t){n&&n(r(e),r(t))};if("getService"!==e&&"abortUploadTask"!==e){var a;if(a=v(e,o))return void i({error:"missing param "+a});if(o.Region){if(o.Region.indexOf("cos.")>-1)return void i({error:'param Region should not be start with "cos."'});if(!/^([a-z\d-]+)$/.test(o.Region))return void i({error:"Region format error."});this.options.CompatibilityMode||-1!==o.Region.indexOf("-")||"yfb"===o.Region||"default"===o.Region||console.warn("warning: param Region format error, find help here: https://cloud.tencent.com/document/product/436/6224")}if(o.Bucket){if(!/^([a-z\d-]+)-(\d+)$/.test(o.Bucket))if(o.AppId)o.Bucket=o.Bucket+"-"+o.AppId;else{if(!this.options.AppId)return void i({error:'Bucket should format as "test-1250000000".'});o.Bucket=o.Bucket+"-"+this.options.AppId}o.AppId&&(console.warn('warning: AppId has been deprecated, Please put it at the end of parameter Bucket(E.g Bucket:"test-1250000000" ).'),delete o.AppId)}}var c=t.call(this,o,i);if("getAuth"===e||"getObjectUrl"===e)return c}},xml2json:d,json2xml:h,md5:u,clearKey:m,getFileMd5:function(e,t){g(e,function(e){var o=u(e,!0);t(null,o)})},binaryBase64:function(e){var t,o,n,r="";for(t=0,o=e.length/2;t<o;t++)n=parseInt(e[2*t]+e[2*t+1],16),r+=String.fromCharCode(n);return f(r)},extend:a,isArray:c,isInArray:function(e,t){for(var o=!1,n=0;n<e.length;n++)if(t===e[n]){o=!0;break}return o},each:s,map:l,filter:function(e,t){var o=c(e),n=o?[]:{};for(var r in e)e.hasOwnProperty(r)&&t(e[r],r)&&(o?n.push(e[r]):n[r]=e[r]);return n},clone:i,uuid:function(){var e=function(){return(65536*(1+Math.random())|0).toString(16).substring(1)};return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()},camSafeUrlEncode:r,throttleOnProgress:function(e,t){function o(){if(r=0,t&&"function"==typeof t){n=Date.now();var o,i=Math.max(0,Math.round((c-a)/((n-s)/1e3)*100)/100);o=0===c&&0===e?1:Math.round(c/e*100)/100||0,s=n,a=c;try{t({loaded:c,total:e,speed:i,percent:o})}catch(e){}}}var n,r,i=this,a=0,c=0,s=Date.now();return function(t,n){if(t&&(c=t.loaded,e=t.total),n)clearTimeout(r),o();else{if(r)return;r=setTimeout(o,i.options.ProgressInterval)}}},getFileSize:function(e,t,o){var n;"string"==typeof t.Body&&(t.Body=new Blob([t.Body],{type:"text/plain"})),t.Body&&(t.Body instanceof Blob||"[object File]"===t.Body.toString()||"[object Blob]"===t.Body.toString())?(n=t.Body.size,t.ContentLength=n,o(null,n)):o({error:"params body format error, Only allow File|Blob|String."})},getSkewTime:C,getAuth:function(e){var t=(e=e||{}).SecretId,o=e.SecretKey,n=(e.method||e.Method||"get").toLowerCase(),a=i(e.Query||e.params||{}),c=i(e.Headers||e.headers||{}),s=e.Pathname||"/"+(e.Key||"");if(!t)return console.error("missing param SecretId");if(!o)return console.error("missing param SecretKey");var l=function(e){var t=[];for(var o in e)e.hasOwnProperty(o)&&t.push(o);return t.sort(function(e,t){return(e=e.toLowerCase())===(t=t.toLowerCase())?0:e>t?1:-1})},u=function(e){var t,o,n,i=[],a=l(e);for(t=0;t<a.length;t++)n=void 0===e[o=a[t]]||null===e[o]?"":""+e[o],o=r(o=o.toLowerCase()),n=r(n)||"",i.push(o+"="+n);return i.join("&")},d=Math.round(C(e.SystemClockOffset)/1e3)-1,h=d,f=e.Expires||e.expires,y=t,m=d+";"+(h+=void 0===f?900:1*f||0),g=d+";"+h,v=l(c).join(";").toLowerCase(),_=l(a).join(";").toLowerCase(),b=p.HmacSHA1(g,o).toString(),w=[n,s,u(a),u(c),""].join("\n"),S=["sha1",m,p.SHA1(w).toString(),""].join("\n");return["q-sign-algorithm=sha1","q-ak="+y,"q-sign-time="+m,"q-key-time="+g,"q-header-list="+v,"q-url-param-list="+_,"q-signature="+p.HmacSHA1(S,b).toString()].join("&")},isBrowser:!0,fileSlice:function(e,t,o){return e.slice?e.slice(t,o):e.mozSlice?e.mozSlice(t,o):e.webkitSlice?e.webkitSlice(t,o):void 0},getFileUUID:function(e,t){return e.name&&e.size&&e.lastModifiedDate&&t?b.md5([e.name,e.size,e.lastModifiedDate,t].join("::")):null},getBodyMd5:function(e,t,o){o=o||y,e&&"string"==typeof t?o(b.md5(t,!0)):o()}};e.exports=b},function(e,t){function o(e,t){for(var o in e)t[o]=e[o]}function r(e,t){function n(){}var r=e.prototype;if(Object.create){var i=Object.create(t.prototype);r.__proto__=i}r instanceof t||(n.prototype=t.prototype,o(r,n=new n),e.prototype=r=n),r.constructor!=e&&("function"!=typeof e&&console.error("unknow Class:"+e),r.constructor=e)}function i(e,t){if(t instanceof Error)var o=t;else o=this,Error.call(this,ie[e]),this.message=ie[e],Error.captureStackTrace&&Error.captureStackTrace(this,i);return o.code=e,t&&(this.message=this.message+": "+t),o}function a(){}function c(e,t){this._node=e,this._refresh=t,s(this)}function s(e){var t=e._node._inc||e._node.ownerDocument._inc;if(e._inc!=t){var n=e._refresh(e._node);K(e,"length",n.length),o(n,e),e._inc=t}}function l(){}function u(e,t){for(var o=e.length;o--;)if(e[o]===t)return o}function p(e,t,o,n){if(n?t[u(t,n)]=o:t[t.length++]=o,e){o.ownerElement=e;var r=e.ownerDocument;r&&(n&&_(r,e,n),v(r,e,o))}}function d(e,t,o){var n=u(t,o);if(!(n>=0))throw i(ce,new Error(e.tagName+"@"+o));for(var r=t.length-1;n<r;)t[n]=t[++n];if(t.length=r,e){var a=e.ownerDocument;a&&(_(a,e,o),o.ownerElement=null)}}function h(e){if(this._features={},e)for(var t in e)this._features=e[t]}function f(){}function y(e){return("<"==e?"&lt;":">"==e&&"&gt;")||"&"==e&&"&amp;"||'"'==e&&"&quot;"||"&#"+e.charCodeAt()+";"}function m(e,t){if(t(e))return!0;if(e=e.firstChild)do{if(m(e,t))return!0}while(e=e.nextSibling)}function g(){}function v(e,t,o){e&&e._inc++,"http://www.w3.org/2000/xmlns/"==o.namespaceURI&&(t._nsMap[o.prefix?o.localName:""]=o.value)}function _(e,t,o,n){e&&e._inc++,"http://www.w3.org/2000/xmlns/"==o.namespaceURI&&delete t._nsMap[o.prefix?o.localName:""]}function C(e,t,o){if(e&&e._inc){e._inc++;var n=t.childNodes;if(o)n[n.length++]=o;else{for(var r=t.firstChild,i=0;r;)n[i++]=r,r=r.nextSibling;n.length=i}}}function b(e,t){var o=t.previousSibling,n=t.nextSibling;return o?o.nextSibling=n:e.firstChild=n,n?n.previousSibling=o:e.lastChild=o,C(e.ownerDocument,e),t}function w(e,t,o){var n=t.parentNode;if(n&&n.removeChild(t),t.nodeType===oe){var r=t.firstChild;if(null==r)return t;var i=t.lastChild}else r=i=t;var a=o?o.previousSibling:e.lastChild;r.previousSibling=a,i.nextSibling=o,a?a.nextSibling=r:e.firstChild=r,null==o?e.lastChild=i:o.previousSibling=i;do{r.parentNode=e}while(r!==i&&(r=r.nextSibling));return C(e.ownerDocument||e,e),t.nodeType==oe&&(t.firstChild=t.lastChild=null),t}function S(e,t){var o=t.parentNode;if(o){var n=e.lastChild;o.removeChild(t);n=e.lastChild}n=e.lastChild;return t.parentNode=e,t.previousSibling=n,t.nextSibling=null,n?n.nextSibling=t:e.firstChild=t,e.lastChild=t,C(e.ownerDocument,e,t),t}function k(){this._nsMap={}}function E(){}function P(){}function M(){}function A(){}function O(){}function R(){}function x(){}function T(){}function N(){}function B(){}function I(){}function D(){}function V(e,t){var o=[],n=9==this.nodeType?this.documentElement:this,r=n.prefix,i=n.namespaceURI;if(i&&null==r&&null==(r=n.lookupPrefix(i)))var a=[{namespace:i,prefix:null}];return F(this,o,e,t,a),o.join("")}function j(e,t,o){var n=e.prefix||"",r=e.namespaceURI;if(!n&&!r)return!1;if("xml"===n&&"http://www.w3.org/XML/1998/namespace"===r||"http://www.w3.org/2000/xmlns/"==r)return!1;for(var i=o.length;i--;){var a=o[i];if(a.prefix==n)return a.namespace!=r}return!0}function F(e,t,o,n,r){if(n){if(!(e=n(e)))return;if("string"==typeof e)return void t.push(e)}switch(e.nodeType){case q:r||(r=[]);var i=(r.length,e.attributes),a=i.length,c=e.firstChild,s=e.tagName;o=G===e.namespaceURI||o,t.push("<",s);for(var l=0;l<a;l++){"xmlns"==(u=i.item(l)).prefix?r.push({prefix:u.localName,namespace:u.value}):"xmlns"==u.nodeName&&r.push({prefix:"",namespace:u.value})}for(l=0;l<a;l++){var u;if(j(u=i.item(l),0,r)){var p=u.prefix||"",d=u.namespaceURI,h=p?" xmlns:"+p:" xmlns";t.push(h,'="',d,'"'),r.push({prefix:p,namespace:d})}F(u,t,o,n,r)}if(j(e,0,r)){p=e.prefix||"",d=e.namespaceURI,h=p?" xmlns:"+p:" xmlns";t.push(h,'="',d,'"'),r.push({prefix:p,namespace:d})}if(c||o&&!/^(?:meta|link|img|br|hr|input)$/i.test(s)){if(t.push(">"),o&&/^script$/i.test(s))for(;c;)c.data?t.push(c.data):F(c,t,o,n,r),c=c.nextSibling;else for(;c;)F(c,t,o,n,r),c=c.nextSibling;t.push("</",s,">")}else t.push("/>");return;case ee:case oe:for(c=e.firstChild;c;)F(c,t,o,n,r),c=c.nextSibling;return;case X:return t.push(" ",e.name,'="',e.value.replace(/[<&"]/g,y),'"');case W:return t.push(e.data.replace(/[<&]/g,y));case J:return t.push("<![CDATA[",e.data,"]]>");case Z:return t.push("\x3c!--",e.data,"--\x3e");case te:var f=e.publicId,m=e.systemId;if(t.push("<!DOCTYPE ",e.name),f)t.push(' PUBLIC "',f),m&&"."!=m&&t.push('" "',m),t.push('">');else if(m&&"."!=m)t.push(' SYSTEM "',m,'">');else{var g=e.internalSubset;g&&t.push(" [",g,"]"),t.push(">")}return;case Q:return t.push("<?",e.target," ",e.data,"?>");case $:return t.push("&",e.nodeName,";");default:t.push("??",e.nodeName)}}function L(e,t,o){var n;switch(t.nodeType){case q:(n=t.cloneNode(!1)).ownerDocument=e;case oe:break;case X:o=!0}if(n||(n=t.cloneNode(!1)),n.ownerDocument=e,n.parentNode=null,o)for(var r=t.firstChild;r;)n.appendChild(L(e,r,o)),r=r.nextSibling;return n}function U(e,t,o){var r=new t.constructor;for(var i in t){var c=t[i];"object"!=(void 0===c?"undefined":n(c))&&c!=r[i]&&(r[i]=c)}switch(t.childNodes&&(r.childNodes=new a),r.ownerDocument=e,r.nodeType){case q:var s=t.attributes,u=r.attributes=new l,p=s.length;u._ownerElement=r;for(var d=0;d<p;d++)r.setAttributeNode(U(e,s.item(d),!0));break;case X:o=!0}if(o)for(var h=t.firstChild;h;)r.appendChild(U(e,h,o)),h=h.nextSibling;return r}function K(e,t,o){e[t]=o}function H(e){switch(e.nodeType){case q:case oe:var t=[];for(e=e.firstChild;e;)7!==e.nodeType&&8!==e.nodeType&&t.push(H(e)),e=e.nextSibling;return t.join("");default:return e.nodeValue}}var G="http://www.w3.org/1999/xhtml",z={},q=z.ELEMENT_NODE=1,X=z.ATTRIBUTE_NODE=2,W=z.TEXT_NODE=3,J=z.CDATA_SECTION_NODE=4,$=z.ENTITY_REFERENCE_NODE=5,Y=z.ENTITY_NODE=6,Q=z.PROCESSING_INSTRUCTION_NODE=7,Z=z.COMMENT_NODE=8,ee=z.DOCUMENT_NODE=9,te=z.DOCUMENT_TYPE_NODE=10,oe=z.DOCUMENT_FRAGMENT_NODE=11,ne=z.NOTATION_NODE=12,re={},ie={},ae=(re.INDEX_SIZE_ERR=(ie[1]="Index size error",1),re.DOMSTRING_SIZE_ERR=(ie[2]="DOMString size error",2),re.HIERARCHY_REQUEST_ERR=(ie[3]="Hierarchy request error",3)),ce=(re.WRONG_DOCUMENT_ERR=(ie[4]="Wrong document",4),re.INVALID_CHARACTER_ERR=(ie[5]="Invalid character",5),re.NO_DATA_ALLOWED_ERR=(ie[6]="No data allowed",6),re.NO_MODIFICATION_ALLOWED_ERR=(ie[7]="No modification allowed",7),re.NOT_FOUND_ERR=(ie[8]="Not found",8)),se=(re.NOT_SUPPORTED_ERR=(ie[9]="Not supported",9),re.INUSE_ATTRIBUTE_ERR=(ie[10]="Attribute in use",10));re.INVALID_STATE_ERR=(ie[11]="Invalid state",11),re.SYNTAX_ERR=(ie[12]="Syntax error",12),re.INVALID_MODIFICATION_ERR=(ie[13]="Invalid modification",13),re.NAMESPACE_ERR=(ie[14]="Invalid namespace",14),re.INVALID_ACCESS_ERR=(ie[15]="Invalid access",15),i.prototype=Error.prototype,o(re,i),a.prototype={length:0,item:function(e){return this[e]||null},toString:function(e,t){for(var o=[],n=0;n<this.length;n++)F(this[n],o,e,t);return o.join("")}},c.prototype.item=function(e){return s(this),this[e]},r(c,a),l.prototype={length:0,item:a.prototype.item,getNamedItem:function(e){for(var t=this.length;t--;){var o=this[t];if(o.nodeName==e)return o}},setNamedItem:function(e){var t=e.ownerElement;if(t&&t!=this._ownerElement)throw new i(se);var o=this.getNamedItem(e.nodeName);return p(this._ownerElement,this,e,o),o},setNamedItemNS:function(e){var t,o=e.ownerElement;if(o&&o!=this._ownerElement)throw new i(se);return t=this.getNamedItemNS(e.namespaceURI,e.localName),p(this._ownerElement,this,e,t),t},removeNamedItem:function(e){var t=this.getNamedItem(e);return d(this._ownerElement,this,t),t},removeNamedItemNS:function(e,t){var o=this.getNamedItemNS(e,t);return d(this._ownerElement,this,o),o},getNamedItemNS:function(e,t){for(var o=this.length;o--;){var n=this[o];if(n.localName==t&&n.namespaceURI==e)return n}return null}},h.prototype={hasFeature:function(e,t){var o=this._features[e.toLowerCase()];return!(!o||t&&!(t in o))},createDocument:function(e,t,o){var n=new g;if(n.implementation=this,n.childNodes=new a,n.doctype=o,o&&n.appendChild(o),t){var r=n.createElementNS(e,t);n.appendChild(r)}return n},createDocumentType:function(e,t,o){var n=new R;return n.name=e,n.nodeName=e,n.publicId=t,n.systemId=o,n}},f.prototype={firstChild:null,lastChild:null,previousSibling:null,nextSibling:null,attributes:null,parentNode:null,childNodes:null,ownerDocument:null,nodeValue:null,namespaceURI:null,prefix:null,localName:null,insertBefore:function(e,t){return w(this,e,t)},replaceChild:function(e,t){this.insertBefore(e,t),t&&this.removeChild(t)},removeChild:function(e){return b(this,e)},appendChild:function(e){return this.insertBefore(e,null)},hasChildNodes:function(){return null!=this.firstChild},cloneNode:function(e){return U(this.ownerDocument||this,this,e)},normalize:function(){for(var e=this.firstChild;e;){var t=e.nextSibling;t&&t.nodeType==W&&e.nodeType==W?(this.removeChild(t),e.appendData(t.data)):(e.normalize(),e=t)}},isSupported:function(e,t){return this.ownerDocument.implementation.hasFeature(e,t)},hasAttributes:function(){return this.attributes.length>0},lookupPrefix:function(e){for(var t=this;t;){var o=t._nsMap;if(o)for(var n in o)if(o[n]==e)return n;t=t.nodeType==X?t.ownerDocument:t.parentNode}return null},lookupNamespaceURI:function(e){for(var t=this;t;){var o=t._nsMap;if(o&&e in o)return o[e];t=t.nodeType==X?t.ownerDocument:t.parentNode}return null},isDefaultNamespace:function(e){return null==this.lookupPrefix(e)}},o(z,f),o(z,f.prototype),g.prototype={nodeName:"#document",nodeType:ee,doctype:null,documentElement:null,_inc:1,insertBefore:function(e,t){if(e.nodeType==oe){for(var o=e.firstChild;o;){var n=o.nextSibling;this.insertBefore(o,t),o=n}return e}return null==this.documentElement&&e.nodeType==q&&(this.documentElement=e),w(this,e,t),e.ownerDocument=this,e},removeChild:function(e){return this.documentElement==e&&(this.documentElement=null),b(this,e)},importNode:function(e,t){return L(this,e,t)},getElementById:function(e){var t=null;return m(this.documentElement,function(o){if(o.nodeType==q&&o.getAttribute("id")==e)return t=o,!0}),t},createElement:function(e){var t=new k;return t.ownerDocument=this,t.nodeName=e,t.tagName=e,t.childNodes=new a,(t.attributes=new l)._ownerElement=t,t},createDocumentFragment:function(){var e=new B;return e.ownerDocument=this,e.childNodes=new a,e},createTextNode:function(e){var t=new M;return t.ownerDocument=this,t.appendData(e),t},createComment:function(e){var t=new A;return t.ownerDocument=this,t.appendData(e),t},createCDATASection:function(e){var t=new O;return t.ownerDocument=this,t.appendData(e),t},createProcessingInstruction:function(e,t){var o=new I;return o.ownerDocument=this,o.tagName=o.target=e,o.nodeValue=o.data=t,o},createAttribute:function(e){var t=new E;return t.ownerDocument=this,t.name=e,t.nodeName=e,t.localName=e,t.specified=!0,t},createEntityReference:function(e){var t=new N;return t.ownerDocument=this,t.nodeName=e,t},createElementNS:function(e,t){var o=new k,n=t.split(":"),r=o.attributes=new l;return o.childNodes=new a,o.ownerDocument=this,o.nodeName=t,o.tagName=t,o.namespaceURI=e,2==n.length?(o.prefix=n[0],o.localName=n[1]):o.localName=t,r._ownerElement=o,o},createAttributeNS:function(e,t){var o=new E,n=t.split(":");return o.ownerDocument=this,o.nodeName=t,o.name=t,o.namespaceURI=e,o.specified=!0,2==n.length?(o.prefix=n[0],o.localName=n[1]):o.localName=t,o}},r(g,f),k.prototype={nodeType:q,hasAttribute:function(e){return null!=this.getAttributeNode(e)},getAttribute:function(e){var t=this.getAttributeNode(e);return t&&t.value||""},getAttributeNode:function(e){return this.attributes.getNamedItem(e)},setAttribute:function(e,t){var o=this.ownerDocument.createAttribute(e);o.value=o.nodeValue=""+t,this.setAttributeNode(o)},removeAttribute:function(e){var t=this.getAttributeNode(e);t&&this.removeAttributeNode(t)},appendChild:function(e){return e.nodeType===oe?this.insertBefore(e,null):S(this,e)},setAttributeNode:function(e){return this.attributes.setNamedItem(e)},setAttributeNodeNS:function(e){return this.attributes.setNamedItemNS(e)},removeAttributeNode:function(e){return this.attributes.removeNamedItem(e.nodeName)},removeAttributeNS:function(e,t){var o=this.getAttributeNodeNS(e,t);o&&this.removeAttributeNode(o)},hasAttributeNS:function(e,t){return null!=this.getAttributeNodeNS(e,t)},getAttributeNS:function(e,t){var o=this.getAttributeNodeNS(e,t);return o&&o.value||""},setAttributeNS:function(e,t,o){var n=this.ownerDocument.createAttributeNS(e,t);n.value=n.nodeValue=""+o,this.setAttributeNode(n)},getAttributeNodeNS:function(e,t){return this.attributes.getNamedItemNS(e,t)},getElementsByTagName:function(e){return new c(this,function(t){var o=[];return m(t,function(n){n===t||n.nodeType!=q||"*"!==e&&n.tagName!=e||o.push(n)}),o})},getElementsByTagNameNS:function(e,t){return new c(this,function(o){var n=[];return m(o,function(r){r===o||r.nodeType!==q||"*"!==e&&r.namespaceURI!==e||"*"!==t&&r.localName!=t||n.push(r)}),n})}},g.prototype.getElementsByTagName=k.prototype.getElementsByTagName,g.prototype.getElementsByTagNameNS=k.prototype.getElementsByTagNameNS,r(k,f),E.prototype.nodeType=X,r(E,f),P.prototype={data:"",substringData:function(e,t){return this.data.substring(e,e+t)},appendData:function(e){e=this.data+e,this.nodeValue=this.data=e,this.length=e.length},insertData:function(e,t){this.replaceData(e,0,t)},appendChild:function(e){throw new Error(ie[ae])},deleteData:function(e,t){this.replaceData(e,t,"")},replaceData:function(e,t,o){o=this.data.substring(0,e)+o+this.data.substring(e+t),this.nodeValue=this.data=o,this.length=o.length}},r(P,f),M.prototype={nodeName:"#text",nodeType:W,splitText:function(e){var t=this.data,o=t.substring(e);t=t.substring(0,e),this.data=this.nodeValue=t,this.length=t.length;var n=this.ownerDocument.createTextNode(o);return this.parentNode&&this.parentNode.insertBefore(n,this.nextSibling),n}},r(M,P),A.prototype={nodeName:"#comment",nodeType:Z},r(A,P),O.prototype={nodeName:"#cdata-section",nodeType:J},r(O,P),R.prototype.nodeType=te,r(R,f),x.prototype.nodeType=ne,r(x,f),T.prototype.nodeType=Y,r(T,f),N.prototype.nodeType=$,r(N,f),B.prototype.nodeName="#document-fragment",B.prototype.nodeType=oe,r(B,f),I.prototype.nodeType=Q,r(I,f),D.prototype.serializeToString=function(e,t,o){return V.call(e,t,o)},f.prototype.toString=V;try{Object.defineProperty&&(Object.defineProperty(c.prototype,"length",{get:function(){return s(this),this.$$length}}),Object.defineProperty(f.prototype,"textContent",{get:function(){return H(this)},set:function(e){switch(this.nodeType){case q:case oe:for(;this.firstChild;)this.removeChild(this.firstChild);(e||String(e))&&this.appendChild(this.ownerDocument.createTextNode(e));break;default:this.data=e,this.value=e,this.nodeValue=e}}}),K=function(e,t,o){e["$$"+t]=o})}catch(e){}t.DOMImplementation=h,t.XMLSerializer=D},function(e,t){var o=function(e){var t={},o=function(e){return!t[e]&&(t[e]=[]),t[e]};e.on=function(e,t){o(e).push(t)},e.off=function(e,t){for(var n=o(e),r=n.length-1;r>=0;r--)t===n[r]&&n.splice(r,1)},e.emit=function(e,t){for(var n=o(e).map(function(e){return e}),r=0;r<n.length;r++)n[r](t)}};e.exports.init=o,e.exports.EventProxy=function(){o(this)}},function(e,t,o){var n=o(0),r=o(2),i=o(16),a=o(15),c=o(13),s={SecretId:"",SecretKey:"",XCosSecurityToken:"",FileParallelLimit:3,ChunkParallelLimit:3,ChunkSize:1048576,SliceSize:1048576,CopyChunkParallelLimit:20,CopyChunkSize:10485760,CopySliceSize:10485760,MaxPartNumber:1e4,ProgressInterval:1e3,UploadQueueSize:1e4,Domain:"",ServiceDomain:"",Protocol:"",CompatibilityMode:!1,ForcePathStyle:!1,CorrectClockSkew:!0,SystemClockOffset:0},l=function(e){this.options=n.extend(n.clone(s),e||{}),this.options.FileParallelLimit=Math.max(1,this.options.FileParallelLimit),this.options.ChunkParallelLimit=Math.max(1,this.options.ChunkParallelLimit),this.options.ChunkRetryTimes=Math.max(0,this.options.ChunkRetryTimes),this.options.ChunkSize=Math.max(1048576,this.options.ChunkSize),this.options.CopyChunkParallelLimit=Math.max(1,this.options.CopyChunkParallelLimit),this.options.CopyChunkSize=Math.max(1048576,this.options.CopyChunkSize),this.options.CopySliceSize=Math.max(0,this.options.CopySliceSize),this.options.MaxPartNumber=Math.max(1024,Math.min(1e4,this.options.MaxPartNumber)),this.options.Timeout=Math.max(0,this.options.Timeout),this.options.AppId&&console.warn('warning: AppId has been deprecated, Please put it at the end of parameter Bucket(E.g: "test-1250000000").'),r.init(this),i.init(this)};a.init(l,i),c.init(l,i),l.getAuthorization=n.getAuth,l.version="0.7.3",e.exports=l},function(e,t,o){var n=o(3);e.exports=n},function(e,t){var o=function(e){var t=(e=e||{}).Base64,o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",n=function(e){for(var t={},o=0,n=e.length;o<n;o++)t[e.charAt(o)]=o;return t}(o),r=String.fromCharCode,i=function(e){if(e.length<2)return(t=e.charCodeAt(0))<128?e:t<2048?r(192|t>>>6)+r(128|63&t):r(224|t>>>12&15)+r(128|t>>>6&63)+r(128|63&t);var t=65536+1024*(e.charCodeAt(0)-55296)+(e.charCodeAt(1)-56320);return r(240|t>>>18&7)+r(128|t>>>12&63)+r(128|t>>>6&63)+r(128|63&t)},a=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,c=function(e){return e.replace(a,i)},s=function(e){var t=[0,2,1][e.length%3],n=e.charCodeAt(0)<<16|(e.length>1?e.charCodeAt(1):0)<<8|(e.length>2?e.charCodeAt(2):0);return[o.charAt(n>>>18),o.charAt(n>>>12&63),t>=2?"=":o.charAt(n>>>6&63),t>=1?"=":o.charAt(63&n)].join("")},l=e.btoa?function(t){return e.btoa(t)}:function(e){return e.replace(/[\s\S]{1,3}/g,s)},u=function(e){return l(c(e))},p=function(e,t){return t?u(String(e)).replace(/[+\/]/g,function(e){return"+"==e?"-":"_"}).replace(/=/g,""):u(String(e))},d=new RegExp(["[\xc0-\xdf][\x80-\xbf]","[\xe0-\xef][\x80-\xbf]{2}","[\xf0-\xf7][\x80-\xbf]{3}"].join("|"),"g"),h=function(e){switch(e.length){case 4:var t=((7&e.charCodeAt(0))<<18|(63&e.charCodeAt(1))<<12|(63&e.charCodeAt(2))<<6|63&e.charCodeAt(3))-65536;return r(55296+(t>>>10))+r(56320+(1023&t));case 3:return r((15&e.charCodeAt(0))<<12|(63&e.charCodeAt(1))<<6|63&e.charCodeAt(2));default:return r((31&e.charCodeAt(0))<<6|63&e.charCodeAt(1))}},f=function(e){return e.replace(d,h)},y=function(e){var t=e.length,o=t%4,i=(t>0?n[e.charAt(0)]<<18:0)|(t>1?n[e.charAt(1)]<<12:0)|(t>2?n[e.charAt(2)]<<6:0)|(t>3?n[e.charAt(3)]:0),a=[r(i>>>16),r(i>>>8&255),r(255&i)];return a.length-=[0,0,2,1][o],a.join("")},m=e.atob?function(t){return e.atob(t)}:function(e){return e.replace(/[\s\S]{1,4}/g,y)},g=function(e){return f(m(e))},v=function(e){return g(String(e).replace(/[-_]/g,function(e){return"-"==e?"+":"/"}).replace(/[^A-Za-z0-9\+\/]/g,""))};return{VERSION:"2.1.9",atob:m,btoa:l,fromBase64:v,toBase64:p,utob:c,encode:p,encodeURI:function(e){return p(e,!0)},btou:f,decode:v,noConflict:function(){var o=e.Base64;return e.Base64=t,o}}}();e.exports=o},function(e,t){var o=o||function(e,t){var o={},n=o.lib={},r=function(){},i=n.Base={extend:function(e){r.prototype=this;var t=new r;return e&&t.mixIn(e),t.hasOwnProperty("init")||(t.init=function(){t.$super.init.apply(this,arguments)}),t.init.prototype=t,t.$super=this,t},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}},a=n.WordArray=i.extend({init:function(e,t){e=this.words=e||[],this.sigBytes=void 0!=t?t:4*e.length},toString:function(e){return(e||s).stringify(this)},concat:function(e){var t=this.words,o=e.words,n=this.sigBytes;if(e=e.sigBytes,this.clamp(),n%4)for(var r=0;r<e;r++)t[n+r>>>2]|=(o[r>>>2]>>>24-r%4*8&255)<<24-(n+r)%4*8;else if(65535<o.length)for(r=0;r<e;r+=4)t[n+r>>>2]=o[r>>>2];else t.push.apply(t,o);return this.sigBytes+=e,this},clamp:function(){var t=this.words,o=this.sigBytes;t[o>>>2]&=4294967295<<32-o%4*8,t.length=e.ceil(o/4)},clone:function(){var e=i.clone.call(this);return e.words=this.words.slice(0),e},random:function(t){for(var o=[],n=0;n<t;n+=4)o.push(4294967296*e.random()|0);return new a.init(o,t)}}),c=o.enc={},s=c.Hex={stringify:function(e){var t=e.words;e=e.sigBytes;for(var o=[],n=0;n<e;n++){var r=t[n>>>2]>>>24-n%4*8&255;o.push((r>>>4).toString(16)),o.push((15&r).toString(16))}return o.join("")},parse:function(e){for(var t=e.length,o=[],n=0;n<t;n+=2)o[n>>>3]|=parseInt(e.substr(n,2),16)<<24-n%8*4;return new a.init(o,t/2)}},l=c.Latin1={stringify:function(e){var t=e.words;e=e.sigBytes;for(var o=[],n=0;n<e;n++)o.push(String.fromCharCode(t[n>>>2]>>>24-n%4*8&255));return o.join("")},parse:function(e){for(var t=e.length,o=[],n=0;n<t;n++)o[n>>>2]|=(255&e.charCodeAt(n))<<24-n%4*8;return new a.init(o,t)}},u=c.Utf8={stringify:function(e){try{return decodeURIComponent(escape(l.stringify(e)))}catch(e){throw Error("Malformed UTF-8 data")}},parse:function(e){return l.parse(unescape(encodeURIComponent(e)))}},p=n.BufferedBlockAlgorithm=i.extend({reset:function(){this._data=new a.init,this._nDataBytes=0},_append:function(e){"string"==typeof e&&(e=u.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(t){var o=this._data,n=o.words,r=o.sigBytes,i=this.blockSize,c=r/(4*i);if(t=(c=t?e.ceil(c):e.max((0|c)-this._minBufferSize,0))*i,r=e.min(4*t,r),t){for(var s=0;s<t;s+=i)this._doProcessBlock(n,s);s=n.splice(0,t),o.sigBytes-=r}return new a.init(s,r)},clone:function(){var e=i.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0});n.Hasher=p.extend({cfg:i.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){p.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){return e&&this._append(e),this._doFinalize()},blockSize:16,_createHelper:function(e){return function(t,o){return new e.init(o).finalize(t)}},_createHmacHelper:function(e){return function(t,o){return new d.HMAC.init(e,o).finalize(t)}}});var d=o.algo={};return o}(Math);!function(){var e=o,t=(i=e.lib).WordArray,n=i.Hasher,r=[],i=e.algo.SHA1=n.extend({_doReset:function(){this._hash=new t.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(e,t){for(var o=this._hash.words,n=o[0],i=o[1],a=o[2],c=o[3],s=o[4],l=0;80>l;l++){if(16>l)r[l]=0|e[t+l];else{var u=r[l-3]^r[l-8]^r[l-14]^r[l-16];r[l]=u<<1|u>>>31}u=(n<<5|n>>>27)+s+r[l],u=20>l?u+(1518500249+(i&a|~i&c)):40>l?u+(1859775393+(i^a^c)):60>l?u+((i&a|i&c|a&c)-1894007588):u+((i^a^c)-899497514),s=c,c=a,a=i<<30|i>>>2,i=n,n=u}o[0]=o[0]+n|0,o[1]=o[1]+i|0,o[2]=o[2]+a|0,o[3]=o[3]+c|0,o[4]=o[4]+s|0},_doFinalize:function(){var e=this._data,t=e.words,o=8*this._nDataBytes,n=8*e.sigBytes;return t[n>>>5]|=128<<24-n%32,t[14+(n+64>>>9<<4)]=Math.floor(o/4294967296),t[15+(n+64>>>9<<4)]=o,e.sigBytes=4*t.length,this._process(),this._hash},clone:function(){var e=n.clone.call(this);return e._hash=this._hash.clone(),e}});e.SHA1=n._createHelper(i),e.HmacSHA1=n._createHmacHelper(i)}(),function(){var e=o,t=e.enc.Utf8;e.algo.HMAC=e.lib.Base.extend({init:function(e,o){e=this._hasher=new e.init,"string"==typeof o&&(o=t.parse(o));var n=e.blockSize,r=4*n;o.sigBytes>r&&(o=e.finalize(o)),o.clamp();for(var i=this._oKey=o.clone(),a=this._iKey=o.clone(),c=i.words,s=a.words,l=0;l<n;l++)c[l]^=1549556828,s[l]^=909522486;i.sigBytes=a.sigBytes=r,this.reset()},reset:function(){var e=this._hasher;e.reset(),e.update(this._iKey)},update:function(e){return this._hasher.update(e),this},finalize:function(e){var t=this._hasher;return e=t.finalize(e),t.reset(),t.finalize(this._oKey.clone().concat(e))}})}(),function(){var e=o,t=e.lib.WordArray;e.enc.Base64={stringify:function(e){var t=e.words,o=e.sigBytes,n=this._map;e.clamp();for(var r=[],i=0;i<o;i+=3)for(var a=(t[i>>>2]>>>24-i%4*8&255)<<16|(t[i+1>>>2]>>>24-(i+1)%4*8&255)<<8|t[i+2>>>2]>>>24-(i+2)%4*8&255,c=0;c<4&&i+.75*c<o;c++)r.push(n.charAt(a>>>6*(3-c)&63));var s=n.charAt(64);if(s)for(;r.length%4;)r.push(s);return r.join("")},parse:function(e){var o=e.length,n=this._map,r=n.charAt(64);if(r){var i=e.indexOf(r);-1!=i&&(o=i)}for(var a=[],c=0,s=0;s<o;s++)if(s%4){var l=n.indexOf(e.charAt(s-1))<<s%4*2,u=n.indexOf(e.charAt(s))>>>6-s%4*2;a[c>>>2]|=(l|u)<<24-c%4*8,c++}return t.create(a,c)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}}(),e.exports=o},function(e,t){function o(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&apos;").replace(/"/g,"&quot;").replace(i,"")}var r=new RegExp("^([^a-zA-Z_\xc0-\xd6\xd8-\xf6\xf8-\xff\u0370-\u037d\u037f-\u1fff\u200c-\u200d\u2070-\u218f\u2c00-\u2fff\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd])|^((x|X)(m|M)(l|L))|([^a-zA-Z_\xc0-\xd6\xd8-\xf6\xf8-\xff\u0370-\u037d\u037f-\u1fff\u200c-\u200d\u2070-\u218f\u2c00-\u2fff\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd-.0-9\xb7\u0300-\u036f\u203f\u2040])","g"),i=/[^\x09\x0A\x0D\x20-\xFF\x85\xA0-\uD7FF\uE000-\uFDCF\uFDE0-\uFFFD]/gm,a=function(e){var t=[];if(e instanceof Object)for(var o in e)e.hasOwnProperty(o)&&t.push(o);return t},c=function(e,t){var i=function(e,o,n,i,a){var c=void 0!==t.indent?t.indent:"\t",s=t.prettyPrint?"\n"+new Array(i).join(c):"";t.removeIllegalNameCharacters&&(e=e.replace(r,"_"));var l=[s,"<",e,n||""];return o&&o.length>0?(l.push(">"),l.push(o),a&&l.push(s),l.push("</"),l.push(e),l.push(">")):l.push("/>"),l.join("")};return function e(r,c,s){var l=void 0===r?"undefined":n(r);switch((Array.isArray?Array.isArray(r):r instanceof Array)?l="array":r instanceof Date&&(l="date"),l){case"array":var u=[];return r.map(function(t){u.push(e(t,1,s+1))}),t.prettyPrint&&u.push("\n"),u.join("");case"date":return r.toJSON?r.toJSON():r+"";case"object":var p=[];for(var d in r)if(r[d]instanceof Array)for(var h in r[d])p.push(i(d,e(r[d][h],0,s+1),null,s+1,a(r[d][h]).length));else p.push(i(d,e(r[d],0,s+1),null,s+1));return t.prettyPrint&&p.length>0&&p.push("\n"),p.join("");case"function":return r();default:return t.escape?o(r):""+r}}(e,0,0)},s=function(e){var t=['<?xml version="1.0" encoding="UTF-8"'];return e&&t.push(' standalone="yes"'),t.push("?>"),t.join("")};e.exports=function(e,t){if(t||(t={xmlHeader:{standalone:!0},prettyPrint:!0,indent:"  "}),"string"==typeof e)try{e=JSON.parse(e.toString())}catch(e){return!1}var o="",r="";return t&&("object"==(void 0===t?"undefined":n(t))?(t.xmlHeader&&(o=s(!!t.xmlHeader.standalone)),void 0!==t.docType&&(r="<!DOCTYPE "+t.docType+">")):o=s()),[o,(t=t||{}).prettyPrint&&r?"\n":"",r,c(e,t)].join("").replace(/\n{2,}/g,"\n").replace(/\s+$/g,"")}},function(e,t){e.exports=function(e){function t(e,t){return e<<t|e>>>32-t}function o(e,t){var o,n,r,i,a;return r=2147483648&e,i=2147483648&t,a=(1073741823&e)+(1073741823&t),(o=1073741824&e)&(n=1073741824&t)?2147483648^a^r^i:o|n?1073741824&a?3221225472^a^r^i:1073741824^a^r^i:a^r^i}function n(e,t,o){return e&t|~e&o}function r(e,t,o){return e&o|t&~o}function i(e,t,o){return e^t^o}function a(e,t,o){return t^(e|~o)}function c(e,r,i,a,c,s,l){return e=o(e,o(o(n(r,i,a),c),l)),o(t(e,s),r)}function s(e,n,i,a,c,s,l){return e=o(e,o(o(r(n,i,a),c),l)),o(t(e,s),n)}function l(e,n,r,a,c,s,l){return e=o(e,o(o(i(n,r,a),c),l)),o(t(e,s),n)}function u(e,n,r,i,c,s,l){return e=o(e,o(o(a(n,r,i),c),l)),o(t(e,s),n)}function p(e){var t,o="",n="";for(t=0;t<=3;t++)o+=(n="0"+(e>>>8*t&255).toString(16)).substr(n.length-2,2);return o}var d,h,f,y,m,g,v,_,C,b=Array();for(b=function(e){for(var t,o=e.length,n=o+8,r=16*((n-n%64)/64+1),i=Array(r-1),a=0,c=0;c<o;)a=c%4*8,i[t=(c-c%4)/4]=i[t]|e.charCodeAt(c)<<a,c++;return a=c%4*8,i[t=(c-c%4)/4]=i[t]|128<<a,i[r-2]=o<<3,i[r-1]=o>>>29,i}(e=function(e){e=e.replace(/\r\n/g,"\n");for(var t="",o=0;o<e.length;o++){var n=e.charCodeAt(o);n<128?t+=String.fromCharCode(n):n>127&&n<2048?(t+=String.fromCharCode(n>>6|192),t+=String.fromCharCode(63&n|128)):(t+=String.fromCharCode(n>>12|224),t+=String.fromCharCode(n>>6&63|128),t+=String.fromCharCode(63&n|128))}return t}(e)),g=1732584193,v=4023233417,_=2562383102,C=271733878,d=0;d<b.length;d+=16)h=g,f=v,y=_,m=C,v=u(v=u(v=u(v=u(v=l(v=l(v=l(v=l(v=s(v=s(v=s(v=s(v=c(v=c(v=c(v=c(v,_=c(_,C=c(C,g=c(g,v,_,C,b[d+0],7,3614090360),v,_,b[d+1],12,3905402710),g,v,b[d+2],17,606105819),C,g,b[d+3],22,3250441966),_=c(_,C=c(C,g=c(g,v,_,C,b[d+4],7,4118548399),v,_,b[d+5],12,1200080426),g,v,b[d+6],17,2821735955),C,g,b[d+7],22,4249261313),_=c(_,C=c(C,g=c(g,v,_,C,b[d+8],7,1770035416),v,_,b[d+9],12,2336552879),g,v,b[d+10],17,4294925233),C,g,b[d+11],22,2304563134),_=c(_,C=c(C,g=c(g,v,_,C,b[d+12],7,1804603682),v,_,b[d+13],12,4254626195),g,v,b[d+14],17,2792965006),C,g,b[d+15],22,1236535329),_=s(_,C=s(C,g=s(g,v,_,C,b[d+1],5,4129170786),v,_,b[d+6],9,3225465664),g,v,b[d+11],14,643717713),C,g,b[d+0],20,3921069994),_=s(_,C=s(C,g=s(g,v,_,C,b[d+5],5,3593408605),v,_,b[d+10],9,38016083),g,v,b[d+15],14,3634488961),C,g,b[d+4],20,3889429448),_=s(_,C=s(C,g=s(g,v,_,C,b[d+9],5,568446438),v,_,b[d+14],9,3275163606),g,v,b[d+3],14,4107603335),C,g,b[d+8],20,1163531501),_=s(_,C=s(C,g=s(g,v,_,C,b[d+13],5,2850285829),v,_,b[d+2],9,4243563512),g,v,b[d+7],14,1735328473),C,g,b[d+12],20,2368359562),_=l(_,C=l(C,g=l(g,v,_,C,b[d+5],4,4294588738),v,_,b[d+8],11,2272392833),g,v,b[d+11],16,1839030562),C,g,b[d+14],23,4259657740),_=l(_,C=l(C,g=l(g,v,_,C,b[d+1],4,2763975236),v,_,b[d+4],11,1272893353),g,v,b[d+7],16,4139469664),C,g,b[d+10],23,3200236656),_=l(_,C=l(C,g=l(g,v,_,C,b[d+13],4,681279174),v,_,b[d+0],11,3936430074),g,v,b[d+3],16,3572445317),C,g,b[d+6],23,76029189),_=l(_,C=l(C,g=l(g,v,_,C,b[d+9],4,3654602809),v,_,b[d+12],11,3873151461),g,v,b[d+15],16,530742520),C,g,b[d+2],23,3299628645),_=u(_,C=u(C,g=u(g,v,_,C,b[d+0],6,4096336452),v,_,b[d+7],10,1126891415),g,v,b[d+14],15,2878612391),C,g,b[d+5],21,4237533241),_=u(_,C=u(C,g=u(g,v,_,C,b[d+12],6,1700485571),v,_,b[d+3],10,2399980690),g,v,b[d+10],15,4293915773),C,g,b[d+1],21,2240044497),_=u(_,C=u(C,g=u(g,v,_,C,b[d+8],6,1873313359),v,_,b[d+15],10,4264355552),g,v,b[d+6],15,2734768916),C,g,b[d+13],21,1309151649),_=u(_,C=u(C,g=u(g,v,_,C,b[d+4],6,4149444226),v,_,b[d+11],10,3174756917),g,v,b[d+2],15,718787259),C,g,b[d+9],21,3951481745),g=o(g,h),v=o(v,f),_=o(_,y),C=o(C,m);return(p(g)+p(v)+p(_)+p(C)).toLowerCase()}},function(e,t){var o=function(e){var t,o,n,r=[],i=Object.keys(e);for(t=0;t<i.length;t++)o=i[t],n=e[o]||"",r.push(o+"="+encodeURIComponent(n));return r.join("&")};e.exports=function(e,t){var n,r=e.filePath,i=e.headers||{},a=e.url,c=e.method,s=e.onProgress,l=function(e,o){t(e,{statusCode:o.statusCode,headers:o.header},o.data)};if(r){var u,p=a.match(/^(https?:\/\/[^\/]+\/)([^\/]*\/?)(.*)$/);e.pathStyle?(u=decodeURIComponent(p[3]||""),a=p[1]+p[2]):(u=decodeURIComponent(p[2]+p[3]||""),a=p[1]);var d={key:u,success_action_status:200,Signature:i.Authorization},h=["Cache-Control","Content-Type","Content-Disposition","Content-Encoding","Expires","x-cos-storage-class","x-cos-security-token"];for(var f in e.headers)e.headers.hasOwnProperty(f)&&(f.indexOf("x-cos-meta-")>-1||h.indexOf(f)>-1)&&(d[f]=e.headers[f]);i["x-cos-acl"]&&(d.acl=i["x-cos-acl"]),!d["Content-Type"]&&(d["Content-Type"]=""),n=wx.uploadFile({url:a,method:c,name:"file",filePath:r,formData:d,success:function(e){l(null,e)},fail:function(e){l(e.errMsg,e)}}),n.onProgressUpdate(function(e){s({loaded:e.totalBytesSent,total:e.totalBytesExpectedToSend,progress:e.progress/100})})}else{var y=e.qs&&o(e.qs)||"";y&&(a+=(a.indexOf("?")>-1?"&":"?")+y),i["Content-Length"]&&delete i["Content-Length"],wx.request({url:a,method:c,header:i,dataType:"text",data:e.body,success:function(e){l(null,e)},fail:function(e){l(e.errMsg,e)}})}return n}},function(e,t,o){var n=o(11).DOMParser,r=function(e){function t(e){var t=e.localName;return null==t&&(t=e.baseName),null!=t&&""!=t||(t=e.nodeName),t}function o(e){return e.prefix}function r(e){return"string"==typeof e?e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;"):e}function i(e,t,o,n){for(var r=0;r<e.length;r++){var i=e[r];if("string"==typeof i){if(i==n)break}else if(i instanceof RegExp){if(i.test(n))break}else if("function"==typeof i&&i(t,o,n))break}return r!=e.length}function a(t,o,n){switch(e.arrayAccessForm){case"property":t[o]instanceof Array?t[o+"_asArray"]=t[o]:t[o+"_asArray"]=[t[o]]}!(t[o]instanceof Array)&&e.arrayAccessFormPaths.length>0&&i(e.arrayAccessFormPaths,t,o,n)&&(t[o]=[t[o]])}function c(e){var t=e.split(/[-T:+Z]/g),o=new Date(t[0],t[1]-1,t[2]),n=t[5].split(".");if(o.setHours(t[3],t[4],n[0]),n.length>1&&o.setMilliseconds(n[1]),t[6]&&t[7]){var r=60*t[6]+Number(t[7]);r=0+("-"==(/\d\d-\d\d:\d\d$/.test(e)?"-":"+")?-1*r:r),o.setMinutes(o.getMinutes()-r-o.getTimezoneOffset())}else-1!==e.indexOf("Z",e.length-1)&&(o=new Date(Date.UTC(o.getFullYear(),o.getMonth(),o.getDate(),o.getHours(),o.getMinutes(),o.getSeconds(),o.getMilliseconds())));return o}function s(t,o,n){if(e.datetimeAccessFormPaths.length>0){var r=n.split(".#")[0];return i(e.datetimeAccessFormPaths,t,o,r)?c(t):t}return t}function l(t,o,n,r){return!(o==S.ELEMENT_NODE&&e.xmlElementsFilter.length>0)||i(e.xmlElementsFilter,t,n,r)}function u(n,r){if(n.nodeType==S.DOCUMENT_NODE){for(var i=new Object,c=n.childNodes,p=0;p<c.length;p++){if((d=c.item(p)).nodeType==S.ELEMENT_NODE)i[h=t(d)]=u(d,h)}return i}if(n.nodeType==S.ELEMENT_NODE){(i=new Object).__cnt=0;for(c=n.childNodes,p=0;p<c.length;p++){var d,h=t(d=c.item(p));if(d.nodeType!=S.COMMENT_NODE){var f=r+"."+h;l(i,d.nodeType,h,f)&&(i.__cnt++,null==i[h]?(i[h]=u(d,f),a(i,h,f)):(null!=i[h]&&(i[h]instanceof Array||(i[h]=[i[h]],a(i,h,f))),i[h][i[h].length]=u(d,f)))}}for(var y=0;y<n.attributes.length;y++){var m=n.attributes.item(y);i.__cnt++,i[e.attributePrefix+m.name]=m.value}var g=o(n);return null!=g&&""!=g&&(i.__cnt++,i.__prefix=g),null!=i["#text"]&&(i.__text=i["#text"],i.__text instanceof Array&&(i.__text=i.__text.join("\n")),e.stripWhitespaces&&(i.__text=i.__text.trim()),delete i["#text"],"property"==e.arrayAccessForm&&delete i["#text_asArray"],i.__text=s(i.__text,h,r+"."+h)),null!=i["#cdata-section"]&&(i.__cdata=i["#cdata-section"],delete i["#cdata-section"],"property"==e.arrayAccessForm&&delete i["#cdata-section_asArray"]),0==i.__cnt&&"text"==e.emptyNodeForm?i="":1==i.__cnt&&null!=i.__text?i=i.__text:1!=i.__cnt||null==i.__cdata||e.keepCData?i.__cnt>1&&null!=i.__text&&e.skipEmptyTextNodesForObj&&(e.stripWhitespaces&&""==i.__text||""==i.__text.trim())&&delete i.__text:i=i.__cdata,delete i.__cnt,!e.enableToStringFunc||null==i.__text&&null==i.__cdata||(i.toString=function(){return(null!=this.__text?this.__text:"")+(null!=this.__cdata?this.__cdata:"")}),i}if(n.nodeType==S.TEXT_NODE||n.nodeType==S.CDATA_SECTION_NODE)return n.nodeValue}function p(t,o,n,i){var a="<"+(null!=t&&null!=t.__prefix?t.__prefix+":":"")+o;if(null!=n)for(var c=0;c<n.length;c++){var s=n[c],l=t[s];e.escapeMode&&(l=r(l)),a+=" "+s.substr(e.attributePrefix.length)+"=",e.useDoubleQuotes?a+='"'+l+'"':a+="'"+l+"'"}return a+(i?"/>":">")}function d(e,t){return"</"+(null!=e.__prefix?e.__prefix+":":"")+t+">"}function h(e,t){return-1!==e.indexOf(t,e.length-t.length)}function f(t,o){return!!("property"==e.arrayAccessForm&&h(o.toString(),"_asArray")||0==o.toString().indexOf(e.attributePrefix)||0==o.toString().indexOf("__")||t[o]instanceof Function)}function y(e){var t=0;if(e instanceof Object)for(var o in e)f(e,o)||t++;return t}function m(t,o,n){return 0==e.jsonPropertiesFilter.length||""==n||i(e.jsonPropertiesFilter,t,o,n)}function g(t){var o=[];if(t instanceof Object)for(var n in t)-1==n.toString().indexOf("__")&&0==n.toString().indexOf(e.attributePrefix)&&o.push(n);return o}function v(t){var o="";return null!=t.__cdata&&(o+="<![CDATA["+t.__cdata+"]]>"),null!=t.__text&&(e.escapeMode?o+=r(t.__text):o+=t.__text),o}function _(t){var o="";return t instanceof Object?o+=v(t):null!=t&&(e.escapeMode?o+=r(t):o+=t),o}function C(e,t){return""===e?t:e+"."+t}function b(e,t,o,n){var r="";if(0==e.length)r+=p(e,t,o,!0);else for(var i=0;i<e.length;i++)r+=p(e[i],t,g(e[i]),!1),r+=w(e[i],C(n,t)),r+=d(e[i],t);return r}function w(e,t){var o="";if(y(e)>0)for(var n in e)if(!f(e,n)&&(""==t||m(e,n,C(t,n)))){var r=e[n],i=g(r);if(null==r||void 0==r)o+=p(r,n,i,!0);else if(r instanceof Object)if(r instanceof Array)o+=b(r,n,i,t);else if(r instanceof Date)o+=p(r,n,i,!1),o+=r.toISOString(),o+=d(r,n);else{y(r)>0||null!=r.__text||null!=r.__cdata?(o+=p(r,n,i,!1),o+=w(r,C(t,n)),o+=d(r,n)):o+=p(r,n,i,!0)}else o+=p(r,n,i,!1),o+=_(r),o+=d(r,n)}return o+_(e)}void 0===(e=e||{}).escapeMode&&(e.escapeMode=!0),e.attributePrefix=e.attributePrefix||"_",e.arrayAccessForm=e.arrayAccessForm||"none",e.emptyNodeForm=e.emptyNodeForm||"text",void 0===e.enableToStringFunc&&(e.enableToStringFunc=!0),e.arrayAccessFormPaths=e.arrayAccessFormPaths||[],void 0===e.skipEmptyTextNodesForObj&&(e.skipEmptyTextNodesForObj=!0),void 0===e.stripWhitespaces&&(e.stripWhitespaces=!0),e.datetimeAccessFormPaths=e.datetimeAccessFormPaths||[],void 0===e.useDoubleQuotes&&(e.useDoubleQuotes=!1),e.xmlElementsFilter=e.xmlElementsFilter||[],e.jsonPropertiesFilter=e.jsonPropertiesFilter||[],void 0===e.keepCData&&(e.keepCData=!1);var S={ELEMENT_NODE:1,TEXT_NODE:3,CDATA_SECTION_NODE:4,COMMENT_NODE:8,DOCUMENT_NODE:9};this.parseXmlString=function(e){if(void 0===e)return null;var t;if(n){var o=new n,r=null;try{r=o.parseFromString("INVALID","text/xml").getElementsByTagName("parsererror")[0].namespaceURI}catch(e){r=null}try{t=o.parseFromString(e,"text/xml"),null!=r&&t.getElementsByTagNameNS(r,"parsererror").length>0&&(t=null)}catch(e){t=null}}else 0==e.indexOf("<?")&&(e=e.substr(e.indexOf("?>")+2)),(t=new ActiveXObject("Microsoft.XMLDOM")).async="false",t.loadXML(e);return t},this.asArray=function(e){return void 0===e||null==e?[]:e instanceof Array?e:[e]},this.toXmlDateTime=function(e){return e instanceof Date?e.toISOString():"number"==typeof e?new Date(e).toISOString():null},this.asDateTime=function(e){return"string"==typeof e?c(e):e},this.xml2json=function(e){return u(e)},this.xml_str2json=function(e){var t=this.parseXmlString(e);return null!=t?this.xml2json(t):null},this.json2xml_str=function(e){return w(e,"")},this.json2xml=function(e){var t=this.json2xml_str(e);return this.parseXmlString(t)},this.getVersion=function(){return"1.2.0"}};e.exports=function(e){if(!e)return null;var t=(new n).parseFromString(e,"text/xml"),o=new r,i=o.xml2json(t);return i.html&&i.getElementsByTagName("parsererror").length?null:i}},function(e,t,o){function n(e){this.options=e||{locator:{}}}function r(e,t,o){function n(t){var n=e[t];!n&&a&&(n=2==e.length?function(o){e(t,o)}:e),r[t]=n&&function(e){n("[xmldom "+t+"]\t"+e+c(o))}||function(){}}if(!e){if(t instanceof i)return t;e=t}var r={},a=e instanceof Function;return o=o||{},n("warning"),n("error"),n("fatalError"),r}function i(){this.cdata=!1}function a(e,t){t.lineNumber=e.lineNumber,t.columnNumber=e.columnNumber}function c(e){if(e)return"\n@"+(e.systemId||"")+"#[line:"+e.lineNumber+",col:"+e.columnNumber+"]"}function s(e,t,o){return"string"==typeof e?e.substr(t,o):e.length>=t+o||t?new java.lang.String(e,t,o)+"":e}function l(e,t){e.currentElement?e.currentElement.appendChild(t):e.doc.appendChild(t)}n.prototype.parseFromString=function(e,t){var o=this.options,n=new u,a=o.domBuilder||new i,c=o.errorHandler,s=o.locator,l=o.xmlns||{},p={lt:"<",gt:">",amp:"&",quot:'"',apos:"'"};return s&&a.setDocumentLocator(s),n.errorHandler=r(c,a,s),n.domBuilder=o.domBuilder||a,/\/x?html?$/.test(t)&&(p.nbsp="\xa0",p.copy="\xa9",l[""]="http://www.w3.org/1999/xhtml"),l.xml=l.xml||"http://www.w3.org/XML/1998/namespace",e?n.parse(e,l,p):n.errorHandler.error("invalid doc source"),a.doc},i.prototype={startDocument:function(){this.doc=(new p).createDocument(null,null,null),this.locator&&(this.doc.documentURI=this.locator.systemId)},startElement:function(e,t,o,n){var r=this.doc,i=r.createElementNS(e,o||t),c=n.length;l(this,i),this.currentElement=i,this.locator&&a(this.locator,i);for(var s=0;s<c;s++){e=n.getURI(s);var u=n.getValue(s),p=(o=n.getQName(s),r.createAttributeNS(e,o));this.locator&&a(n.getLocator(s),p),p.value=p.nodeValue=u,i.setAttributeNode(p)}},endElement:function(e,t,o){var n=this.currentElement;n.tagName,this.currentElement=n.parentNode},startPrefixMapping:function(e,t){},endPrefixMapping:function(e){},processingInstruction:function(e,t){var o=this.doc.createProcessingInstruction(e,t);this.locator&&a(this.locator,o),l(this,o)},ignorableWhitespace:function(e,t,o){},characters:function(e,t,o){if(e=s.apply(this,arguments)){if(this.cdata)var n=this.doc.createCDATASection(e);else n=this.doc.createTextNode(e);this.currentElement?this.currentElement.appendChild(n):/^\s*$/.test(e)&&this.doc.appendChild(n),this.locator&&a(this.locator,n)}},skippedEntity:function(e){},endDocument:function(){this.doc.normalize()},setDocumentLocator:function(e){(this.locator=e)&&(e.lineNumber=0)},comment:function(e,t,o){e=s.apply(this,arguments);var n=this.doc.createComment(e);this.locator&&a(this.locator,n),l(this,n)},startCDATA:function(){this.cdata=!0},endCDATA:function(){this.cdata=!1},startDTD:function(e,t,o){var n=this.doc.implementation;if(n&&n.createDocumentType){var r=n.createDocumentType(e,t,o);this.locator&&a(this.locator,r),l(this,r)}},warning:function(e){console.warn("[xmldom warning]\t"+e,c(this.locator))},error:function(e){console.error("[xmldom error]\t"+e,c(this.locator))},fatalError:function(e){throw console.error("[xmldom fatalError]\t"+e,c(this.locator)),e}},"endDTD,startEntity,endEntity,attributeDecl,elementDecl,externalEntityDecl,internalEntityDecl,resolveEntity,getExternalSubset,notationDecl,unparsedEntityDecl".replace(/\w+/g,function(e){i.prototype[e]=function(){return null}});var u=o(12).XMLReader,p=t.DOMImplementation=o(1).DOMImplementation;t.XMLSerializer=o(1).XMLSerializer,t.DOMParser=n},function(e,t){function o(){}function n(e,t,o,n,l){function h(e){if(e>65535){var t=55296+((e-=65536)>>10),o=56320+(1023&e);return String.fromCharCode(t,o)}return String.fromCharCode(e)}function f(e){var t=e.slice(1,-1);return t in o?o[t]:"#"===t.charAt(0)?h(parseInt(t.substr(1).replace("x","0x"))):(l.error("entity not found:"+e),e)}function y(t){if(t>S){var o=e.substring(S,t).replace(/&#?\w+;/g,f);C&&m(S),n.characters(o,0,t-S),S=t}}function m(t,o){for(;t>=v&&(o=_.exec(e));)g=o.index,v=g+o[0].length,C.lineNumber++;C.columnNumber=t-g+1}for(var g=0,v=0,_=/.*(?:\r\n?|\n)|.*$/g,C=n.locator,b=[{currentNSMap:t}],w={},S=0;;){try{var k=e.indexOf("<",S);if(k<0){if(!e.substr(S).match(/^\s*$/)){var E=n.doc,P=E.createTextNode(e.substr(S));E.appendChild(P),n.currentElement=P}return}switch(k>S&&y(k),e.charAt(k+1)){case"/":var M=e.indexOf(">",k+3),A=e.substring(k+2,M),O=b.pop();M<0?(A=e.substring(k+2).replace(/[\s<].*/,""),l.error("end tag name: "+A+" is not complete:"+O.tagName),M=k+1+A.length):A.match(/\s</)&&(A=A.replace(/[\s<].*/,""),l.error("end tag name: "+A+" maybe not complete"),M=k+1+A.length);var R=O.localNSMap,x=O.tagName==A;if(x||O.tagName&&O.tagName.toLowerCase()==A.toLowerCase()){if(n.endElement(O.uri,O.localName,A),R)for(var T in R)n.endPrefixMapping(T);x||l.fatalError("end tag name: "+A+" is not match the current start tagName:"+O.tagName)}else b.push(O);M++;break;case"?":C&&m(k),M=p(e,k,n);break;case"!":C&&m(k),M=u(e,k,n,l);break;default:C&&m(k);var N=new d,B=b[b.length-1].currentNSMap,I=(M=i(e,k,N,B,f,l),N.length);if(!N.closed&&s(e,M,N.tagName,w)&&(N.closed=!0,o.nbsp||l.warning("unclosed xml attribute")),C&&I){for(var D=r(C,{}),V=0;V<I;V++){var j=N[V];m(j.offset),j.locator=r(C,{})}n.locator=D,a(N,n,B)&&b.push(N),n.locator=C}else a(N,n,B)&&b.push(N);"http://www.w3.org/1999/xhtml"!==N.uri||N.closed?M++:M=c(e,M,N.tagName,f,n)}}catch(e){l.error("element parse error: "+e),M=-1}M>S?S=M:y(Math.max(k,S)+1)}}function r(e,t){return t.lineNumber=e.lineNumber,t.columnNumber=e.columnNumber,t}function i(e,t,o,n,r,i){for(var a,c=++t,s=v;;){var l=e.charAt(c);switch(l){case"=":if(s===_)a=e.slice(t,c),s=b;else{if(s!==C)throw new Error("attribute equal must after attrName");s=b}break;case"'":case'"':if(s===b||s===_){if(s===_&&(i.warning('attribute value must after "="'),a=e.slice(t,c)),t=c+1,!((c=e.indexOf(l,t))>0))throw new Error("attribute value no end '"+l+"' match");u=e.slice(t,c).replace(/&#?\w+;/g,r),o.add(a,u,t-1),s=S}else{if(s!=w)throw new Error('attribute value must after "="');u=e.slice(t,c).replace(/&#?\w+;/g,r),o.add(a,u,t),i.warning('attribute "'+a+'" missed start quot('+l+")!!"),t=c+1,s=S}break;case"/":switch(s){case v:o.setTagName(e.slice(t,c));case S:case k:case E:s=E,o.closed=!0;case w:case _:case C:break;default:throw new Error("attribute invalid close char('/')")}break;case"":return i.error("unexpected end of input"),s==v&&o.setTagName(e.slice(t,c)),c;case">":switch(s){case v:o.setTagName(e.slice(t,c));case S:case k:case E:break;case w:case _:"/"===(u=e.slice(t,c)).slice(-1)&&(o.closed=!0,u=u.slice(0,-1));case C:s===C&&(u=a),s==w?(i.warning('attribute "'+u+'" missed quot(")!!'),o.add(a,u.replace(/&#?\w+;/g,r),t)):("http://www.w3.org/1999/xhtml"===n[""]&&u.match(/^(?:disabled|checked|selected)$/i)||i.warning('attribute "'+u+'" missed value!! "'+u+'" instead!!'),o.add(u,u,t));break;case b:throw new Error("attribute value missed!!")}return c;case"\x80":l=" ";default:if(l<=" ")switch(s){case v:o.setTagName(e.slice(t,c)),s=k;break;case _:a=e.slice(t,c),s=C;break;case w:var u=e.slice(t,c).replace(/&#?\w+;/g,r);i.warning('attribute "'+u+'" missed quot(")!!'),o.add(a,u,t);case S:s=k}else switch(s){case C:o.tagName,"http://www.w3.org/1999/xhtml"===n[""]&&a.match(/^(?:disabled|checked|selected)$/i)||i.warning('attribute "'+a+'" missed value!! "'+a+'" instead2!!'),o.add(a,a,t),t=c,s=_;break;case S:i.warning('attribute space is required"'+a+'"!!');case k:s=_,t=c;break;case b:s=w,t=c;break;case E:throw new Error("elements closed character '/' and '>' must be connected to")}}c++}}function a(e,t,o){for(var n=e.tagName,r=null,i=e.length;i--;){var a=e[i],c=a.qName,s=a.value;if((h=c.indexOf(":"))>0)var u=a.prefix=c.slice(0,h),p=c.slice(h+1),d="xmlns"===u&&p;else p=c,u=null,d="xmlns"===c&&"";a.localName=p,!1!==d&&(null==r&&(r={},l(o,o={})),o[d]=r[d]=s,a.uri="http://www.w3.org/2000/xmlns/",t.startPrefixMapping(d,s))}for(i=e.length;i--;){(u=(a=e[i]).prefix)&&("xml"===u&&(a.uri="http://www.w3.org/XML/1998/namespace"),"xmlns"!==u&&(a.uri=o[u||""]))}var h;(h=n.indexOf(":"))>0?(u=e.prefix=n.slice(0,h),p=e.localName=n.slice(h+1)):(u=null,p=e.localName=n);var f=e.uri=o[u||""];if(t.startElement(f,p,n,e),!e.closed)return e.currentNSMap=o,e.localNSMap=r,!0;if(t.endElement(f,p,n),r)for(u in r)t.endPrefixMapping(u)}function c(e,t,o,n,r){if(/^(?:script|textarea)$/i.test(o)){var i=e.indexOf("</"+o+">",t),a=e.substring(t+1,i);if(/[&<]/.test(a))return/^script$/i.test(o)?(r.characters(a,0,a.length),i):(a=a.replace(/&#?\w+;/g,n),r.characters(a,0,a.length),i)}return t+1}function s(e,t,o,n){var r=n[o];return null==r&&((r=e.lastIndexOf("</"+o+">"))<t&&(r=e.lastIndexOf("</"+o)),n[o]=r),r<t}function l(e,t){for(var o in e)t[o]=e[o]}function u(e,t,o,n){switch(e.charAt(t+2)){case"-":return"-"===e.charAt(t+3)?(r=e.indexOf("--\x3e",t+4))>t?(o.comment(e,t+4,r-t-4),r+3):(n.error("Unclosed comment"),-1):-1;default:if("CDATA["==e.substr(t+3,6)){var r=e.indexOf("]]>",t+9);return o.startCDATA(),o.characters(e,t+9,r-t-9),o.endCDATA(),r+3}var i=f(e,t),a=i.length;if(a>1&&/!doctype/i.test(i[0][0])){var c=i[1][0],s=a>3&&/^public$/i.test(i[2][0])&&i[3][0],l=a>4&&i[4][0],u=i[a-1];return o.startDTD(c,s&&s.replace(/^(['"])(.*?)\1$/,"$2"),l&&l.replace(/^(['"])(.*?)\1$/,"$2")),o.endDTD(),u.index+u[0].length}}return-1}function p(e,t,o){var n=e.indexOf("?>",t);if(n){var r=e.substring(t,n).match(/^<\?(\S*)\s*([\s\S]*?)\s*$/);return r?(r[0].length,o.processingInstruction(r[1],r[2]),n+2):-1}return-1}function d(e){}function h(e,t){return e.__proto__=t,e}function f(e,t){var o,n=[],r=/'[^']+'|"[^"]+"|[^\s<>\/=]+=?|(\/?\s*>|<)/g;for(r.lastIndex=t,r.exec(e);o=r.exec(e);)if(n.push(o),o[1])return n}var y=/[A-Z_a-z\xC0-\xD6\xD8-\xF6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,m=new RegExp("[\\-\\.0-9"+y.source.slice(1,-1)+"\\u00B7\\u0300-\\u036F\\u203F-\\u2040]"),g=new RegExp("^"+y.source+m.source+"*(?::"+y.source+m.source+"*)?$"),v=0,_=1,C=2,b=3,w=4,S=5,k=6,E=7;o.prototype={parse:function(e,t,o){var r=this.domBuilder;r.startDocument(),l(t,t={}),n(e,t,o,r,this.errorHandler),r.endDocument()}},d.prototype={setTagName:function(e){if(!g.test(e))throw new Error("invalid tagName:"+e);this.tagName=e},add:function(e,t,o){if(!g.test(e))throw new Error("invalid attribute:"+e);this[this.length++]={qName:e,value:t,offset:o}},length:0,getLocalName:function(e){return this[e].localName},getLocator:function(e){return this[e].locator},getQName:function(e){return this[e].qName},getURI:function(e){return this[e].uri},getValue:function(e){return this[e].value}},h({},h.prototype)instanceof h||(h=function(e,t){function o(){}for(t in o.prototype=t,o=new o,e)o[t]=e[t];return o}),t.XMLReader=o},function(e,t,o){function n(e,t){var o=e.Bucket,n=e.Region,r=e.Key,i=e.AbortArray,c=e.AsyncLimit||1,s=this,l=0,u=new Array(i.length);a.eachLimit(i,c,function(t,i){var a=l;if(r&&r!==t.Key)return u[a]={error:{KeyNotMatch:!0}},void i(null);var c=t.UploadId||t.UploadID;s.multipartAbort({Bucket:o,Region:n,Key:t.Key,Headers:e.Headers,UploadId:c},function(e,r){var s={Bucket:o,Region:n,Key:t.Key,UploadId:c};u[a]={error:e,task:s},i(null)}),l++},function(e){if(e)return t(e);for(var o=[],n=[],r=0,i=u.length;r<i;r++){var a=u[r];a.task&&(a.error?n.push(a.task):o.push(a.task))}return t(null,{successList:o,errorList:n})})}function r(e,t){var o=this,n=[],r={Bucket:e.Bucket,Region:e.Region,Prefix:e.Key};(function e(){o.multipartList(r,function(o,i){if(o)return t(o);n.push.apply(n,i.Upload||[]),"true"==i.IsTruncated?(r.KeyMarker=i.NextKeyMarker,r.UploadIdMarker=i.NextUploadIdMarker,e()):t(null,{UploadList:n})})})()}function i(e,t){var o=e.TaskId,n=e.Bucket,r=e.Region,i=e.Key,c=e.CopySource,s=e.UploadId,l=1*e.PartNumber,u=e.CopySourceRange,p=this.options.ChunkRetryTimes+1,d=this;a.retry(p,function(t){d.uploadPartCopy({TaskId:o,Bucket:n,Region:r,Key:i,CopySource:c,UploadId:s,PartNumber:l,CopySourceRange:u,onProgress:e.onProgress},function(e,o){t(e||null,o)})},function(e,o){return t(e,o)})}var a=o(14),c=o(2).EventProxy,s=o(0),l={abortUploadTask:function(e,t){var o=e.Bucket,i=e.Region,a=e.Key,s=e.UploadId,l=e.Level||"task",u=e.AsyncLimit,p=this,d=new c;if(d.on("error",function(e){return t(e)}),d.on("get_abort_array",function(r){n.call(p,{Bucket:o,Region:i,Key:a,Headers:e.Headers,AsyncLimit:u,AbortArray:r},function(e,o){if(e)return t(e);t(null,o)})}),"bucket"===l)r.call(p,{Bucket:o,Region:i},function(e,o){if(e)return t(e);d.emit("get_abort_array",o.UploadList||[])});else if("file"===l){if(!a)return t({error:"abort_upload_task_no_key"});r.call(p,{Bucket:o,Region:i,Key:a},function(e,o){if(e)return t(e);d.emit("get_abort_array",o.UploadList||[])})}else{if("task"!==l)return t({error:"abort_unknown_level"});if(!s)return t({error:"abort_upload_task_no_id"});if(!a)return t({error:"abort_upload_task_no_key"});d.emit("get_abort_array",[{Key:a,UploadId:s}])}},sliceCopyFile:function(e,t){var o=new c,n=this,r=e.Bucket,l=e.Region,u=e.Key,p=e.CopySource,d=p.match(/^([^.]+-\d+)\.cos(v6)?\.([^.]+)\.[^\/]+\/(.+)$/);if(d){var h=d[1],f=d[3],y=decodeURIComponent(d[4]),m=void 0===e.SliceSize?n.options.CopySliceSize:e.SliceSize;m=Math.max(0,Math.min(m,5368709120));var g,v,_=e.ChunkSize||this.options.CopyChunkSize,C=this.options.CopyChunkParallelLimit,b=0;o.on("copy_slice_complete",function(e){n.multipartComplete({Bucket:r,Region:l,Key:u,UploadId:e.UploadId,Parts:e.PartList},function(e,o){if(e)return v(null,!0),t(e);v({loaded:g,total:g},!0),t(null,o)})}),o.on("get_copy_data_finish",function(e){a.eachLimit(e.PartList,C,function(t,o){var a=t.PartNumber,c=t.CopySourceRange,s=t.end-t.start,d=0;i.call(n,{Bucket:r,Region:l,Key:u,CopySource:p,UploadId:e.UploadId,PartNumber:a,CopySourceRange:c,onProgress:function(e){b+=e.loaded-d,d=e.loaded,v({loaded:b,total:g})}},function(e,n){if(e)return o(e);v({loaded:b,total:g}),b+=s-d,t.ETag=n.ETag,o(e||null,n)})},function(n){if(n)return v(null,!0),t(n);o.emit("copy_slice_complete",e)})}),o.on("get_file_size_finish",function(i){var a;!function(){for(var t=[1,2,4,8,16,32,64,128,256,512,1024,2048,4096,5120],o=1048576,r=0;r<t.length&&!(g/(o=1024*t[r]*1024)<=n.options.MaxPartNumber);r++);e.ChunkSize=_=Math.max(_,o);for(var i=Math.ceil(g/_),a=[],c=1;c<=i;c++){var s=(c-1)*_,l=c*_<g?c*_-1:g-1,u={PartNumber:c,start:s,end:l,CopySourceRange:"bytes="+s+"-"+l};a.push(u)}e.PartList=a}(),(a="Replaced"===e.Headers["x-cos-metadata-directive"]?e.Headers:i)["x-cos-storage-class"]=e.Headers["x-cos-storage-class"]||i["x-cos-storage-class"],a=s.clearKey(a),n.multipartInit({Bucket:r,Region:l,Key:u,Headers:a},function(n,r){if(n)return t(n);e.UploadId=r.UploadId,o.emit("get_copy_data_finish",e)})}),n.headObject({Bucket:h,Region:f,Key:y},function(r,i){if(r)t(r.statusCode&&404===r.statusCode?{ErrorStatus:y+" Not Exist"}:r);else if(void 0!==(g=e.FileSize=i.headers["content-length"])&&g)if(v=s.throttleOnProgress.call(n,g,e.onProgress),g<=m)e.Headers["x-cos-metadata-directive"]||(e.Headers["x-cos-metadata-directive"]="Copy"),n.putObjectCopy(e,function(e,o){if(e)return v(null,!0),t(e);v({loaded:g,total:g},!0),t(e,o)});else{var a=i.headers,c={"Cache-Control":a["cache-control"],"Content-Disposition":a["content-disposition"],"Content-Encoding":a["content-encoding"],"Content-Type":a["content-type"],Expires:a.expires,"x-cos-storage-class":a["x-cos-storage-class"]};s.each(a,function(e,t){0===t.indexOf("x-cos-meta-")&&t.length>"x-cos-meta-".length&&(c[t]=e)}),o.emit("get_file_size_finish",c)}else t({error:'get Content-Length error, please add "Content-Length" to CORS ExposeHeader setting.'})})}else t({error:"CopySource format error"})}};e.exports.init=function(e,t){s.each(l,function(t,o){e.prototype[o]=s.apiWrapper(o,t)})}},function(e,t){var o={eachLimit:function(e,t,o,n){if(n=n||function(){},!e.length||t<=0)return n();var r=0,i=0,a=0;!function c(){if(r>=e.length)return n();for(;a<t&&i<e.length;)a+=1,o(e[(i+=1)-1],function(t){t?(n(t),n=function(){}):(a-=1,(r+=1)>=e.length?n():c())})}()},retry:function(e,t,o){var n=function n(r){t(function(t,i){t&&r<e?n(r+1):o(t,i)})};e<1?o():n(1)}};e.exports=o},function(e,t,o){function n(e){var t={GrantFullControl:[],GrantWrite:[],GrantRead:[],GrantReadAcp:[],GrantWriteAcp:[],ACL:""},o={FULL_CONTROL:"GrantFullControl",WRITE:"GrantWrite",READ:"GrantRead",READ_ACP:"GrantReadAcp",WRITE_ACP:"GrantWriteAcp"},n=e.AccessControlList.Grant;n&&(n=p.isArray(n)?n:[n]);var i={READ:0,WRITE:0,FULL_CONTROL:0};return n.length&&p.each(n,function(n){"qcs::cam::anyone:anyone"===n.Grantee.ID||"http://cam.qcloud.com/groups/global/AllUsers"===n.Grantee.URI?i[n.Permission]=1:n.Grantee.ID!==e.Owner.ID&&t[o[n.Permission]].push('id="'+n.Grantee.ID+'"')}),i.FULL_CONTROL||i.WRITE&&i.READ?t.ACL="public-read-write":i.READ?t.ACL="public-read":t.ACL="private",p.each(o,function(e){t[e]=r(t[e].join(","))}),t}function r(e){var t,o,n=e.split(","),r={};for(t=0;t<n.length;)r[o=n[t].trim()]?n.splice(t,1):(r[o]=!0,n[t]=o,t++);return n.join(",")}function i(e){var t=e.bucket,o=t.substr(0,t.lastIndexOf("-")),n=t.substr(t.lastIndexOf("-")+1),r=e.domain,i=e.region,a=e.object;r||(r=["cn-south","cn-south-2","cn-north","cn-east","cn-southwest","sg"].indexOf(i)>-1?"{Region}.myqcloud.com":"cos.{Region}.myqcloud.com",e.ForcePathStyle||(r="{Bucket}."+r)),r=(r=r.replace(/\{\{AppId\}\}/gi,n).replace(/\{\{Bucket\}\}/gi,o).replace(/\{\{Region\}\}/gi,i).replace(/\{\{.*?\}\}/gi,"")).replace(/\{AppId\}/gi,n).replace(/\{BucketName\}/gi,o).replace(/\{Bucket\}/gi,t).replace(/\{Region\}/gi,i).replace(/\{.*?\}/gi,""),/^[a-zA-Z]+:\/\//.test(r)||(r="https://"+r),"/"===r.slice(-1)&&(r=r.slice(0,-1));var c=r;return e.ForcePathStyle&&(c+="/"+t),c+="/",a&&(c+=p.camSafeUrlEncode(a).replace(/%2F/g,"/")),e.isLocation&&(c=c.replace(/^https?:\/\//,"")),c}function a(e,t){var o=p.clone(e.Headers);delete o["Content-Type"],delete o["Cache-Control"],p.each(o,function(e,t){""===e&&delete o[t]});var n=function(e){var o=!1,n=e.Authorization;if(n)if(n.indexOf(" ")>-1)o=!1;else if(n.indexOf("q-sign-algorithm=")>-1&&n.indexOf("q-ak=")>-1&&n.indexOf("q-sign-time=")>-1&&n.indexOf("q-key-time=")>-1&&n.indexOf("q-url-param-list=")>-1)o=!0;else try{n=atob(n),n.indexOf("a=")>-1&&n.indexOf("k=")>-1&&n.indexOf("t=")>-1&&n.indexOf("r=")>-1&&n.indexOf("b=")>-1&&(o=!0)}catch(e){}o?t&&t(null,e):t&&t("authorization error")},r=this,i=e.Bucket||"",a=e.Region||"",c="name/cos:PostObject"!==e.Action&&e.Key?e.Key:"";r.options.ForcePathStyle&&i&&(c=i+"/"+c);var s="/"+c,l={},u=e.Scope;if(!u){var d=e.Action||"",h=e.ResourceKey||e.Key||"";u=e.Scope||[{action:d,bucket:i,region:a,prefix:h}]}var f=p.md5(JSON.stringify(u));r._StsCache=r._StsCache||[],function(){var e,t;for(e=r._StsCache.length-1;e>=0;e--){t=r._StsCache[e];var o=Math.round(p.getSkewTime(r.options.SystemClockOffset)/1e3)+30;if(t.StartTime&&o<t.StartTime||o>=t.ExpiredTime)r._StsCache.splice(e,1);else if(!t.ScopeLimit||t.ScopeLimit&&t.ScopeKey===f){l=t;break}}}();var y=function(){var t={Authorization:p.getAuth({SecretId:l.TmpSecretId,SecretKey:l.TmpSecretKey,Method:e.Method,Pathname:s,Query:e.Query,Headers:o,Expires:e.Expires,SystemClockOffset:r.options.SystemClockOffset}),XCosSecurityToken:l.XCosSecurityToken||"",Token:l.Token||"",ClientIP:l.ClientIP||"",ClientUA:l.ClientUA||""};n(t)};if(l.ExpiredTime&&l.ExpiredTime-p.getSkewTime(r.options.SystemClockOffset)/1e3>60)y();else if(r.options.getAuthorization)r.options.getAuthorization.call(r,{Bucket:i,Region:a,Method:e.Method,Key:c,Pathname:s,Query:e.Query,Headers:o,Scope:u},function(e){"string"==typeof e&&(e={Authorization:e}),e.TmpSecretId&&e.TmpSecretKey&&e.XCosSecurityToken&&e.ExpiredTime?((l=e||{}).Scope=u,l.ScopeKey=f,r._StsCache.push(l),y()):n(e)});else{if(!r.options.getSTS)return function(){var t={Authorization:p.getAuth({SecretId:e.SecretId||r.options.SecretId,SecretKey:e.SecretKey||r.options.SecretKey,Method:e.Method,Pathname:s,Query:e.Query,Headers:o,Expires:e.Expires,SystemClockOffset:r.options.SystemClockOffset}),XCosSecurityToken:r.options.XCosSecurityToken};return n(t),t}();r.options.getSTS.call(r,{Bucket:i,Region:a},function(e){(l=e||{}).Scope=u,l.ScopeKey=f,l.TmpSecretId=l.SecretId,l.TmpSecretKey=l.SecretKey,r._StsCache.push(l),y()})}return""}function c(e){var t=!1,o=!1,n=e.headers&&(e.headers.date||e.headers.Date)||"";try{var r=e.error.Code,i=e.error.Message;("RequestTimeTooSkewed"===r||"AccessDenied"===r&&"Request has expired"===i)&&(o=!0)}catch(e){}if(e)if(o&&n){var a=Date.parse(n);this.options.CorrectClockSkew&&Math.abs(p.getSkewTime(this.options.SystemClockOffset)-a)>=3e4&&(console.error("error: Local time is too skewed."),this.options.SystemClockOffset=a-Date.now(),t=!0)}else 5===Math.round(e.statusCode/100)&&(t=!0);return t}function s(e,t){var o=this;!e.headers&&(e.headers={}),!e.qs&&(e.qs={}),e.VersionId&&(e.qs.versionId=e.VersionId),e.qs=p.clearKey(e.qs),e.headers&&(e.headers=p.clearKey(e.headers)),e.qs&&(e.qs=p.clearKey(e.qs));var n=p.clone(e.qs);e.action&&(n[e.action]="");(function r(i){var s=o.options.SystemClockOffset;a.call(o,{Bucket:e.Bucket||"",Region:e.Region||"",Method:e.method,Key:e.Key,Query:n,Headers:e.headers,Action:e.Action,ResourceKey:e.ResourceKey,Scope:e.Scope},function(n,a){e.AuthData=a,l.call(o,e,function(n,a){n&&i<2&&(s!==o.options.SystemClockOffset||c.call(o,n))?(e.headers&&(delete e.headers.Authorization,delete e.headers.token,delete e.headers.clientIP,delete e.headers.clientUA,delete e.headers["x-cos-security-token"]),r(i+1)):t(n,a)})})})(0)}function l(e,t){var o=this,n=e.TaskId;if(!n||o._isRunningTask(n)){var r=e.Bucket,a=e.Region,c=e.Key,s=e.method||"GET",l=e.url,d=e.body,h=e.json,f=e.rawBody;l=l||i({ForcePathStyle:o.options.ForcePathStyle,protocol:o.options.Protocol,domain:o.options.Domain,bucket:r,region:a,object:c}),e.action&&(l=l+"?"+e.action);var y={method:s,url:l,headers:e.headers,qs:e.qs,filePath:e.filePath,body:d,json:h};y.headers.Authorization=e.AuthData.Authorization,e.AuthData.Token&&(y.headers.token=e.AuthData.Token),e.AuthData.ClientIP&&(y.headers.clientIP=e.AuthData.ClientIP),e.AuthData.ClientUA&&(y.headers.clientUA=e.AuthData.ClientUA),e.AuthData.XCosSecurityToken&&(y.headers["x-cos-security-token"]=e.AuthData.XCosSecurityToken),y.headers&&(y.headers=p.clearKey(y.headers)),y=p.clearKey(y),e.onProgress&&"function"==typeof e.onProgress&&(y.onProgress=function(t){if(!n||o._isRunningTask(n)){var r=t?t.loaded:0;e.onProgress({loaded:r,total:t.total})}}),o.options.ForcePathStyle&&(y.pathStyle=o.options.ForcePathStyle);var m=u(y,function(e,r,i){var a,c=function(e,i){if(n&&o.off("inner-kill-task",g),!a){a=!0;var c={};r&&r.statusCode&&(c.statusCode=r.statusCode),r&&r.headers&&(c.headers=r.headers),e?(e=p.extend(e||{},c),t(e,null)):(i=p.extend(i||{},c),t(null,i))}};if(!e){var s;try{s=p.xml2json(i)||{}}catch(e){s=i||{}}var l=r.statusCode;return 2!==Math.floor(l/100)?void c({error:s.Error||s}):(f&&((s={}).body=i),s.Error?void c({error:s.Error}):void c(null,s))}c({error:e})}),g=function e(t){t.TaskId===n&&(m&&m.abort&&m.abort(),o.off("inner-kill-task",e))};n&&o.on("inner-kill-task",g)}}var u=o(9),p=o(0),d={getService:function(e,t){"function"==typeof e&&(t=e,e={});var o=this.options.ServiceDomain,n=e.AppId||this.options.appId;o?(o=o.replace(/\{\{AppId\}\}/gi,n||"").replace(/\{\{.*?\}\}/gi,""),/^[a-zA-Z]+:\/\//.test(o)||(o="https://"+o),"/"===o.slice(-1)&&(o=o.slice(0,-1))):o="https://service.cos.myqcloud.com",s.call(this,{Action:"name/cos:GetService",url:o+"/",method:"GET"},function(e,o){if(e)return t(e);var n=o&&o.ListAllMyBucketsResult&&o.ListAllMyBucketsResult.Buckets&&o.ListAllMyBucketsResult.Buckets.Bucket||[];n=p.isArray(n)?n:[n],t(null,{Buckets:n,statusCode:o.statusCode,headers:o.headers})})},putBucket:function(e,t){var o=this,n={};n["x-cos-acl"]=e.ACL,n["x-cos-grant-read"]=e.GrantRead,n["x-cos-grant-write"]=e.GrantWrite,n["x-cos-grant-read-acp"]=e.GrantReadAcp,n["x-cos-grant-write-acp"]=e.GrantWriteAcp,n["x-cos-grant-full-control"]=e.GrantFullControl,s.call(this,{Action:"name/cos:PutBucket",method:"PUT",Bucket:e.Bucket,Region:e.Region,headers:n},function(n,r){if(n)return t(n);var a=i({domain:o.options.Domain,bucket:e.Bucket,region:e.Region,isLocation:!0});t(null,{Location:a,statusCode:r.statusCode,headers:r.headers})})},getBucket:function(e,t){var o={};o.prefix=e.Prefix||"",o.delimiter=e.Delimiter,o.marker=e.Marker,o["max-keys"]=e.MaxKeys,o["encoding-type"]=e.EncodingType,s.call(this,{Action:"name/cos:GetBucket",ResourceKey:o.prefix,method:"GET",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,qs:o},function(e,o){if(e)return t(e);var n=o.ListBucketResult||{},r=n.Contents||[],i=n.CommonPrefixes||[];r=p.isArray(r)?r:[r],i=p.isArray(i)?i:[i];var a=p.clone(n);p.extend(a,{Contents:r,CommonPrefixes:i,statusCode:o.statusCode,headers:o.headers}),t(null,a)})},headBucket:function(e,t){s.call(this,{Action:"name/cos:HeadBucket",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,method:"HEAD"},function(e,o){t(e,o)})},deleteBucket:function(e,t){s.call(this,{Action:"name/cos:DeleteBucket",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,method:"DELETE"},function(e,o){return e&&204===e.statusCode?t(null,{statusCode:e.statusCode}):e?t(e):void t(null,{statusCode:o.statusCode,headers:o.headers})})},getBucketAcl:function(e,t){s.call(this,{Action:"name/cos:GetBucketACL",method:"GET",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,action:"acl"},function(e,o){if(e)return t(e);var r=o.AccessControlPolicy||{},i=r.Owner||{},a=r.AccessControlList.Grant||[];a=p.isArray(a)?a:[a];var c=n(r);o.headers&&o.headers["x-cos-acl"]&&(c.ACL=o.headers["x-cos-acl"]),c=p.extend(c,{Owner:i,Grants:a,statusCode:o.statusCode,headers:o.headers}),t(null,c)})},putBucketAcl:function(e,t){var o=e.Headers,n="";if(e.AccessControlPolicy){var i=p.clone(e.AccessControlPolicy||{}),a=i.Grants||i.Grant;a=p.isArray(a)?a:[a],delete i.Grant,delete i.Grants,i.AccessControlList={Grant:a},n=p.json2xml({AccessControlPolicy:i}),o["Content-Type"]="application/xml",o["Content-MD5"]=p.binaryBase64(p.md5(n))}p.each(o,function(e,t){0===t.indexOf("x-cos-grant-")&&(o[t]=r(o[t]))}),s.call(this,{Action:"name/cos:PutBucketACL",method:"PUT",Bucket:e.Bucket,Region:e.Region,headers:o,action:"acl",body:n},function(e,o){if(e)return t(e);t(null,{statusCode:o.statusCode,headers:o.headers})})},getBucketCors:function(e,t){s.call(this,{Action:"name/cos:GetBucketCORS",method:"GET",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,action:"cors"},function(e,o){if(e)if(404===e.statusCode&&e.error&&"NoSuchCORSConfiguration"===e.error.Code){var n={CORSRules:[],statusCode:e.statusCode};e.headers&&(n.headers=e.headers),t(null,n)}else t(e);else{var r=o.CORSConfiguration||{},i=r.CORSRules||r.CORSRule||[];i=p.clone(p.isArray(i)?i:[i]),p.each(i,function(e){p.each(["AllowedOrigin","AllowedHeader","AllowedMethod","ExposeHeader"],function(t,o){var n=t+"s",r=e[n]||e[t]||[];delete e[t],e[n]=p.isArray(r)?r:[r]})}),t(null,{CORSRules:i,statusCode:o.statusCode,headers:o.headers})}})},putBucketCors:function(e,t){var o=(e.CORSConfiguration||{}).CORSRules||e.CORSRules||[];o=p.clone(p.isArray(o)?o:[o]),p.each(o,function(e){p.each(["AllowedOrigin","AllowedHeader","AllowedMethod","ExposeHeader"],function(t,o){var n=t+"s",r=e[n]||e[t]||[];delete e[n],e[t]=p.isArray(r)?r:[r]})});var n=p.json2xml({CORSConfiguration:{CORSRule:o}}),r=e.Headers;r["Content-Type"]="application/xml",r["Content-MD5"]=p.binaryBase64(p.md5(n)),s.call(this,{Action:"name/cos:PutBucketCORS",method:"PUT",Bucket:e.Bucket,Region:e.Region,body:n,action:"cors",headers:r},function(e,o){if(e)return t(e);t(null,{statusCode:o.statusCode,headers:o.headers})})},deleteBucketCors:function(e,t){s.call(this,{Action:"name/cos:DeleteBucketCORS",method:"DELETE",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,action:"cors"},function(e,o){return e&&204===e.statusCode?t(null,{statusCode:e.statusCode}):e?t(e):void t(null,{statusCode:o.statusCode||e.statusCode,headers:o.headers})})},getBucketLocation:function(e,t){s.call(this,{Action:"name/cos:GetBucketLocation",method:"GET",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,action:"location"},function(e,o){if(e)return t(e);t(null,o)})},putBucketTagging:function(e,t){var o=e.Tagging||{},n=o.TagSet||o.Tags||e.Tags||[];n=p.clone(p.isArray(n)?n:[n]);var r=p.json2xml({Tagging:{TagSet:{Tag:n}}}),i=e.Headers;i["Content-Type"]="application/xml",i["Content-MD5"]=p.binaryBase64(p.md5(r)),s.call(this,{Action:"name/cos:PutBucketTagging",method:"PUT",Bucket:e.Bucket,Region:e.Region,body:r,action:"tagging",headers:i},function(e,o){return e&&204===e.statusCode?t(null,{statusCode:e.statusCode}):e?t(e):void t(null,{statusCode:o.statusCode,headers:o.headers})})},getBucketTagging:function(e,t){s.call(this,{Action:"name/cos:GetBucketTagging",method:"GET",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,action:"tagging"},function(e,o){if(e)if(404!==e.statusCode||!e.error||"Not Found"!==e.error&&"NoSuchTagSet"!==e.error.Code)t(e);else{var n={Tags:[],statusCode:e.statusCode};e.headers&&(n.headers=e.headers),t(null,n)}else{var r=[];try{r=o.Tagging.TagSet.Tag||[]}catch(e){}r=p.clone(p.isArray(r)?r:[r]),t(null,{Tags:r,statusCode:o.statusCode,headers:o.headers})}})},deleteBucketTagging:function(e,t){s.call(this,{Action:"name/cos:DeleteBucketTagging",method:"DELETE",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,action:"tagging"},function(e,o){return e&&204===e.statusCode?t(null,{statusCode:e.statusCode}):e?t(e):void t(null,{statusCode:o.statusCode,headers:o.headers})})},getBucketPolicy:function(e,t){s.call(this,{Action:"name/cos:GetBucketPolicy",method:"GET",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,action:"policy",rawBody:!0},function(e,o){if(e)return t(e.statusCode&&403===e.statusCode?{ErrorStatus:"Access Denied"}:e.statusCode&&405===e.statusCode?{ErrorStatus:"Method Not Allowed"}:e.statusCode&&404===e.statusCode?{ErrorStatus:"Policy Not Found"}:e);var n={};try{n=JSON.parse(o.body)}catch(e){}t(null,{Policy:n,statusCode:o.statusCode,headers:o.headers})})},putBucketPolicy:function(e,t){var o=e.Policy,n=o;try{"string"==typeof o?o=JSON.parse(n):n=JSON.stringify(o)}catch(e){t({error:"Policy format error"})}var r=e.Headers;r["Content-Type"]="application/json",r["Content-MD5"]=p.binaryBase64(p.md5(n)),s.call(this,{Action:"name/cos:PutBucketPolicy",method:"PUT",Bucket:e.Bucket,Region:e.Region,action:"policy",body:p.isBrowser?n:o,headers:r,json:!0},function(e,o){return e&&204===e.statusCode?t(null,{statusCode:e.statusCode}):e?t(e):void t(null,{statusCode:o.statusCode,headers:o.headers})})},deleteBucketPolicy:function(e,t){s.call(this,{Action:"name/cos:DeleteBucketPolicy",method:"DELETE",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,action:"policy"},function(e,o){return e&&204===e.statusCode?t(null,{statusCode:e.statusCode}):e?t(e):void t(null,{statusCode:o.statusCode||e.statusCode,headers:o.headers})})},getBucketLifecycle:function(e,t){s.call(this,{Action:"name/cos:GetBucketLifecycle",method:"GET",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,action:"lifecycle"},function(e,o){if(e)if(404===e.statusCode&&e.error&&"NoSuchLifecycleConfiguration"===e.error.Code){var n={Rules:[],statusCode:e.statusCode};e.headers&&(n.headers=e.headers),t(null,n)}else t(e);else{var r=[];try{r=o.LifecycleConfiguration.Rule||[]}catch(e){}r=p.clone(p.isArray(r)?r:[r]),t(null,{Rules:r,statusCode:o.statusCode,headers:o.headers})}})},putBucketLifecycle:function(e,t){var o=(e.LifecycleConfiguration||{}).Rules||[];o=p.clone(o);var n=p.json2xml({LifecycleConfiguration:{Rule:o}}),r=e.Headers;r["Content-Type"]="application/xml",r["Content-MD5"]=p.binaryBase64(p.md5(n)),s.call(this,{Action:"name/cos:PutBucketLifecycle",method:"PUT",Bucket:e.Bucket,Region:e.Region,body:n,action:"lifecycle",headers:r},function(e,o){return e&&204===e.statusCode?t(null,{statusCode:e.statusCode}):e?t(e):void t(null,{statusCode:o.statusCode,headers:o.headers})})},deleteBucketLifecycle:function(e,t){s.call(this,{Action:"name/cos:DeleteBucketLifecycle",method:"DELETE",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,action:"lifecycle"},function(e,o){return e&&204===e.statusCode?t(null,{statusCode:e.statusCode}):e?t(e):void t(null,{statusCode:o.statusCode,headers:o.headers})})},putBucketVersioning:function(e,t){if(e.VersioningConfiguration){var o=e.VersioningConfiguration||{},n=p.json2xml({VersioningConfiguration:o}),r=e.Headers;r["Content-Type"]="application/xml",r["Content-MD5"]=p.binaryBase64(p.md5(n)),s.call(this,{Action:"name/cos:PutBucketVersioning",method:"PUT",Bucket:e.Bucket,Region:e.Region,body:n,action:"versioning",headers:r},function(e,o){return e&&204===e.statusCode?t(null,{statusCode:e.statusCode}):e?t(e):void t(null,{statusCode:o.statusCode,headers:o.headers})})}else t({error:"missing param VersioningConfiguration"})},getBucketVersioning:function(e,t){s.call(this,{Action:"name/cos:GetBucketVersioning",method:"GET",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,action:"versioning"},function(e,o){e||!o.VersioningConfiguration&&(o.VersioningConfiguration={}),t(e,o)})},putBucketReplication:function(e,t){var o=p.clone(e.ReplicationConfiguration),n=p.json2xml({ReplicationConfiguration:o});n=(n=n.replace(/<(\/?)Rules>/gi,"<$1Rule>")).replace(/<(\/?)Tags>/gi,"<$1Tag>");var r=e.Headers;r["Content-Type"]="application/xml",r["Content-MD5"]=p.binaryBase64(p.md5(n)),s.call(this,{Action:"name/cos:PutBucketReplication",method:"PUT",Bucket:e.Bucket,Region:e.Region,body:n,action:"replication",headers:r},function(e,o){return e&&204===e.statusCode?t(null,{statusCode:e.statusCode}):e?t(e):void t(null,{statusCode:o.statusCode,headers:o.headers})})},getBucketReplication:function(e,t){s.call(this,{Action:"name/cos:GetBucketReplication",method:"GET",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,action:"replication"},function(e,o){if(e)if(404!==e.statusCode||!e.error||"Not Found"!==e.error&&"ReplicationConfigurationnotFoundError"!==e.error.Code)t(e);else{var n={ReplicationConfiguration:{Rules:[]},statusCode:e.statusCode};e.headers&&(n.headers=e.headers),t(null,n)}else e||!o.ReplicationConfiguration&&(o.ReplicationConfiguration={}),o.ReplicationConfiguration.Rule&&(o.ReplicationConfiguration.Rules=o.ReplicationConfiguration.Rule,delete o.ReplicationConfiguration.Rule),t(e,o)})},deleteBucketReplication:function(e,t){s.call(this,{Action:"name/cos:DeleteBucketReplication",method:"DELETE",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,action:"replication"},function(e,o){return e&&204===e.statusCode?t(null,{statusCode:e.statusCode}):e?t(e):void t(null,{statusCode:o.statusCode,headers:o.headers})})},getObject:function(e,t){var o={};o["response-content-type"]=e.ResponseContentType,o["response-content-language"]=e.ResponseContentLanguage,o["response-expires"]=e.ResponseExpires,o["response-cache-control"]=e.ResponseCacheControl,o["response-content-disposition"]=e.ResponseContentDisposition,o["response-content-encoding"]=e.ResponseContentEncoding,s.call(this,{Action:"name/cos:GetObject",method:"GET",Bucket:e.Bucket,Region:e.Region,Key:e.Key,VersionId:e.VersionId,headers:e.Headers,qs:o,rawBody:!0},function(o,n){if(o){var r=o.statusCode;return e.Headers["If-Modified-Since"]&&r&&304===r?t(null,{NotModified:!0}):t(o)}var i={};i.Body=n.body,n.headers&&n.headers.etag&&(i.ETag=n.headers&&n.headers.etag),p.extend(i,{statusCode:n.statusCode,headers:n.headers}),t(null,i)})},headObject:function(e,t){s.call(this,{Action:"name/cos:HeadObject",method:"HEAD",Bucket:e.Bucket,Region:e.Region,Key:e.Key,VersionId:e.VersionId,headers:e.Headers},function(o,n){if(o){var r=o.statusCode;return e.Headers["If-Modified-Since"]&&r&&304===r?t(null,{NotModified:!0,statusCode:r}):t(o)}n.headers&&n.headers.etag&&(n.ETag=n.headers&&n.headers.etag),t(null,n)})},listObjectVersions:function(e,t){var o={};o.prefix=e.Prefix||"",o.delimiter=e.Delimiter,o["key-marker"]=e.KeyMarker,o["version-id-marker"]=e.VersionIdMarker,o["max-keys"]=e.MaxKeys,o["encoding-type"]=e.EncodingType,s.call(this,{Action:"name/cos:GetBucketObjectVersions",ResourceKey:o.prefix,method:"GET",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,qs:o,action:"versions"},function(e,o){if(e)return t(e);var n=o.ListVersionsResult||{},r=n.DeleteMarker||[];r=p.isArray(r)?r:[r];var i=n.Version||[];i=p.isArray(i)?i:[i];var a=p.clone(n);delete a.DeleteMarker,delete a.Version,p.extend(a,{DeleteMarkers:r,Versions:i,statusCode:o.statusCode,headers:o.headers}),t(null,a)})},putObject:function(e,t){var o=this,n=e.ContentLength,r=p.throttleOnProgress.call(o,n,e.onProgress);p.getBodyMd5(o.options.UploadCheckContentMd5,e.Body,function(a){a&&(e.Headers["Content-MD5"]=p.binaryBase64(a)),void 0!==e.ContentLength&&(e.Headers["Content-Length"]=e.ContentLength),s.call(o,{Action:"name/cos:PutObject",TaskId:e.TaskId,method:"PUT",Bucket:e.Bucket,Region:e.Region,Key:e.Key,headers:e.Headers,body:e.Body,onProgress:r},function(a,c){if(a)return r(null,!0),t(a);if(r({loaded:n,total:n},!0),c&&c.headers&&c.headers.etag){var s=i({ForcePathStyle:o.options.ForcePathStyle,protocol:o.options.Protocol,domain:o.options.Domain,bucket:e.Bucket,region:e.Region,object:e.Key});return s=s.substr(s.indexOf("://")+3),t(null,{Location:s,ETag:c.headers.etag,statusCode:c.statusCode,headers:c.headers})}t(null,c)})})},postObject:function(e,t){var o=this,n={};n["Cache-Control"]=e.CacheControl,n["Content-Disposition"]=e.ContentDisposition,n["Content-Encoding"]=e.ContentEncoding,n["Content-MD5"]=e.ContentMD5,n["Content-Length"]=e.ContentLength,n["Content-Type"]=e.ContentType,n.Expect=e.Expect,n.Expires=e.Expires,n["x-cos-acl"]=e.ACL,n["x-cos-grant-read"]=e.GrantRead,n["x-cos-grant-write"]=e.GrantWrite,n["x-cos-grant-full-control"]=e.GrantFullControl,n["x-cos-storage-class"]=e.StorageClass;var r=e.FilePath;for(var a in e)a.indexOf("x-cos-meta-")>-1&&(n[a]=e[a]);var c=p.throttleOnProgress.call(o,n["Content-Length"],e.onProgress);s.call(this,{Action:"name/cos:PostObject",method:"POST",Bucket:e.Bucket,Region:e.Region,Key:e.Key,headers:n,filePath:r,onProgress:c},function(n,r){if(c(null,!0),n)return t(n);if(r){var a=i({ForcePathStyle:o.options.ForcePathStyle,protocol:o.options.Protocol,domain:o.options.Domain,bucket:e.Bucket,region:e.Region,object:e.Key,isLocation:!0});return t(null,{Location:a,statusCode:r.statusCode})}t(null,r)})},deleteObject:function(e,t){s.call(this,{Action:"name/cos:DeleteObject",method:"DELETE",Bucket:e.Bucket,Region:e.Region,Key:e.Key,headers:e.Headers,VersionId:e.VersionId},function(e,o){if(e){var n=e.statusCode;return n&&204===n?t(null,{statusCode:n}):n&&404===n?t(null,{BucketNotFound:!0,statusCode:n}):t(e)}t(null,{statusCode:o.statusCode,headers:o.headers})})},getObjectAcl:function(e,t){s.call(this,{Action:"name/cos:GetObjectACL",method:"GET",Bucket:e.Bucket,Region:e.Region,Key:e.Key,headers:e.Headers,action:"acl"},function(e,o){if(e)return t(e);var r=o.AccessControlPolicy||{},i=r.Owner||{},a=r.AccessControlList&&r.AccessControlList.Grant||[];a=p.isArray(a)?a:[a];var c=n(r);o.headers&&o.headers["x-cos-acl"]&&(c.ACL=o.headers["x-cos-acl"]),c=p.extend(c,{Owner:i,Grants:a,statusCode:o.statusCode,headers:o.headers}),t(null,c)})},putObjectAcl:function(e,t){var o=e.Headers,n="";if(e.AccessControlPolicy){var i=p.clone(e.AccessControlPolicy||{}),a=i.Grants||i.Grant;a=p.isArray(a)?a:[a],delete i.Grant,delete i.Grants,i.AccessControlList={Grant:a},n=p.json2xml({AccessControlPolicy:i}),o["Content-Type"]="application/xml",o["Content-MD5"]=p.binaryBase64(p.md5(n))}p.each(o,function(e,t){0===t.indexOf("x-cos-grant-")&&(o[t]=r(o[t]))}),s.call(this,{Action:"name/cos:PutObjectACL",method:"PUT",Bucket:e.Bucket,Region:e.Region,Key:e.Key,action:"acl",headers:o,body:n},function(e,o){if(e)return t(e);t(null,{statusCode:o.statusCode,headers:o.headers})})},optionsObject:function(e,t){var o=e.Headers;o.Origin=e.Origin,o["Access-Control-Request-Method"]=e.AccessControlRequestMethod,o["Access-Control-Request-Headers"]=e.AccessControlRequestHeaders,s.call(this,{Action:"name/cos:OptionsObject",method:"OPTIONS",Bucket:e.Bucket,Region:e.Region,Key:e.Key,headers:o},function(e,o){if(e)return e.statusCode&&403===e.statusCode?t(null,{OptionsForbidden:!0,statusCode:e.statusCode}):t(e);var n=o.headers||{};t(null,{AccessControlAllowOrigin:n["access-control-allow-origin"],AccessControlAllowMethods:n["access-control-allow-methods"],AccessControlAllowHeaders:n["access-control-allow-headers"],AccessControlExposeHeaders:n["access-control-expose-headers"],AccessControlMaxAge:n["access-control-max-age"],statusCode:o.statusCode,headers:o.headers})})},putObjectCopy:function(e,t){var o=(e.CopySource||"").match(/^([^.]+-\d+)\.cos(v6)?\.([^.]+)\.[^\/]+\/(.+)$/);if(o){var n=o[1],r=o[3],i=decodeURIComponent(o[4]);s.call(this,{Scope:[{action:"name/cos:GetObject",bucket:n,region:r,prefix:i},{action:"name/cos:PutObject",bucket:e.Bucket,region:e.Region,prefix:e.Key}],method:"PUT",Bucket:e.Bucket,Region:e.Region,Key:e.Key,VersionId:e.VersionId,headers:e.Headers},function(e,o){if(e)return t(e);var n=p.clone(o.CopyObjectResult||{});p.extend(n,{statusCode:o.statusCode,headers:o.headers}),t(null,n)})}else t({error:"CopySource format error"})},deleteMultipleObject:function(e,t){var o=e.Objects||[],n=e.Quiet;o=p.isArray(o)?o:[o];var r=p.json2xml({Delete:{Object:o,Quiet:n||!1}}),i=e.Headers;i["Content-Type"]="application/xml",i["Content-MD5"]=p.binaryBase64(p.md5(r));var a=p.map(o,function(t){return{action:"name/cos:DeleteObject",bucket:e.Bucket,region:e.Region,prefix:t.Key}});s.call(this,{Scope:a,method:"POST",Bucket:e.Bucket,Region:e.Region,body:r,action:"delete",headers:i},function(e,o){if(e)return t(e);var n=o.DeleteResult||{},r=n.Deleted||[],i=n.Error||[];r=p.isArray(r)?r:[r],i=p.isArray(i)?i:[i];var a=p.clone(n);p.extend(a,{Error:i,Deleted:r,statusCode:o.statusCode,headers:o.headers}),t(null,a)})},restoreObject:function(e,t){var o=e.Headers;if(e.RestoreRequest){var n=e.RestoreRequest||{},r=p.json2xml({RestoreRequest:n});o["Content-Type"]="application/xml",o["Content-MD5"]=p.binaryBase64(p.md5(r)),s.call(this,{Action:"name/cos:RestoreObject",method:"POST",Bucket:e.Bucket,Region:e.Region,Key:e.Key,VersionId:e.VersionId,body:r,action:"restore",headers:o},function(e,o){t(e,o)})}else t({error:"missing param RestoreRequest"})},uploadPartCopy:function(e,t){var o=(e.CopySource||"").match(/^([^.]+-\d+)\.cos(v6)?\.([^.]+)\.[^\/]+\/(.+)$/);if(o){var n=o[1],r=o[3],i=decodeURIComponent(o[4]);s.call(this,{Scope:[{action:"name/cos:GetObject",bucket:n,region:r,prefix:i},{action:"name/cos:PutObject",bucket:e.Bucket,region:e.Region,prefix:e.Key}],method:"PUT",Bucket:e.Bucket,Region:e.Region,Key:e.Key,VersionId:e.VersionId,qs:{partNumber:e.PartNumber,uploadId:e.UploadId},headers:e.Headers},function(e,o){if(e)return t(e);var n=p.clone(o.CopyPartResult||{});p.extend(n,{statusCode:o.statusCode,headers:o.headers}),t(null,n)})}else t({error:"CopySource format error"})},multipartInit:function(e,t){s.call(this,{Action:"name/cos:InitiateMultipartUpload",method:"POST",Bucket:e.Bucket,Region:e.Region,Key:e.Key,action:"uploads",headers:e.Headers},function(e,o){return e?t(e):(o=p.clone(o||{}))&&o.InitiateMultipartUploadResult?t(null,p.extend(o.InitiateMultipartUploadResult,{statusCode:o.statusCode,headers:o.headers})):void t(null,o)})},multipartUpload:function(e,t){var o=this;p.getFileSize("multipartUpload",e,function(){p.getBodyMd5(o.options.UploadCheckContentMd5,e.Body,function(n){n&&(e.Headers["Content-MD5"]=p.binaryBase64(n)),s.call(o,{Action:"name/cos:UploadPart",TaskId:e.TaskId,method:"PUT",Bucket:e.Bucket,Region:e.Region,Key:e.Key,qs:{partNumber:e.PartNumber,uploadId:e.UploadId},headers:e.Headers,onProgress:e.onProgress,body:e.Body||null},function(e,o){if(e)return t(e);o.headers=o.headers||{},t(null,{ETag:o.headers.etag||"",statusCode:o.statusCode,headers:o.headers})})})})},multipartComplete:function(e,t){for(var o=this,n=e.UploadId,r=e.Parts,a=0,c=r.length;a<c;a++)0!==r[a].ETag.indexOf('"')&&(r[a].ETag='"'+r[a].ETag+'"');var l=p.json2xml({CompleteMultipartUpload:{Part:r}}),u=e.Headers;u["Content-Type"]="application/xml",u["Content-MD5"]=p.binaryBase64(p.md5(l)),s.call(this,{Action:"name/cos:CompleteMultipartUpload",method:"POST",Bucket:e.Bucket,Region:e.Region,Key:e.Key,qs:{uploadId:n},body:l,headers:u},function(n,r){if(n)return t(n);var a=i({ForcePathStyle:o.options.ForcePathStyle,protocol:o.options.Protocol,domain:o.options.Domain,bucket:e.Bucket,region:e.Region,object:e.Key,isLocation:!0}),c=r.CompleteMultipartUploadResult||{},s=p.extend(c,{Location:a,statusCode:r.statusCode,headers:r.headers});t(null,s)})},multipartList:function(e,t){var o={};o.delimiter=e.Delimiter,o["encoding-type"]=e.EncodingType,o.prefix=e.Prefix||"",o["max-uploads"]=e.MaxUploads,o["key-marker"]=e.KeyMarker,o["upload-id-marker"]=e.UploadIdMarker,o=p.clearKey(o),s.call(this,{Action:"name/cos:ListMultipartUploads",ResourceKey:o.prefix,method:"GET",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,qs:o,action:"uploads"},function(e,o){if(e)return t(e);if(o&&o.ListMultipartUploadsResult){var n=o.ListMultipartUploadsResult.Upload||[],r=o.ListMultipartUploadsResult.CommonPrefixes||[];r=p.isArray(r)?r:[r],n=p.isArray(n)?n:[n],o.ListMultipartUploadsResult.Upload=n,o.ListMultipartUploadsResult.CommonPrefixes=r}var i=p.clone(o.ListMultipartUploadsResult||{});p.extend(i,{statusCode:o.statusCode,headers:o.headers}),t(null,i)})},multipartListPart:function(e,t){var o={};o.uploadId=e.UploadId,o["encoding-type"]=e.EncodingType,o["max-parts"]=e.MaxParts,o["part-number-marker"]=e.PartNumberMarker,s.call(this,{Action:"name/cos:ListParts",method:"GET",Bucket:e.Bucket,Region:e.Region,Key:e.Key,headers:e.Headers,qs:o},function(e,o){if(e)return t(e);var n=o.ListPartsResult||{},r=n.Part||[];r=p.isArray(r)?r:[r],n.Part=r;var i=p.clone(n);p.extend(i,{statusCode:o.statusCode,headers:o.headers}),t(null,i)})},multipartAbort:function(e,t){var o={};o.uploadId=e.UploadId,s.call(this,{Action:"name/cos:AbortMultipartUpload",method:"DELETE",Bucket:e.Bucket,Region:e.Region,Key:e.Key,headers:e.Headers,qs:o},function(e,o){if(e)return t(e);t(null,{statusCode:o.statusCode,headers:o.headers})})},getObjectUrl:function(e,t){var o=this,n=i({ForcePathStyle:o.options.ForcePathStyle,protocol:e.Protocol||o.options.Protocol,domain:o.options.Domain,bucket:e.Bucket,region:e.Region,object:e.Key});if(void 0!==e.Sign&&!e.Sign)return t(null,{Url:n}),n;var r=a.call(this,{Action:"PUT"===(e.Method||"").toUpperCase()?"name/cos:PutObject":"name/cos:GetObject",Bucket:e.Bucket||"",Region:e.Region||"",Method:e.Method||"get",Key:e.Key,Expires:e.Expires},function(e,o){if(t){if(e)return void t(e);var r=n;r+="?"+(o.Authorization.indexOf("q-signature")>-1?o.Authorization:"sign="+encodeURIComponent(o.Authorization)),o.XCosSecurityToken&&(r+="&x-cos-security-token="+o.XCosSecurityToken),o.ClientIP&&(r+="&clientIP="+o.ClientIP),o.ClientUA&&(r+="&clientUA="+o.ClientUA),o.Token&&(r+="&token="+o.Token),setTimeout(function(){t(null,{Url:r})})}});return r?n+"?"+r.Authorization+(r.XCosSecurityToken?"&x-cos-security-token="+r.XCosSecurityToken:""):n},getAuth:function(e){return p.getAuth({SecretId:e.SecretId||this.options.SecretId||"",SecretKey:e.SecretKey||this.options.SecretKey||"",Method:e.Method,Key:e.Key,Query:e.Query,Headers:e.Headers,Expires:e.Expires,SystemClockOffset:this.options.SystemClockOffset})}};e.exports.init=function(e,t){t.transferToTaskMethod(d,"postObject"),p.each(d,function(t,o){e.prototype[o]=p.apiWrapper(o,t)})}},function(e,t,o){var n=o(0),r={};e.exports.transferToTaskMethod=function(e,t){r[t]=e[t],e[t]=function(e,o){e.SkipTask?r[t].call(this,e,o):this._addTask(t,e,o)}},e.exports.init=function(e){var t=[],o={},i=0,a=0,c=function(e){var t={id:e.id,Bucket:e.Bucket,Region:e.Region,Key:e.Key,FilePath:e.FilePath,state:e.state,loaded:e.loaded,size:e.size,speed:e.speed,percent:e.percent,hashPercent:e.hashPercent,error:e.error};return e.FilePath&&(t.FilePath=e.FilePath),t},s=function(){e.emit("list-update",{list:n.map(t,c)})},l=function(){var o;if(t.length>e.options.UploadQueueSize)for(o=0;o<t.length&&t.length>e.options.UploadQueueSize&&o<a;o++)t[o]&&"waiting"===t[o].state||(t.splice(o,1),a--)},u=function o(){if(a<t.length&&i<e.options.FileParallelLimit){var c=t[a];if("waiting"===c.state){i++,c.state="checking";var u=n.formatParams(c.api,c.params);r[c.api].call(e,u,function(t,n){e._isRunningTask(c.id)&&("checking"!==c.state&&"uploading"!==c.state||(c.state=t?"error":"success",t&&(c.error=t),i--,s(),o(),c.callback&&c.callback(t,n),"success"===c.state&&(c.params&&(delete c.params.Body,delete c.params),delete c.callback)),l())}),s()}a++,o()}},p=function(t,n){var r=o[t];if(r){var a=r&&"waiting"===r.state,c=r&&("checking"===r.state||"uploading"===r.state);if("canceled"===n&&"canceled"!==r.state||"paused"===n&&a||"paused"===n&&c){if("paused"===n&&r.params.Body&&"function"==typeof r.params.Body.pipe)return void console.error("stream not support pause");r.state=n,e.emit("inner-kill-task",{TaskId:t,toState:n}),s(),c&&(i--,u()),"canceled"===n&&(r.params&&(delete r.params.Body,delete r.params),delete r.callback)}l()}};e._addTasks=function(t){n.each(t,function(t){e._addTask(t.api,t.params,t.callback,!0)}),s()},e._addTask=function(r,i,a,c){i=n.formatParams(r,i);var p=n.uuid();i.TaskId=p,i.TaskReady&&i.TaskReady(p);var d={params:i,callback:a,api:r,index:t.length,id:p,Bucket:i.Bucket,Region:i.Region,Key:i.Key,FilePath:i.FilePath||"",state:"waiting",loaded:0,size:0,speed:0,percent:0,hashPercent:0,error:null},h=i.onHashProgress;i.onHashProgress=function(t){e._isRunningTask(d.id)&&(d.hashPercent=t.percent,h&&h(t),s())};var f=i.onProgress;return i.onProgress=function(t){e._isRunningTask(d.id)&&("checking"===d.state&&(d.state="uploading"),d.loaded=t.loaded,d.size=t.total,d.speed=t.speed,d.percent=t.percent,f&&f(t),s())},o[p]=d,t.push(d),d.size=i.FileSize,!c&&s(),u(),l(),p},e._isRunningTask=function(e){var t=o[e];return!(!t||"checking"!==t.state&&"uploading"!==t.state)},e.getTaskList=function(){return n.map(t,c)},e.cancelTask=function(e){p(e,"canceled")},e.pauseTask=function(e){p(e,"paused")},e.restartTask=function(e){var t=o[e];!t||"paused"!==t.state&&"error"!==t.state||(t.state="waiting",s(),a=Math.min(a,t.index),u())}}}])}),cc._RF.pop()},{}]},{},["AudioControl","BeatsCell","BhvButtonGroup","BhvFrameIndex","BhvRollNumber","BhvSwitchPage","EditCell","EditMode","Edit_UI","Energy","FileSaver","Game","MVVMData","MainNode","Player","PlayerLight","PreviewMode","Prop","Score","Star","StarCreater","Touch","WayControl","cos-wx-sdk-v5","JsonOb","StringFormat","VMBase","VMCompsEdit","VMCustom","VMEvent","VMLabel","VMModify","VMParent","VMProgress","VMState","ViewModel"]);